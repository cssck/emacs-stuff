<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-04-21 Fri 01:45 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>My System Config</title>
<meta name="author" content="Jan NovotnÃ½" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">My System Config</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgb5feda1">1. Autostart</a>
<ul>
<li><a href="#org016cb87">1.1. .config/autostart/autostart.desktop</a></li>
<li><a href="#org296d75d">1.2. .loginctl</a></li>
</ul>
</li>
<li><a href="#org06be266">2. Bash</a>
<ul>
<li><a href="#orgffc8af2">2.1. .bashrc</a></li>
<li><a href="#org96c0d78">2.2. .bash profile</a></li>
</ul>
</li>
<li><a href="#orge22fde4">3. Custom Binaries</a>
<ul>
<li><a href="#orgf79f893">3.1. .bin/scr</a></li>
<li><a href="#org97aef75">3.2. .bin/scr-area</a></li>
<li><a href="#orgf1a0410">3.3. .bin/chromium-incognito</a></li>
</ul>
</li>
<li><a href="#org6fb302a">4. Containers</a>
<ul>
<li><a href="#org078cb0a">4.1. .config/containers/policy.json</a></li>
<li><a href="#org2fb5a00">4.2. .config/containers/registries.conf</a></li>
</ul>
</li>
<li><a href="#org4eafbb4">5. Guix</a>
<ul>
<li><a href="#org6e3e04f">5.1. .guix-manifest</a></li>
<li><a href="#orgd20669f">5.2. .config/guix/channels.scm</a></li>
</ul>
</li>
<li><a href="#orgde1aa42">6. Guix-run</a>
<ul>
<li><a href="#org3b004ca">6.1. .bin/guix-run</a></li>
</ul>
</li>
<li><a href="#orge13fefa">7. i3</a>
<ul>
<li><a href="#org55d0225">7.1. .config/i3/config</a></li>
<li><a href="#org2deee67">7.2. .config/i3/i3status<sub>wrapper.py</sub></a></li>
<li><a href="#org9623c58">7.3. .config/i3status/config</a></li>
</ul>
</li>
<li><a href="#orgb2850ce">8. Picom</a>
<ul>
<li><a href="#org278bd41">8.1. .config/picom/picom.conf</a></li>
</ul>
</li>
<li><a href="#orgec04147">9. Rofi</a>
<ul>
<li><a href="#org22cb089">9.1. .config/rofi/nord.rasi</a></li>
</ul>
</li>
<li><a href="#orgeec3fdb">10. Startx</a>
<ul>
<li><a href="#org66d37d9">10.1. .startx</a></li>
</ul>
</li>
<li><a href="#orgc5e9109">11. Xresources</a>
<ul>
<li><a href="#org756eedf">11.1. .Xresources</a></li>
<li><a href="#org2793667">11.2. .xsessionrc</a></li>
</ul>
</li>
<li><a href="#orgd133faf">12. Guix system</a>
<ul>
<li><a href="#orgcfaaebe">12.1. /etc/config.scm</a></li>
<li><a href="#org4e81d2f">12.2. /etc/signing-key.pub</a></li>
</ul>
</li>
<li><a href="#org7b560eb">13. Custom Guix Modules</a>
<ul>
<li><a href="#org8c6a0d8">13.1. /etc/guix-modules/nil/packages</a>
<ul>
<li><a href="#org7ab00f0">13.1.1. brogue.scm</a></li>
<li><a href="#org6d6017d">13.1.2. distrobox-docker.scm</a></li>
<li><a href="#orge5388b3">13.1.3. emulators.scm</a></li>
<li><a href="#orgedac612">13.1.4. steam-client.scm</a></li>
</ul>
</li>
<li><a href="#org9ae4e64">13.2. /etc/guix-modules/nil/services</a>
<ul>
<li><a href="#org752ea22">13.2.1. mount-rshared.scm</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org537acd1">14. Emacs</a>
<ul>
<li><a href="#org1d2df8e">14.1. Variables</a></li>
<li><a href="#org0f419a5">14.2. Functions</a></li>
<li><a href="#org0c0f654">14.3. Keybindings</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
This is my full-system config.
</p>

<ul class="org-ul">
<li>Currently it's deployed on a Debian system, but it's rather flexible and contains a full GNU Guix System configuration as well.</li>
<li>Install Guix and run a <code>guix pull</code> before doing importing the package manifest.</li>
<li>The configuration itself is placed in <code>~/git/emacs-stuff/configs</code> and <code>~/git/emacs-stuff/configs-root</code>, from where the individual modules can be symlinked into place using <a href="https://www.gnu.org/software/stow/">GNU Stow</a>.</li>
<li>Some modules like <code>fonts</code>, <code>icons</code> and <code>firefox</code> aren't generated by tangle.</li>
<li>Make sure to tangle this file prior to linking the configs.</li>
</ul>

<div id="outline-container-orgb5feda1" class="outline-2">
<h2 id="orgb5feda1"><span class="section-number-2">1.</span> Autostart</h2>
<div class="outline-text-2" id="text-1">
<p>
Here I store my relevant autostart scripts.
</p>
</div>

<div id="outline-container-org016cb87" class="outline-3">
<h3 id="org016cb87"><span class="section-number-3">1.1.</span> .config/autostart/autostart.desktop</h3>
<div class="outline-text-3" id="text-1-1">
<p>
First we need to add the actual .desktop file for the DE to load.
</p>
<div class="org-src-container">
<pre class="src src-conf-desktop">[<span style="color: #6434A3;">Desktop Entry</span>] 
<span style="color: #BA36A5;">Type</span>=Application
<span style="color: #BA36A5;">Name</span>=loginctl
<span style="color: #BA36A5;">Exec</span>=/home/nil/.loginctl
<span style="color: #BA36A5;">Comment</span>=Run loginctl script on login
<span style="color: #BA36A5;">X-GNOME-Autostart-enabled</span>=<span style="color: #D0372D;">true</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org296d75d" class="outline-3">
<h3 id="org296d75d"><span class="section-number-3">1.2.</span> .loginctl</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Here's the actual autostart script.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #8D8D84; font-style: italic;">#xinput set-prop 'pointer:Logitech G305' 'Device Accel Profile' -1 &amp;</span>
<span style="color: #006DAF;">emacs</span> <span style="color: #D0372D;">--daemon</span> &amp;
<span style="color: #006DAF;">syncthing</span> &amp;
<span style="color: #8D8D84; font-style: italic;">#setxkbmap cz -option 'ctrl:swapcaps' &amp;</span>
<span style="color: #8D8D84; font-style: italic;">#timidity -iA &amp;</span>
<span style="color: #8D8D84; font-style: italic;">#nitrogen --restore &amp;</span>
<span style="color: #8D8D84; font-style: italic;">#picom &amp;</span>
<span style="color: #8D8D84; font-style: italic;">#playerctld &amp;</span>
<span style="color: #8D8D84; font-style: italic;">#exec i3 &amp;</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org06be266" class="outline-2">
<h2 id="org06be266"><span class="section-number-2">2.</span> Bash</h2>
<div class="outline-text-2" id="text-2">
<p>
Let's move on to configuring the shell - bash in my case.
</p>
</div>

<div id="outline-container-orgffc8af2" class="outline-3">
<h3 id="orgffc8af2"><span class="section-number-3">2.1.</span> .bashrc</h3>
<div class="outline-text-3" id="text-2-1">
<p>
I like to have a function to clear old guix builds by regex, helps keep the amount of garbage down.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #006699;">clean_build</span> <span style="color: #707183;">()</span> <span style="color: #707183;">{</span> <span style="color: #8D8D84; font-style: italic;"># clear guix build by regex</span>
    <span style="color: #0000FF;">if</span> <span style="color: #7388D6;">[</span><span style="color: #909183;">[</span> <span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">1</span> <span style="color: #909183;">]</span><span style="color: #7388D6;">]</span><span style="color: #0000FF;">;</span> <span style="color: #0000FF;">then</span>
        <span style="color: #BA36A5; font-style: italic;">CLEAR_BUILD_PATHS</span>=<span style="color: #008000;">"</span><span style="color: #008000;">$(</span><span style="color: #006DAF; background-color: #FFFFFF;">ls</span><span style="color: #008000; background-color: #FFFFFF;"> </span><span style="color: #808080; background-color: #FFFFFF; font-weight: bold;">--color=never</span><span style="color: #008000; background-color: #FFFFFF;"> </span><span style="color: #D0372D; background-color: #FFFFFF;">-d</span><span style="color: #008000; background-color: #FFFFFF;"> /gnu/store/</span><span style="color: #0000FF; background-color: #FFFFFF;">$</span><span style="color: #D0372D; background-color: #FFFFFF; font-style: italic;">1</span><span style="color: #008000; background-color: #FFFFFF;"> </span><span style="color: #0000FF; background-color: #FFFFFF;">|</span><span style="color: #008000; background-color: #FFFFFF;"> </span><span style="color: #006DAF; background-color: #FFFFFF;">tr</span><span style="color: #008000; background-color: #FFFFFF;"> '\n' ' '</span><span style="color: #008000;">)</span><span style="color: #008000;">"</span>
    <span style="color: #0000FF;">else</span>
        <span style="color: #006FE0;">echo</span> <span style="color: #008000;">"no regex specified"</span>
        <span style="color: #006DAF;">return</span> 1
    <span style="color: #0000FF;">fi</span>
    <span style="color: #0000FF;">if</span> <span style="color: #7388D6;">[</span><span style="color: #909183;">[</span> <span style="color: #0000FF;">$</span><span style="color: #709870;">(</span><span style="color: #006FE0; background-color: #FFFFFF;">echo</span><span style="color: #333333; background-color: #FFFFFF;"> </span><span style="color: #008000; background-color: #FFFFFF;">"</span><span style="color: #0000FF; background-color: #FFFFFF;">$</span><span style="color: #D0372D; background-color: #FFFFFF; font-style: italic;">CLEAR_BUILD_PATHS</span><span style="color: #008000; background-color: #FFFFFF;">"</span><span style="color: #333333; background-color: #FFFFFF;"> </span><span style="color: #0000FF; background-color: #FFFFFF;">|</span><span style="color: #333333; background-color: #FFFFFF;"> </span><span style="color: #006DAF; background-color: #FFFFFF;">wc</span><span style="color: #333333; background-color: #FFFFFF;"> </span><span style="color: #D0372D; background-color: #FFFFFF;">-c</span><span style="color: #709870;">)</span> -ne 1 <span style="color: #909183;">]</span><span style="color: #7388D6;">]</span><span style="color: #0000FF;">;</span> <span style="color: #0000FF;">then</span>
        <span style="color: #006DAF;">guix</span> gc <span style="color: #D0372D;">--delete</span> <span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">CLEAR_BUILD_PATHS</span>
    <span style="color: #0000FF;">else</span>
        <span style="color: #006FE0;">echo</span> <span style="color: #008000;">"no match for regex found"</span>
        <span style="color: #006DAF;">return</span> 1
    <span style="color: #0000FF;">fi</span>
<span style="color: #707183;">}</span>
</pre>
</div>

<p>
A small bit used to remind me when I'm inside a Guix environment.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #0000FF;">if</span> <span style="color: #707183;">[</span> -n <span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">GUIX_ENVIRONMENT</span><span style="color: #008000;">"</span> <span style="color: #707183;">]</span><span style="color: #0000FF;">;</span> <span style="color: #0000FF;">then</span>
  <span style="color: #0000FF;">if</span> <span style="color: #707183;">[</span><span style="color: #7388D6;">[</span> <span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">PS1</span> =~ <span style="color: #909183;">(</span>.*<span style="color: #909183;">)</span>"\\$" <span style="color: #7388D6;">]</span><span style="color: #707183;">]</span><span style="color: #0000FF;">;</span> <span style="color: #0000FF;">then</span>
      <span style="color: #BA36A5; font-style: italic;">PS1</span>=<span style="color: #008000;">"</span><span style="color: #0000FF;">${</span><span style="color: #D0372D; background-color: #FFFFFF; font-style: italic;">BASH_REMATCH</span><span style="color: #333333; background-color: #FFFFFF;">[1]</span><span style="color: #0000FF;">}</span><span style="color: #008000;"> [env]\\\$ "</span>
  <span style="color: #0000FF;">fi</span>
<span style="color: #0000FF;">fi</span>
</pre>
</div>

<p>
Next let's set up the prompt with fancy colors and a cute lambda.
Since <code>tput</code> isn't available on all distros (namely missing on GNU Guix), an alternative is provided.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #0000FF;">if</span> <span style="color: #707183;">[</span><span style="color: #7388D6;">[</span> <span style="color: #0000FF;">$</span><span style="color: #ff0000; font-weight: bold;">-</span> <span style="color: #0000FF;">==</span> *i* <span style="color: #7388D6;">]</span><span style="color: #707183;">]</span>
<span style="color: #0000FF;">then</span>
    <span style="color: #BA36A5; font-style: italic;">_GREEN</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">tput</span><span style="color: #333333; background-color: #FFFFFF;"> setaf 2</span><span style="color: #707183;">)</span>
    <span style="color: #BA36A5; font-style: italic;">_MAGENTA</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">tput</span><span style="color: #333333; background-color: #FFFFFF;"> setaf 200</span><span style="color: #707183;">)</span>
    <span style="color: #BA36A5; font-style: italic;">_BLUE</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">tput</span><span style="color: #333333; background-color: #FFFFFF;"> setaf 4</span><span style="color: #707183;">)</span>
    <span style="color: #BA36A5; font-style: italic;">_RED</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">tput</span><span style="color: #333333; background-color: #FFFFFF;"> setaf 1</span><span style="color: #707183;">)</span>
    <span style="color: #BA36A5; font-style: italic;">_CYAN</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">tput</span><span style="color: #333333; background-color: #FFFFFF;"> setaf 45</span><span style="color: #707183;">)</span>
    <span style="color: #BA36A5; font-style: italic;">_RESET</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">tput</span><span style="color: #333333; background-color: #FFFFFF;"> sgr0</span><span style="color: #707183;">)</span>
    <span style="color: #BA36A5; font-style: italic;">_BOLD</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">tput</span><span style="color: #333333; background-color: #FFFFFF;"> bold</span><span style="color: #707183;">)</span>
    <span style="color: #8D8D84; font-style: italic;">#  _GREEN="\e[0;32m"</span>
    <span style="color: #8D8D84; font-style: italic;">#  _MAGENTA="\e[0;35m"</span>
    <span style="color: #8D8D84; font-style: italic;">#  _BLUE="\e[0;34m"</span>
    <span style="color: #8D8D84; font-style: italic;">#  _RED="\e[0;31m"</span>
    <span style="color: #8D8D84; font-style: italic;">#  _CYAN="\e[0;36m"</span>
    <span style="color: #8D8D84; font-style: italic;">#  _RESET="\e[0m"</span>
    <span style="color: #8D8D84; font-style: italic;">#  _BOLD="\e[1m"</span>
    <span style="color: #8D8D84; font-style: italic;">#  export LD_LIBRARY_PATH=$LIBRARY_PATH</span>
    <span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">PS1</span>=<span style="color: #008000;">"[</span><span style="color: #0000FF;">${</span><span style="color: #D0372D; background-color: #FFFFFF; font-style: italic;">_MAGENTA</span><span style="color: #0000FF;">}</span><span style="color: #008000;">\u</span><span style="color: #0000FF;">${</span><span style="color: #D0372D; background-color: #FFFFFF; font-style: italic;">_RESET</span><span style="color: #0000FF;">}</span><span style="color: #008000;">@</span><span style="color: #0000FF;">${</span><span style="color: #D0372D; background-color: #FFFFFF; font-style: italic;">_CYAN</span><span style="color: #0000FF;">}</span><span style="color: #008000;">\h</span><span style="color: #0000FF;">${</span><span style="color: #D0372D; background-color: #FFFFFF; font-style: italic;">_RESET</span><span style="color: #0000FF;">}</span><span style="color: #008000;">] \t\n(\w) &#955; "</span>
<span style="color: #0000FF;">fi</span>
</pre>
</div>

<p>
Let's add some aliases.
The <code>ld_libs</code> is useful for exporting Guix's libraries to run precompiled software.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #006FE0;">alias</span> ls=<span style="color: #008000;">"ls --color"</span>
<span style="color: #006FE0;">alias</span> ld_libs=<span style="color: #008000;">"export LD_LIBRARY_PATH=</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">LIBRARY_PATH</span><span style="color: #008000;">"</span>
</pre>
</div>

<p>
Finally some variable exports - for Guix and Flatpak.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">XDG_DATA_DIRS</span>=<span style="color: #008000;">"/var/lib/flatpak/exports/share:</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.local/share/flatpak/exports/share:</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">XDG_DATA_DIRS</span><span style="color: #008000;">"</span>
<span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">GUIX_PACKAGE_PATH</span>=<span style="color: #008000;">"/etc/guix-modules"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org96c0d78" class="outline-3">
<h3 id="org96c0d78"><span class="section-number-3">2.2.</span> .bash profile</h3>
<div class="outline-text-3" id="text-2-2">
<p>
Let's move onto the bash profile, used in login shells.
</p>

<p>
First run the bashrc if necessary.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #8D8D84; font-style: italic;"># Honor per-interactive-shell startup file</span>
<span style="color: #0000FF;">if</span> <span style="color: #707183;">[</span> -f ~/.bashrc <span style="color: #707183;">]</span><span style="color: #0000FF;">;</span> <span style="color: #0000FF;">then</span> <span style="color: #006DAF;">.</span> ~/.bashrc<span style="color: #0000FF;">;</span> <span style="color: #0000FF;">fi</span>
</pre>
</div>

<p>
Then we can go ahead and export Guix, but only when not inside a container.
</p>
<div class="org-src-container">
<pre class="src src-bash"><span style="color: #0000FF;">if</span> <span style="color: #707183;">[</span> ! -f /.dockerenv <span style="color: #707183;">]</span><span style="color: #0000FF;">;</span> <span style="color: #0000FF;">then</span>
  <span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">GUIX_PROFILE</span>=<span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.guix-profile"</span>
  <span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">GUIX_LOCPATH</span>=<span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.guix-profile/lib/locale"</span>
  <span style="color: #0000FF;">export</span> <span style="color: #ff0000; font-weight: bold; font-style: italic;">PATH</span>=<span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #ff0000; font-weight: bold; font-style: italic;">PATH</span><span style="color: #008000;">:</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.config/guix/current:</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.bin:</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.local/share/flatpak/exports/bin"</span>
  <span style="color: #006DAF;">.</span> <span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">GUIX_PROFILE</span><span style="color: #008000;">/etc/profile"</span>
<span style="color: #0000FF;">fi</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge22fde4" class="outline-2">
<h2 id="orge22fde4"><span class="section-number-2">3.</span> Custom Binaries</h2>
<div class="outline-text-2" id="text-3">
<p>
Here I have some custom binaries, mostly scripts and stuff.
</p>
</div>

<div id="outline-container-orgf79f893" class="outline-3">
<h3 id="orgf79f893"><span class="section-number-3">3.1.</span> .bin/scr</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Just a screenshot shortcut.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8D8D84; font-style: italic;">#!/bin/sh</span>
<span style="color: #006DAF;">scrot</span> <span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/Obr&#225;zky/</span><span style="color: #008000;">$(</span><span style="color: #006DAF; background-color: #FFFFFF;">date</span><span style="color: #008000;">)</span><span style="color: #008000;">.png"</span> 
</pre>
</div>
</div>
</div>

<div id="outline-container-org97aef75" class="outline-3">
<h3 id="org97aef75"><span class="section-number-3">3.2.</span> .bin/scr-area</h3>
<div class="outline-text-3" id="text-3-2">
<p>
&#x2026;And the same but for a selected area.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8D8D84; font-style: italic;">#!/bin/sh</span>
<span style="color: #006DAF;">scrot</span> <span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/Obr&#225;zky/</span><span style="color: #008000;">$(</span><span style="color: #006DAF; background-color: #FFFFFF;">date</span><span style="color: #008000;">)</span><span style="color: #008000;">.png"</span> <span style="color: #D0372D;">-f</span> <span style="color: #D0372D;">-s</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf1a0410" class="outline-3">
<h3 id="orgf1a0410"><span class="section-number-3">3.3.</span> .bin/chromium-incognito</h3>
<div class="outline-text-3" id="text-3-3">
<p>
And a shortcut for opening chromium in incognito mode.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8D8D84; font-style: italic;">#!/bin/sh</span>
<span style="color: #006DAF;">chromium</span> <span style="color: #D0372D;">--incognito</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6fb302a" class="outline-2">
<h2 id="org6fb302a"><span class="section-number-2">4.</span> Containers</h2>
<div class="outline-text-2" id="text-4">
<p>
I use distrobox docker/podman (depending on which is available, podman is prefered) on my installation.
Here is some necessary configs for the containers.
</p>
</div>

<div id="outline-container-org078cb0a" class="outline-3">
<h3 id="org078cb0a"><span class="section-number-3">4.1.</span> .config/containers/policy.json</h3>
<div class="outline-text-3" id="text-4-1">
<p>
This isn't super secure.
</p>
<div class="org-src-container">
<pre class="src src-json">{
    "default": [
	{
	"type": "insecureAcceptAnything"
    }
    ],
    "transports":
    {
	"docker-daemon":
	{
	    "": [{"type":"insecureAcceptAnything"}]
	}
    }
}
</pre>
</div>
</div>
</div>

<div id="outline-container-org2fb5a00" class="outline-3">
<h3 id="org2fb5a00"><span class="section-number-3">4.2.</span> .config/containers/registries.conf</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Add the necessary registries.
</p>
<div class="org-src-container">
<pre class="src src-conf-unix"><span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Copied from https://raw.githubusercontent.com/projectatomic/registries/master/registries.fedora</span>
[<span style="color: #6434A3;">registries.search</span>]
<span style="color: #BA36A5;">registries</span> = [<span style="color: #008000;">'docker.io'</span>, <span style="color: #008000;">'registry.fedoraproject.org'</span>, <span style="color: #008000;">'registry.access.redhat.com'</span>]

[<span style="color: #6434A3;">registries.insecure</span>]
<span style="color: #BA36A5;">registries</span> = []

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Docker only</span>
[<span style="color: #6434A3;">registries.block</span>]
<span style="color: #BA36A5;">registries</span> = []
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org4eafbb4" class="outline-2">
<h2 id="org4eafbb4"><span class="section-number-2">5.</span> Guix</h2>
<div class="outline-text-2" id="text-5">
<p>
GNU Guix is a very important part of my configuration.
</p>
</div>

<div id="outline-container-org6e3e04f" class="outline-3">
<h3 id="org6e3e04f"><span class="section-number-3">5.1.</span> .guix-manifest</h3>
<div class="outline-text-3" id="text-5-1">
<p>
Just a straightforward (and very messy!) package manifest.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>specifications-&gt;manifest
  <span style="color: #7388D6;">(</span>list <span style="color: #008000;">"audacity"</span>
        <span style="color: #008000;">"strawberry"</span>
        <span style="color: #008000;">"lmms"</span>
        <span style="color: #008000;">"arc-theme"</span>
        <span style="color: #008000;">"gvfs"</span>
        <span style="color: #008000;">"celluloid"</span>
        <span style="color: #008000;">"xdg-desktop-portal-gtk"</span>
        <span style="color: #008000;">"xdg-desktop-portal"</span>
        <span style="color: #008000;">"gnome-tweaks"</span>
        <span style="color: #008000;">"ungoogled-chromium"</span>
        <span style="color: #008000;">"firefox"</span>
        <span style="color: #008000;">"caja"</span>
        <span style="color: #008000;">"mpv"</span>
        <span style="color: #008000;">"gimp"</span>
        <span style="color: #008000;">"flatpak"</span>
        <span style="color: #008000;">"transmission:gui"</span>
        <span style="color: #008000;">"transmission"</span>
        <span style="color: #008000;">"retroarch-nonfree"</span>
        <span style="color: #008000;">"aisleriot"</span>
        <span style="color: #008000;">"qemu"</span>
        <span style="color: #008000;">"virt-manager"</span>
        <span style="color: #008000;">"qjackctl"</span>
        <span style="color: #008000;">"i3status"</span>
        <span style="color: #008000;">"xfce4-pulseaudio-plugin"</span>
        <span style="color: #008000;">"xfce4-volumed-pulse"</span>
        <span style="color: #008000;">"google-chrome-stable"</span>
        <span style="color: #008000;">"sushi"</span>
        <span style="color: #008000;">"libportal"</span>
        <span style="color: #008000;">"steam-patched"</span>
        <span style="color: #008000;">"dolphin"</span>
        <span style="color: #008000;">"gzdoom"</span>
        <span style="color: #008000;">"gnome-mines"</span>
        <span style="color: #008000;">"gedit"</span>
        <span style="color: #008000;">"pavucontrol"</span>
        <span style="color: #008000;">"podman"</span>
        <span style="color: #008000;">"libreoffice"</span>
        <span style="color: #008000;">"eom"</span>
        <span style="color: #008000;">"gthumb"</span>
        <span style="color: #008000;">"obs"</span>
        <span style="color: #008000;">"sdl2-ttf"</span>
        <span style="color: #008000;">"yamagi-quake2"</span>
        <span style="color: #008000;">"timidity++"</span>
        <span style="color: #008000;">"kdenlive"</span>
        <span style="color: #008000;">"sdl2-image"</span>
        <span style="color: #008000;">"sdl2"</span>
        <span style="color: #008000;">"sdl2-gfx"</span>
        <span style="color: #008000;">"pulseaudio"</span>
        <span style="color: #008000;">"sdl"</span>
        <span style="color: #008000;">"openal"</span>
        <span style="color: #008000;">"vlc"</span>
        <span style="color: #008000;">"wine"</span>
        <span style="color: #008000;">"brogue-ce"</span>
        <span style="color: #008000;">"distrobox-docker"</span>
        <span style="color: #008000;">"emacs-geiser-guile"</span>
        <span style="color: #008000;">"pfetch"</span>
        <span style="color: #008000;">"thunar"</span>
        <span style="color: #008000;">"yt-dlp"</span>
        <span style="color: #008000;">"ublock-origin-chromium"</span>
        <span style="color: #008000;">"pandoc"</span>
        <span style="color: #008000;">"openjdk"</span>
        <span style="color: #008000;">"clang-toolchain"</span>
        <span style="color: #008000;">"emacs"</span>
        <span style="color: #008000;">"rofi"</span>
        <span style="color: #008000;">"i3lock"</span>
        <span style="color: #008000;">"lm-sensors"</span>
        <span style="color: #008000;">"gpick"</span>
        <span style="color: #008000;">"picom"</span>
        <span style="color: #008000;">"nitrogen"</span>
        <span style="color: #008000;">"i3-wm"</span>
        <span style="color: #008000;">"xfce4-whiskermenu-plugin"</span>
        <span style="color: #008000;">"xfce4-panel"</span>
        <span style="color: #008000;">"piper"</span>
        <span style="color: #008000;">"element-desktop"</span>
        <span style="color: #008000;">"scrot"</span>
        <span style="color: #008000;">"dconf-editor"</span>
        <span style="color: #008000;">"tumbler"</span>
        <span style="color: #008000;">"fluidsynth"</span>
        <span style="color: #008000;">"libratbag"</span>
        <span style="color: #008000;">"yaru-theme"</span>
        <span style="color: #008000;">"tuxguitar"</span>
        <span style="color: #008000;">"hyfetch"</span>
        <span style="color: #008000;">"font-awesome"</span>
        <span style="color: #008000;">"playerctl"</span>
        <span style="color: #008000;">"i3blocks"</span>
        <span style="color: #008000;">"font-google-noto-sans-cjk"</span>
        <span style="color: #008000;">"emacs-vterm"</span>
        <span style="color: #008000;">"emacs-use-package"</span>
        <span style="color: #008000;">"xprop"</span>
        <span style="color: #008000;">"cloc"</span>
        <span style="color: #008000;">"dmenu"</span>
        <span style="color: #008000;">"xset"</span>
        <span style="color: #008000;">"setxkbmap"</span>
        <span style="color: #008000;">"arc-icon-theme"</span>
        <span style="color: #008000;">"scsh"</span>
        <span style="color: #008000;">"sbcl"</span>
        <span style="color: #008000;">"mcron"</span>
        <span style="color: #008000;">"jq"</span>
        <span style="color: #008000;">"gdb"</span>
        <span style="color: #008000;">"font-google-noto-emoji"</span>
        <span style="color: #008000;">"zstd"</span>
        <span style="color: #008000;">"patchelf"</span>
        <span style="color: #008000;">"gnome-shell-extension-dash-to-dock"</span>
        <span style="color: #008000;">"python-pip"</span>
        <span style="color: #008000;">"freepats-gm"</span>
        <span style="color: #008000;">"p11-kit"</span>
        <span style="color: #008000;">"flatpak-xdg-utils"</span>
        <span style="color: #008000;">"vulkan-tools"</span>
        <span style="color: #008000;">"vulkan-loader"</span>
        <span style="color: #008000;">"libgudev"</span>
        <span style="color: #008000;">"libxkbcommon"</span>
        <span style="color: #008000;">"python"</span>
        <span style="color: #008000;">"libxi"</span>
        <span style="color: #008000;">"libxrandr"</span>
        <span style="color: #008000;">"libxcursor"</span>
        <span style="color: #008000;">"libgccjit"</span>
        <span style="color: #008000;">"curl"</span>
        <span style="color: #008000;">"gnome-shell-extension-appindicator"</span>
        <span style="color: #008000;">"gnome-shell-extension-blur-my-shell"</span>
        <span style="color: #008000;">"cmake"</span>
        <span style="color: #008000;">"unrar"</span>
        <span style="color: #008000;">"unzip"</span>
        <span style="color: #008000;">"xrandr"</span>
        <span style="color: #008000;">"stow"</span>
        <span style="color: #008000;">"freepats"</span>
        <span style="color: #008000;">"fluid-3"</span>
        <span style="color: #008000;">"alsa-lib"</span>
        <span style="color: #008000;">"htop"</span>
        <span style="color: #008000;">"libvorbis"</span>
        <span style="color: #008000;">"sqlite"</span>
        <span style="color: #008000;">"neofetch"</span>
        <span style="color: #008000;">"markdown"</span>
        <span style="color: #008000;">"make"</span>
        <span style="color: #008000;">"font-fira-mono"</span>
        <span style="color: #008000;">"libvterm"</span>
        <span style="color: #008000;">"libtool"</span>
        <span style="color: #008000;">"glibc-locales"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgd20669f" class="outline-3">
<h3 id="orgd20669f"><span class="section-number-3">5.2.</span> .config/guix/channels.scm</h3>
<div class="outline-text-3" id="text-5-2">
<p>
Here is the setup for channels, only read addition here is <code>nonguix</code>.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #7388D6;">(</span>guix ci<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>cons* <span style="color: #7388D6;">(</span>channel-with-substitutes-available
        %default-guix-channel
        <span style="color: #008000;">"https://ci.guix.gnu.org"</span><span style="color: #7388D6;">)</span>
       <span style="color: #7388D6;">(</span>channel
        <span style="color: #909183;">(</span>name 'nonguix<span style="color: #909183;">)</span>
        <span style="color: #909183;">(</span>url <span style="color: #008000;">"https://gitlab.com/nonguix/nonguix"</span><span style="color: #909183;">)</span>
        <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Enable signature verification:</span>
        <span style="color: #909183;">(</span>introduction
         <span style="color: #709870;">(</span>make-channel-introduction
          <span style="color: #008000;">"897c1a470da759236cc11798f4e0a5f7d4d59fbc"</span>
          <span style="color: #907373;">(</span>openpgp-fingerprint
           <span style="color: #008000;">"2A39 3FFF 68F4 EF7A 3D29  12AF 6F51 20A0 22FB B2D5"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
       %default-channels<span style="color: #707183;">)</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgde1aa42" class="outline-2">
<h2 id="orgde1aa42"><span class="section-number-2">6.</span> Guix-run</h2>
<div class="outline-text-2" id="text-6">
<p>
<code>guix-run</code> is a tiny script I originally found on Github. Unfortunately I do not have the original link anymore.
</p>
</div>

<div id="outline-container-org3b004ca" class="outline-3">
<h3 id="org3b004ca"><span class="section-number-3">6.1.</span> .bin/guix-run</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8D8D84; font-style: italic;">#!/bin/sh</span>

<span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">LD_LIBRARY_PATH</span>=<span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">LIBRARY_PATH</span>
<span style="color: #BA36A5; font-style: italic;">RUNNER</span>=<span style="color: #0000FF;">$</span><span style="color: #707183;">(</span><span style="color: #006DAF; background-color: #FFFFFF;">find</span><span style="color: #333333; background-color: #FFFFFF;"> ~/.guix-profile/lib/ </span><span style="color: #D0372D; background-color: #FFFFFF;">-name</span><span style="color: #333333; background-color: #FFFFFF;"> </span><span style="color: #008000; background-color: #FFFFFF;">'ld-linux-*.so*'</span><span style="color: #707183;">)</span>

<span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">RUNNER</span> <span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #ff0000; font-weight: bold;">@</span><span style="color: #008000;">"</span> <span style="color: #8D8D84; font-style: italic;">#!/bin/sh</span>

<span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">LD_LIBRARY_PATH</span>=<span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">LIBRARY_PATH</span>
<span style="color: #006DAF;">RUNNER</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge13fefa" class="outline-2">
<h2 id="orge13fefa"><span class="section-number-2">7.</span> i3</h2>
<div class="outline-text-2" id="text-7">
<p>
<code>i3</code> is one of the window managers I have a full setup for. While I do usually prefer to use a DE or EXWM, I do have i3 here for completeness.
</p>
</div>

<div id="outline-container-org55d0225" class="outline-3">
<h3 id="org55d0225"><span class="section-number-3">7.1.</span> .config/i3/config</h3>
<div class="outline-text-3" id="text-7-1">
<p>
Let's set some initial variables first.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">set</span> $mod Mod4
<span style="color: #BA36A5;">set</span> $HOME /home/nil
<span style="color: #BA36A5;">font</span> pango:monospace 9
<span style="color: #BA36A5;">gaps</span> inner 6px
<span style="color: #BA36A5;">for_window</span> [class=<span style="color: #008000;">"^.*"</span>] border pixel 2
<span style="color: #BA36A5;">floating_modifier</span> $mod
<span style="color: #BA36A5;">tiling_drag</span> modifier titlebar
</pre>
</div>

<p>
Execute the startup environment, this is necessary for XDG autostart files.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">exec</span> --no-startup-id dex --autostart --environment i3   
</pre>
</div>

<p>
Now let's begin assigning some keybindings; all of these are rather self-explanatory.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">set</span> $refresh_i3status killall -SIGUSR1 i3status
<span style="color: #BA36A5;">bindsym</span> XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +10%
<span style="color: #BA36A5;">bindsym</span> XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -10%
<span style="color: #BA36A5;">bindsym</span> XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle
<span style="color: #BA36A5;">bindsym</span> XF86AudioMicMute exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle
<span style="color: #BA36A5;">bindsym</span> Print exec --no-startup-id scr  
<span style="color: #BA36A5;">bindsym</span> Shift+Print exec --no-startup-id scr-area

<span style="color: #BA36A5;">bindsym</span> $mod+Return exec xfce4-terminal
<span style="color: #BA36A5;">bindsym</span> $mod+q kill

<span style="color: #BA36A5;">bindsym</span> $mod+d exec --no-startup-id rofi -theme ~/.config/rofi/nord.rasi -show run
<span style="color: #BA36A5;">bindsym</span> $mod+b exec --no-startup-id rofi -theme ~/.config/rofi/nord.rasi -show window

<span style="color: #BA36A5;">bindsym</span> $mod+e exec --no-startup-id emacsclient -c
<span style="color: #BA36A5;">bindsym</span> $mod+a exec --no-startup-id thunar      
</pre>
</div>

<p>
Window focus:
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">bindsym</span> $mod+h focus left
<span style="color: #BA36A5;">bindsym</span> $mod+j focus down
<span style="color: #BA36A5;">bindsym</span> $mod+k focus up
<span style="color: #BA36A5;">bindsym</span> $mod+l focus right
<span style="color: #BA36A5;">bindsym</span> Mod1+Tab focus right
<span style="color: #BA36A5;">bindsym</span> Mod1+Shift+Tab focus left
<span style="color: #BA36A5;">bindsym</span> $mod+Left focus left
<span style="color: #BA36A5;">bindsym</span> $mod+Down focus down
<span style="color: #BA36A5;">bindsym</span> $mod+Up focus up
<span style="color: #BA36A5;">bindsym</span> $mod+Right focus right
</pre>
</div>

<p>
Moving and resizing windows:
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">bindsym</span> $mod+Shift+h move left
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+j move down
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+k move up
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+l move right

<span style="color: #BA36A5;">bindsym</span> $mod+Tab move right
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+Tab move left

<span style="color: #BA36A5;">bindsym</span> $mod+Shift+Left move left
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+Down move down
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+Up move up
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+Right move right

<span style="color: #BA36A5;">bindsym</span> $mod+Control+h resize shrink width 2 px or 2 ppt
<span style="color: #BA36A5;">bindsym</span> $mod+Control+j resize grow height 2 px or 2 ppt
<span style="color: #BA36A5;">bindsym</span> $mod+Control+k resize shrink height 2 px or 2 ppt
<span style="color: #BA36A5;">bindsym</span> $mod+Control+l resize grow width 2 px or 2 ppt
</pre>
</div>

<p>
Splitting and layouts:
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">bindsym</span> $mod+v split h

<span style="color: #BA36A5;">bindsym</span> $mod+c split v

<span style="color: #BA36A5;">bindsym</span> $mod+s split toggle

<span style="color: #BA36A5;">bindsym</span> $mod+f fullscreen toggle

<span style="color: #BA36A5;">bindsym</span> $mod+Shift+s layout stacking
<span style="color: #BA36A5;">bindsym</span> $mod+w layout tabbed
<span style="color: #BA36A5;">bindsym</span> $mod+y layout toggle split

<span style="color: #BA36A5;">bindsym</span> $mod+Shift+space floating toggle

<span style="color: #BA36A5;">bindsym</span> $mod+space focus mode_toggle

<span style="color: #BA36A5;">bindsym</span> $mod+Shift+x focus parent

<span style="color: #BA36A5;">bindsym</span> $mod+x focus child
</pre>
</div>

<p>
Next let's set some workspace names and bindings.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">set</span> $ws1 <span style="color: #008000;">"1:&#955;"</span>
<span style="color: #BA36A5;">set</span> $ws2 <span style="color: #008000;">"2:&#945;"</span>
<span style="color: #BA36A5;">set</span> $ws3 <span style="color: #008000;">"3:&#946;"</span>
<span style="color: #BA36A5;">set</span> $ws4 <span style="color: #008000;">"4:&#947;"</span>
<span style="color: #BA36A5;">set</span> $ws5 <span style="color: #008000;">"5:&#948;"</span>
<span style="color: #BA36A5;">set</span> $ws6 <span style="color: #008000;">"6:&#949;"</span>
<span style="color: #BA36A5;">set</span> $ws7 <span style="color: #008000;">"7:&#950;"</span>
<span style="color: #BA36A5;">set</span> $ws8 <span style="color: #008000;">"8:&#951;"</span>
<span style="color: #BA36A5;">set</span> $ws9 <span style="color: #008000;">"9:&#952;"</span>
<span style="color: #BA36A5;">set</span> $ws10 <span style="color: #008000;">"10:&#953;"</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">switch to workspace</span>
<span style="color: #BA36A5;">bindsym</span> $mod+plus workspace $ws1
<span style="color: #BA36A5;">bindsym</span> $mod+ecaron workspace $ws2
<span style="color: #BA36A5;">bindsym</span> $mod+scaron workspace $ws3
<span style="color: #BA36A5;">bindsym</span> $mod+ccaron workspace $ws4
<span style="color: #BA36A5;">bindsym</span> $mod+rcaron workspace $ws5
<span style="color: #BA36A5;">bindsym</span> $mod+zcaron workspace $ws6
<span style="color: #BA36A5;">bindsym</span> $mod+yacute workspace $ws7
<span style="color: #BA36A5;">bindsym</span> $mod+aacute workspace $ws8
<span style="color: #BA36A5;">bindsym</span> $mod+iacute workspace $ws9
<span style="color: #BA36A5;">bindsym</span> $mod+eacute workspace $ws10

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">move focused container to workspace</span>
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+plus move container to workspace $ws1
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+ecaron move container to workspace $ws2
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+scaron move container to workspace $ws3
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+ccaron move container to workspace $ws4
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+rcaron move container to workspace $ws5
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+zcaron move container to workspace $ws6
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+yacute move container to workspace $ws7
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+aacute move container to workspace $ws8
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+iacute move container to workspace $ws9
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+eacute move container to workspace $ws10  
</pre>
</div>

<p>
Now for session commands:
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">bindsym</span> $mod+Shift+r reload
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">restart i3 inplace (preserves your layout/session, can be used to upgrade i3)</span>
<span style="color: #BA36A5;">bindsym</span> $mod+Control+r restart
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">exit i3 (logs you out of your X session)</span>
<span style="color: #BA36A5;">bindsym</span> $mod+Shift+e exec <span style="color: #008000;">"i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -B 'Yes, exit i3' 'i3-msg exit'"</span>
</pre>
</div>

<p>
Let's handle colors next; following the Nord colorscheme here.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">set</span> $bg-color            <span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">88c0d0</span>
<span style="color: #BA36A5;">set</span> $active-border-color <span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">FFFFFF</span>
<span style="color: #BA36A5;">set</span> $inactive-bg-color   <span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">2E3440</span>
<span style="color: #BA36A5;">set</span> $text-color          <span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">f5f5f5</span>
<span style="color: #BA36A5;">set</span> $inactive-text-color <span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">d8dee9</span>
<span style="color: #BA36A5;">set</span> $urgent-bg-color     <span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">FF0000</span>

<span style="color: #BA36A5;">client.focused</span>          $bg-color           $bg-color          $inactive-bg-color          $active-border-color
<span style="color: #BA36A5;">client.unfocused</span>        $inactive-bg-color $inactive-bg-color $inactive-text-color $inactive-bg-color
<span style="color: #BA36A5;">client.focused_inactive</span> $inactive-bg-color $inactive-bg-color $inactive-text-color $inactive-bg-color
<span style="color: #BA36A5;">client.urgent</span>           $urgent-bg-color    $urgent-bg-color   $text-color          $urgent-bg-color


<span style="color: #BA36A5;">client.background</span>       <span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">2B2C2B</span>
</pre>
</div>

<p>
Finally let's configure the i3 bar.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #6434A3;">bar</span> {
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">strip_workspace_numbers yes</span>
<span style="color: #BA36A5;">position</span> top
<span style="color: #BA36A5;">mode</span> dock
</pre>
</div>

<p>
This part here is rather interesting, I pipe the status through my own wrapper, which makes extra modifications to the output.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">status_command</span> i3status | ~/.config/i3/i3status_wrapper.py
</pre>
</div>

<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #6434A3;">colors</span> {
<span style="color: #BA36A5;">background</span> $inactive-bg-color
<span style="color: #BA36A5;">separator</span> $inactive-bg-color
<span style="color: #8D8D84; font-style: italic;">#                  </span><span style="color: #8D8D84; font-style: italic;">border             background         text</span>
<span style="color: #BA36A5;">focused_workspace</span>  $bg-color          $bg-color          $inactive-bg-color
<span style="color: #BA36A5;">inactive_workspace</span> $inactive-bg-color $inactive-bg-color $inactive-text-color
<span style="color: #BA36A5;">urgent_workspace</span>   $urgent-bg-color   $urgent-bg-color   $inactive-bg-color
<span style="color: #BA36A5;">}</span>
<span style="color: #BA36A5;">}</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2deee67" class="outline-3">
<h3 id="org2deee67"><span class="section-number-3">7.2.</span> .config/i3/i3status<sub>wrapper.py</sub></h3>
<div class="outline-text-3" id="text-7-2">
<p>
This small python wrapper add the currently playing song as a prefix to the status. Rather neat but took a while to implement.
I won't bother commenting this code, just believe me (and maybe pray) that it works.
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #8D8D84; font-style: italic;">#!/usr/bin/env python3</span>
<span style="color: #0000FF;">import</span> json
<span style="color: #0000FF;">import</span> subprocess
<span style="color: #0000FF;">import</span> sys

<span style="color: #0000FF;">def</span> <span style="color: #006699;">get_status</span><span style="color: #707183;">()</span>:
    <span style="color: #BA36A5;">status</span> <span style="color: #0000FF;">=</span> subprocess.<span style="color: #006DAF; font-style: italic;">getoutput</span><span style="color: #707183;">(</span><span style="color: #008000;">'playerctl status'</span><span style="color: #707183;">)</span>
    <span style="color: #0000FF;">if</span> <span style="color: #008000;">'Playing'</span> <span style="color: #0000FF;">in</span> status:
        <span style="color: #0000FF;">return</span> <span style="color: #008000;">"&#9654;&#65039;"</span>
    <span style="color: #0000FF;">elif</span> <span style="color: #008000;">'Paused'</span> <span style="color: #0000FF;">in</span> status:
        <span style="color: #0000FF;">return</span> <span style="color: #008000;">"&#9208;&#65038;"</span>
    <span style="color: #0000FF;">elif</span> <span style="color: #008000;">'Stopped'</span> <span style="color: #0000FF;">in</span> status:
        <span style="color: #0000FF;">return</span> <span style="color: #008000;">"&#9209;&#65038;"</span>
    <span style="color: #0000FF;">else</span>:
        <span style="color: #0000FF;">return</span> <span style="color: #008000;">""</span>

<span style="color: #0000FF;">def</span> <span style="color: #006699;">get_current_music_title</span><span style="color: #707183;">()</span>:
    <span style="color: #BA36A5;">title</span> <span style="color: #0000FF;">=</span> subprocess.<span style="color: #006DAF; font-style: italic;">getoutput</span><span style="color: #707183;">(</span><span style="color: #008000;">'playerctl metadata title'</span><span style="color: #707183;">)</span>
    <span style="color: #0000FF;">if</span> <span style="color: #008000;">'No players found'</span> <span style="color: #0000FF;">in</span> title:
        <span style="color: #0000FF;">return</span> <span style="color: #008000;">""</span>
    <span style="color: #BA36A5;">artist</span> <span style="color: #0000FF;">=</span> subprocess.<span style="color: #006DAF; font-style: italic;">getoutput</span><span style="color: #707183;">(</span><span style="color: #008000;">'playerctl metadata artist'</span><span style="color: #707183;">)</span>
    <span style="color: #BA36A5;">status</span> <span style="color: #0000FF;">=</span> <span style="color: #006DAF;">get_status</span><span style="color: #707183;">()</span>
    <span style="color: #0000FF;">return</span> <span style="color: #008000;">f"</span><span style="color: #0000FF;">{</span><span style="color: #333333; background-color: #FFFFFF;">status</span><span style="color: #0000FF;">}</span><span style="color: #008000;"> </span><span style="color: #0000FF;">{</span><span style="color: #333333; background-color: #FFFFFF;">artist</span><span style="color: #0000FF;">}</span><span style="color: #008000;"> - </span><span style="color: #0000FF;">{</span><span style="color: #333333; background-color: #FFFFFF;">title</span><span style="color: #0000FF;">}</span><span style="color: #008000;">"</span>

<span style="color: #0000FF;">def</span> <span style="color: #006699;">print_line</span><span style="color: #707183;">(</span><span style="color: #BA36A5;">message</span><span style="color: #707183;">)</span>:
    <span style="color: #008000; font-style: italic;">"""</span><span style="color: #036A07; font-style: italic;"> Non-buffered printing to stdout. </span><span style="color: #008000; font-style: italic;">"""</span>
    sys.<span style="color: #D0372D; font-style: italic;">stdout</span>.<span style="color: #006DAF; font-style: italic;">write</span><span style="color: #707183;">(</span>message <span style="color: #0000FF;">+</span> <span style="color: #008000;">'</span><span style="color: #0000FF;">\n</span><span style="color: #008000;">'</span><span style="color: #707183;">)</span>
    sys.<span style="color: #D0372D; font-style: italic;">stdout</span>.<span style="color: #006DAF; font-style: italic;">flush</span><span style="color: #707183;">()</span>

<span style="color: #0000FF;">def</span> <span style="color: #006699;">read_line</span><span style="color: #707183;">()</span>:
    <span style="color: #008000; font-style: italic;">"""</span><span style="color: #036A07; font-style: italic;"> Interrupted respecting reader for stdin. </span><span style="color: #008000; font-style: italic;">"""</span>
    <span style="color: #8D8D84; font-style: italic;"># try reading a line, removing any extra whitespace</span>
    <span style="color: #0000FF;">try</span>:
        <span style="color: #BA36A5;">line</span> <span style="color: #0000FF;">=</span> sys.<span style="color: #D0372D; font-style: italic;">stdin</span>.<span style="color: #006DAF; font-style: italic;">readline</span><span style="color: #707183;">()</span>.<span style="color: #006DAF; font-style: italic;">strip</span><span style="color: #707183;">()</span>
        <span style="color: #8D8D84; font-style: italic;"># i3status sends EOF, or an empty line</span>
        <span style="color: #0000FF;">if</span> <span style="color: #0000FF;">not</span> line:
            sys.<span style="color: #006DAF; font-style: italic;">exit</span><span style="color: #707183;">(</span><span style="color: #D0372D;">3</span><span style="color: #707183;">)</span>
        <span style="color: #0000FF;">return</span> line
    <span style="color: #8D8D84; font-style: italic;"># exit on ctrl-c</span>
    <span style="color: #0000FF;">except</span> <span style="color: #6434A3;">KeyboardInterrupt</span>:
        sys.<span style="color: #006DAF; font-style: italic;">exit</span><span style="color: #707183;">()</span>


<span style="color: #0000FF;">if</span> <span style="color: #006FE0;">__name__</span> <span style="color: #0000FF;">==</span> <span style="color: #008000;">'__main__'</span>:
    <span style="color: #8D8D84; font-style: italic;"># Skip the first line which contains the version header.</span>
    <span style="color: #006DAF;">print_line</span><span style="color: #707183;">(</span><span style="color: #006DAF;">read_line</span><span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>

    <span style="color: #8D8D84; font-style: italic;"># The second line contains the start of the infinite array.</span>
    <span style="color: #006DAF;">print_line</span><span style="color: #707183;">(</span><span style="color: #006DAF;">read_line</span><span style="color: #7388D6;">()</span><span style="color: #707183;">)</span>

    <span style="color: #0000FF;">while</span> <span style="color: #006FE0;">True</span>:
        <span style="color: #BA36A5;">line</span>, <span style="color: #BA36A5;">prefix</span> <span style="color: #0000FF;">=</span> <span style="color: #006DAF;">read_line</span><span style="color: #707183;">()</span>, <span style="color: #008000;">''</span>

        <span style="color: #8D8D84; font-style: italic;"># ignore comma at start of lines</span>
        <span style="color: #0000FF;">if</span> line.<span style="color: #006DAF; font-style: italic;">startswith</span><span style="color: #707183;">(</span><span style="color: #008000;">','</span><span style="color: #707183;">)</span>:
            <span style="color: #BA36A5;">line</span>, <span style="color: #BA36A5;">prefix</span> <span style="color: #0000FF;">=</span> line<span style="color: #707183;">[</span><span style="color: #D0372D;">1</span>:<span style="color: #707183;">]</span>, <span style="color: #008000;">','</span>
            <span style="color: #BA36A5;">j</span> <span style="color: #0000FF;">=</span> json.<span style="color: #006DAF; font-style: italic;">loads</span><span style="color: #707183;">(</span>line<span style="color: #707183;">)</span>

        <span style="color: #BA36A5;">music_title</span> <span style="color: #0000FF;">=</span> <span style="color: #006DAF;">get_current_music_title</span><span style="color: #707183;">()</span>
        <span style="color: #8D8D84; font-style: italic;"># this is where the magic happens</span>
        <span style="color: #8D8D84; font-style: italic;"># https://i3wm.org/docs/i3bar-protocol.html</span>
        j.<span style="color: #006DAF; font-style: italic;">insert</span><span style="color: #707183;">(</span><span style="color: #D0372D;">0</span>, <span style="color: #7388D6;">{</span>
            <span style="color: #8D8D84; font-style: italic;"># 'background': '#FFFFFF',</span>
            <span style="color: #008000;">'full_text'</span>: <span style="color: #008000;">'%s'</span> <span style="color: #0000FF;">%</span> music_title,
            <span style="color: #008000;">'color'</span>: <span style="color: #008000;">'#f442f7'</span>,
            <span style="color: #008000;">'name'</span>: <span style="color: #008000;">'music_title'</span>,
            <span style="color: #008000;">'separator_block_width'</span>: <span style="color: #D0372D;">0</span><span style="color: #7388D6;">}</span><span style="color: #707183;">)</span>
        j.<span style="color: #006DAF; font-style: italic;">insert</span><span style="color: #707183;">(</span><span style="color: #D0372D;">1</span>, <span style="color: #7388D6;">{</span>
            <span style="color: #8D8D84; font-style: italic;"># 'background': '#FFFFFF',</span>
            <span style="color: #008000;">'full_text'</span>: <span style="color: #008000;">' || '</span>,
            <span style="color: #008000;">'color'</span>: <span style="color: #008000;">'#FFFFFF'</span>,
            <span style="color: #008000;">'name'</span>: <span style="color: #008000;">'separator'</span>,
            <span style="color: #008000;">'separator_block_width'</span>: <span style="color: #D0372D;">0</span><span style="color: #7388D6;">}</span><span style="color: #707183;">)</span>

        <span style="color: #006DAF;">print_line</span><span style="color: #707183;">(</span>prefix<span style="color: #0000FF;">+</span>json.<span style="color: #006DAF; font-style: italic;">dumps</span><span style="color: #7388D6;">(</span>j<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9623c58" class="outline-3">
<h3 id="org9623c58"><span class="section-number-3">7.3.</span> .config/i3status/config</h3>
<div class="outline-text-3" id="text-7-3">
<p>
So this is the actual i3status config.
</p>

<p>
Let's set some colors first of all.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #6434A3;">general</span> {
<span style="color: #BA36A5;">colors</span> = true
<span style="color: #BA36A5;">color_good</span> = <span style="color: #008000;">"#a3be8c"</span>
<span style="color: #BA36A5;">color_degraded</span> = <span style="color: #008000;">"#ebcb8b"</span>
<span style="color: #BA36A5;">color_bad</span> = <span style="color: #008000;">"#bf616a"</span>
<span style="color: #BA36A5;">interval</span> = 1
<span style="color: #BA36A5;">}</span>
</pre>
</div>

<p>
Now let's set the order of the items.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #BA36A5;">order</span> += <span style="color: #008000;">"ethernet _first_"</span>
<span style="color: #BA36A5;">order</span> += separator
<span style="color: #BA36A5;">order</span> += <span style="color: #008000;">"volume master"</span>
<span style="color: #BA36A5;">order</span> += separator
<span style="color: #BA36A5;">order</span> += <span style="color: #008000;">"tztime local"</span>
</pre>
</div>

<p>
And finally configure the individual items.
</p>
<div class="org-src-container">
<pre class="src src-conf-space"><span style="color: #6434A3;">volume master</span> {
<span style="color: #BA36A5;">format</span> = <span style="color: #008000;">"|| %volume"</span>
<span style="color: #BA36A5;">format_muted</span> = <span style="color: #008000;">"|| (%volume)"</span>
<span style="color: #BA36A5;">device</span> = <span style="color: #008000;">"pulse:1"</span>
<span style="color: #BA36A5;">}</span>

<span style="color: #6434A3;">wireless _first_</span> {
<span style="color: #BA36A5;">format_up</span> = <span style="color: #008000;">"W: (%quality at %essid) %ip"</span>
<span style="color: #BA36A5;">format_down</span> = <span style="color: #008000;">"W: down"</span>
<span style="color: #BA36A5;">}</span>

<span style="color: #6434A3;">ethernet _first_</span> {
<span style="color: #BA36A5;">format_up</span> = <span style="color: #008000;">"%ip"</span>
<span style="color: #BA36A5;">format_down</span> = <span style="color: #008000;">"down"</span>
<span style="color: #BA36A5;">}</span>

<span style="color: #6434A3;">battery all</span> {
<span style="color: #BA36A5;">format</span> = <span style="color: #008000;">"%status %percentage %remaining"</span>
<span style="color: #BA36A5;">}</span>

<span style="color: #BA36A5;">disk</span> <span style="color: #008000;">"/"</span> {
<span style="color: #BA36A5;">format</span> = <span style="color: #008000;">"%avail"</span>
<span style="color: #BA36A5;">}</span>

<span style="color: #6434A3;">load</span> {
<span style="color: #BA36A5;">format</span> = <span style="color: #008000;">"%1min"</span>
<span style="color: #BA36A5;">}</span>

<span style="color: #6434A3;">memory</span> {
<span style="color: #BA36A5;">format</span> = <span style="color: #008000;">"%used | %available"</span>
<span style="color: #BA36A5;">threshold_degraded</span> = <span style="color: #008000;">"1G"</span>
<span style="color: #BA36A5;">format_degraded</span> = <span style="color: #008000;">"MEMORY &lt; %available"</span>
<span style="color: #BA36A5;">}</span>

<span style="color: #6434A3;">tztime local</span> {
<span style="color: #BA36A5;">format</span> = <span style="color: #008000;">"|| %H:%M %d.%m.%Y"</span>
<span style="color: #BA36A5;">}</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb2850ce" class="outline-2">
<h2 id="orgb2850ce"><span class="section-number-2">8.</span> Picom</h2>
<div class="outline-text-2" id="text-8">
<p>
Picom is the compositor I choose to use with i3 and EXWM.
</p>
</div>

<div id="outline-container-org278bd41" class="outline-3">
<h3 id="org278bd41"><span class="section-number-3">8.1.</span> .config/picom/picom.conf</h3>
<div class="outline-text-3" id="text-8-1">
<div class="org-src-container">
<pre class="src src-conf-unix"><span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;">#          </span><span style="color: #8D8D84; font-style: italic;">Animations           #</span>
<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">requires https://github.com/jonaburg/picom</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">(These are also the default values)</span>
<span style="color: #BA36A5;">transition-length</span> = 300
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">transition-length = 0</span>
<span style="color: #BA36A5;">transition-pow-x</span> = 0.1
<span style="color: #BA36A5;">transition-pow-y</span> = 0.1
<span style="color: #BA36A5;">transition-pow-w</span> = 0.1
<span style="color: #BA36A5;">transition-pow-h</span> = 0.1
<span style="color: #BA36A5;">size-transition</span> = true


<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;">#             </span><span style="color: #8D8D84; font-style: italic;">Corners           #</span>
<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">requires: https://github.com/sdhand/compton or https://github.com/jonaburg/picom</span>
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">corner-radius = 9.0;</span>
<span style="color: #BA36A5;">corner-radius</span> = 0;
<span style="color: #BA36A5;">rounded-corners-exclude</span> = [
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">"window_type = 'normal'",</span>
<span style="color: #008000;">"class_g = 'awesome'"</span>,
<span style="color: #8D8D84; font-style: italic;">#  </span><span style="color: #8D8D84; font-style: italic;">"class_g = 'dwm'",</span>
<span style="color: #008000;">"class_g = 'i3bar'"</span>,
<span style="color: #008000;">"class_g = 'XTerm'"</span>,
<span style="color: #008000;">"class_g = 'kitty'"</span>,
<span style="color: #008000;">"class_g = 'Alacritty'"</span>,
<span style="color: #008000;">"class_g = 'Polybar'"</span>,
<span style="color: #008000;">"class_g = 'code-oss'"</span>,
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">"class_g = 'TelegramDesktop'",</span>
<span style="color: #8D8D84; font-style: italic;">#  </span><span style="color: #8D8D84; font-style: italic;">"class_g = 'firefox'",</span>
<span style="color: #008000;">"class_g = 'Thunderbird'"</span>
];
<span style="color: #BA36A5;">round-borders</span> = 1;
<span style="color: #BA36A5;">round-borders-exclude</span> = [
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">"class_g = 'TelegramDesktop'",</span>
];

<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;">#             </span><span style="color: #8D8D84; font-style: italic;">Shadows           #</span>
<span style="color: #8D8D84; font-style: italic;">#################################</span>


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Enabled client-side shadows on windows. Note desktop windows </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">(windows with '_NET_WM_WINDOW_TYPE_DESKTOP') never get shadow, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">unless explicitly requested using the wintypes option.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow = false</span>
<span style="color: #BA36A5;">shadow</span> = false;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">The blur radius for shadows, in pixels. (defaults to 12)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-radius = 12</span>
<span style="color: #BA36A5;">shadow-radius</span> = 7;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">The opacity of shadows. (0.0 - 1.0, defaults to 0.75)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-opacity = .75</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">The left offset for shadows, in pixels. (defaults to -15)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-offset-x = -15</span>
<span style="color: #BA36A5;">shadow-offset-x</span> = -7;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">The top offset for shadows, in pixels. (defaults to -15)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-offset-y = -15</span>
<span style="color: #BA36A5;">shadow-offset-y</span> = -7;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Avoid drawing shadows on dock/panel windows. This option is deprecated,</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">you should use the *wintypes* option in your config file instead.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">no-dock-shadow = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Don't draw shadows on drag-and-drop windows. This option is deprecated, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">you should use the *wintypes* option in your config file instead.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">no-dnd-shadow = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Red color value of shadow (0.0 - 1.0, defaults to 0).</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-red = 0</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Green color value of shadow (0.0 - 1.0, defaults to 0).</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-green = 0</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Blue color value of shadow (0.0 - 1.0, defaults to 0).</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-blue = 0</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Do not paint shadows on shaped windows. Note shaped windows </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">here means windows setting its shape through X Shape extension. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Those using ARGB background is beyond our control. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Deprecated, use </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">shadow-exclude = 'bounding_shaped'</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">or </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">shadow-exclude = 'bounding_shaped &amp;&amp; !rounded_corners'</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">instead.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-ignore-shaped = ''</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify a list of conditions of windows that should have no shadow.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">examples:</span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">shadow-exclude = "n:e:Notification";</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-exclude = []</span>
<span style="color: #BA36A5;">shadow-exclude</span> = [
<span style="color: #008000;">"name = 'Notification'"</span>,
<span style="color: #008000;">"name = 'i3bar'"</span>,
<span style="color: #008000;">"class_g = 'Conky'"</span>,
<span style="color: #008000;">"class_g ?= 'Notify-osd'"</span>,
<span style="color: #008000;">"class_g = 'Cairo-clock'"</span>,
<span style="color: #008000;">"class_g = 'slop'"</span>,
<span style="color: #008000;">"class_g = 'Polybar'"</span>,
<span style="color: #008000;">"_GTK_FRAME_EXTENTS@:c"</span>
];

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify a X geometry that describes the region in which shadow should not</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">be painted in, such as a dock window region. Use </span>
<span style="color: #8D8D84; font-style: italic;">#    </span><span style="color: #8D8D84; font-style: italic;">shadow-exclude-reg = "x10+0+0"</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">for example, if the 10 pixels on the bottom of the screen should not have shadows painted on.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shadow-exclude-reg = "" </span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Crop shadow of a window fully on a particular Xinerama screen to the screen.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">xinerama-shadow-crop = false</span>


<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;">#           </span><span style="color: #8D8D84; font-style: italic;">Fading              #</span>
<span style="color: #8D8D84; font-style: italic;">#################################</span>


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Fade windows in/out when opening/closing and when opacity changes,</span>
<span style="color: #8D8D84; font-style: italic;">#  </span><span style="color: #8D8D84; font-style: italic;">unless no-fading-openclose is used.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">fading = false</span>
<span style="color: #BA36A5;">fading</span> = true;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Opacity change between steps while fading in. (0.01 - 1.0, defaults to 0.028)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">fade-in-step = 0.028</span>
<span style="color: #BA36A5;">fade-in-step</span> = 0.03;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Opacity change between steps while fading out. (0.01 - 1.0, defaults to 0.03)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">fade-out-step = 0.03</span>
<span style="color: #BA36A5;">fade-out-step</span> = 0.03;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">The time between steps in fade step, in milliseconds. (&gt; 0, defaults to 10)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">fade-delta = 10</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify a list of conditions of windows that should not be faded.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">don't need this, we disable fading for all normal windows with wintypes: {}</span>
<span style="color: #BA36A5;">fade-exclude</span> = [
<span style="color: #008000;">"class_g = 'slop'"</span>   <span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">maim</span>
]

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Do not fade on window open/close.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">no-fading-openclose = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Do not fade destroyed ARGB windows with WM frame. Workaround of bugs in Openbox, Fluxbox, etc.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">no-fading-destroyed-argb = false</span>


<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">Transparency / Opacity      #</span>
<span style="color: #8D8D84; font-style: italic;">#################################</span>


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Opacity of inactive windows. (0.1 - 1.0, defaults to 1.0)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">inactive-opacity = 1</span>
<span style="color: #BA36A5;">inactive-opacity</span> = 1;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Opacity of window titlebars and borders. (0.1 - 1.0, disabled by default)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">frame-opacity = 1.0</span>
<span style="color: #BA36A5;">frame-opacity</span> = 1.0;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Default opacity for dropdown menus and popup menus. (0.0 - 1.0, defaults to 1.0)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">menu-opacity = 1.0 </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">menu-opacity is depreciated use dropdown-menu and popup-menu instead.</span>

<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">If using these 2 below change their values in line 510 &amp; 511 aswell</span>
<span style="color: #BA36A5;">popup_menu</span> = { opacity = 1; }
<span style="color: #BA36A5;">dropdown_menu</span> = { opacity = 1; }


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Let inactive opacity set by -i override the '_NET_WM_OPACITY' values of windows.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">inactive-opacity-override = true</span>
<span style="color: #BA36A5;">inactive-opacity-override</span> = false;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Default opacity for active windows. (0.0 - 1.0, defaults to 1.0)</span>
<span style="color: #BA36A5;">active-opacity</span> = 1.0;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Dim inactive windows. (0.0 - 1.0, defaults to 0.0)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">inactive-dim = 0.0</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify a list of conditions of windows that should always be considered focused.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">focus-exclude = []</span>
<span style="color: #BA36A5;">focus-exclude</span> = [
<span style="color: #008000;">"class_g = 'Cairo-clock'"</span>,
<span style="color: #008000;">"class_g = 'Bar'"</span>,                    <span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">lemonbar</span>
<span style="color: #008000;">"class_g = 'slop'"</span>                    <span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">maim</span>
];

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Use fixed inactive dim value, instead of adjusting according to window opacity.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">inactive-dim-fixed = 1.0</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify a list of opacity rules, in the format `PERCENT:PATTERN`, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">like `50:name *= "Firefox"`. picom-trans is recommended over this. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Note we don't make any guarantee about possible conflicts with other </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">programs that set '_NET_WM_WINDOW_OPACITY' on frame or client windows.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">example:</span>
<span style="color: #8D8D84; font-style: italic;">#    </span><span style="color: #8D8D84; font-style: italic;">opacity-rule = [ "80:class_g = 'URxvt'" ];</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">opacity-rule = []</span>
<span style="color: #BA36A5;">opacity-rule</span> = [
<span style="color: #008000;">"80:class_g     = 'Bar'"</span>,             <span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">lemonbar</span>
<span style="color: #008000;">"100:class_g    = 'slop'"</span>,            <span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">maim</span>
<span style="color: #008000;">"100:class_g    = 'XTerm'"</span>,
<span style="color: #008000;">"100:class_g    = 'URxvt'"</span>,
<span style="color: #008000;">"100:class_g    = 'kitty'"</span>,
<span style="color: #008000;">"100:class_g    = 'Alacritty'"</span>,
<span style="color: #008000;">"80:class_g     = 'Polybar'"</span>,
<span style="color: #008000;">"98:class_g     = 'Emacs'"</span>,
<span style="color: #008000;">"97:class_g     = 'Thunar'"</span>,
<span style="color: #008000;">"100:class_g    = 'code-oss'"</span>,
<span style="color: #008000;">"100:class_g    = 'Meld'"</span>,
<span style="color: #008000;">"70:class_g     = 'TelegramDesktop'"</span>,
<span style="color: #008000;">"90:class_g     = 'Joplin'"</span>,
<span style="color: #008000;">"100:class_g    = 'firefox'"</span>,
<span style="color: #008000;">"100:class_g    = 'Thunderbird'"</span>
];


<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">Background-Blurring       #</span>
<span style="color: #8D8D84; font-style: italic;">#################################</span>


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Parameters for background blurring, see the *BLUR* section for more information.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-method = </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-size = 12</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-deviation = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Blur background of semi-transparent / ARGB windows. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Bad in performance, with driver-dependent behavior. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">The name of the switch may change without prior notifications.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-background = true;</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Blur background of windows when the window frame is not opaque. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Implies:</span>
<span style="color: #8D8D84; font-style: italic;">#    </span><span style="color: #8D8D84; font-style: italic;">blur-background </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Bad in performance, with driver-dependent behavior. The name may change.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-background-frame = false;</span>


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Use fixed blur strength rather than adjusting according to window opacity.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-background-fixed = false;</span>


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify the blur convolution kernel, with the following format:</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">example:</span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">blur-kern = "5,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1";</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-kern = ''</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">blur-kern = "3x3box";</span>

blur: {
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">requires: https://github.com/ibhagwan/picom</span>
<span style="color: #BA36A5;">method</span> = <span style="color: #008000;">"kawase"</span>;
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">method = "kernel";</span>
<span style="color: #BA36A5;">strength</span> = 3;
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">deviation = 1.0;</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">kernel = "11x11gaussian";</span>
<span style="color: #BA36A5;">background</span> = false;
<span style="color: #BA36A5;">background-frame</span> = false;
<span style="color: #BA36A5;">background-fixed</span> = false;
<span style="color: #BA36A5;">kern</span> = <span style="color: #008000;">"3x3box"</span>;
}

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Exclude conditions for background blur.</span>
<span style="color: #BA36A5;">blur-background-exclude</span> = [
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">"window_type = 'dock'",</span>
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">"window_type = 'desktop'",</span>
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">"class_g = 'URxvt'",</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">prevents picom from blurring the background</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">when taking selection screenshot with `main`</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">https://github.com/naelstrof/maim/issues/130</span>
<span style="color: #008000;">"class_g = 'slop'"</span>,
<span style="color: #008000;">"_GTK_FRAME_EXTENTS@:c"</span>
];


<span style="color: #8D8D84; font-style: italic;">#################################</span>
<span style="color: #8D8D84; font-style: italic;">#       </span><span style="color: #8D8D84; font-style: italic;">General Settings        #</span>
<span style="color: #8D8D84; font-style: italic;">#################################</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Daemonize process. Fork to background after initialization. Causes issues with certain (badly-written) drivers.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">daemon = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify the backend to use: `xrender`, `glx`, or `xr_glx_hybrid`.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">`xrender` is the default one.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #BA36A5;">experimental-backends</span> = true;
<span style="color: #BA36A5;">backend</span> = <span style="color: #008000;">"glx"</span>;
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">backend = "xrender";</span>


<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Enable/disable VSync.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">vsync = false</span>
<span style="color: #BA36A5;">vsync</span> = true

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Enable remote control via D-Bus. See the *D-BUS API* section below for more details.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">dbus = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Try to detect WM windows (a non-override-redirect window with no </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">child that has 'WM_STATE') and mark them as active.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">mark-wmwin-focused = false</span>
<span style="color: #BA36A5;">mark-wmwin-focused</span> = true;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Mark override-redirect windows that doesn't have a child window with 'WM_STATE' focused.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">mark-ovredir-focused = false</span>
<span style="color: #BA36A5;">mark-ovredir-focused</span> = true;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Try to detect windows with rounded corners and don't consider them </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">shaped windows. The accuracy is not very high, unfortunately.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">detect-rounded-corners = false</span>
<span style="color: #BA36A5;">detect-rounded-corners</span> = true;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Detect '_NET_WM_OPACITY' on client windows, useful for window managers</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">not passing '_NET_WM_OPACITY' of client windows to frame windows.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">detect-client-opacity = false</span>
<span style="color: #BA36A5;">detect-client-opacity</span> = true;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify refresh rate of the screen. If not specified or 0, picom will </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">try detecting this with X RandR extension.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">refresh-rate = 60</span>
<span style="color: #BA36A5;">refresh-rate</span> = 0

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Limit picom to repaint at most once every 1 / 'refresh_rate' second to </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">boost performance. This should not be used with </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">vsync drm/opengl/opengl-oml</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">as they essentially does sw-opti's job already, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">unless you wish to specify a lower refresh rate than the actual value.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">sw-opti = </span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Use EWMH '_NET_ACTIVE_WINDOW' to determine currently focused window, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">rather than listening to 'FocusIn'/'FocusOut' event. Might have more accuracy, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">provided that the WM supports it.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">use-ewmh-active-win = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Unredirect all windows if a full-screen opaque window is detected, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">to maximize performance for full-screen windows. Known to cause flickering </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">when redirecting/unredirecting windows. paint-on-overlay may make the flickering less obvious.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">unredir-if-possible = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Delay before unredirecting the window, in milliseconds. Defaults to 0.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">unredir-if-possible-delay = 0</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Conditions of windows that shouldn't be considered full-screen for unredirecting screen.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">unredir-if-possible-exclude = []</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Use 'WM_TRANSIENT_FOR' to group windows, and consider windows </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">in the same group focused at the same time.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">detect-transient = false</span>
<span style="color: #BA36A5;">detect-transient</span> = true

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Use 'WM_CLIENT_LEADER' to group windows, and consider windows in the same </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">group focused at the same time. 'WM_TRANSIENT_FOR' has higher priority if </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">detect-transient is enabled, too.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">detect-client-leader = false</span>
<span style="color: #BA36A5;">detect-client-leader</span> = true

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Resize damaged region by a specific number of pixels. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">A positive value enlarges it while a negative one shrinks it. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">If the value is positive, those additional pixels will not be actually painted </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">to screen, only used in blur calculation, and such. (Due to technical limitations, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">with use-damage, those pixels will still be incorrectly painted to screen.) </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Primarily used to fix the line corruption issues of blur, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">in which case you should use the blur radius value here </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">(e.g. with a 3x3 kernel, you should use `--resize-damage 1`, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">with a 5x5 one you use `--resize-damage 2`, and so on). </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">May or may not work with *--glx-no-stencil*. Shrinking doesn't function correctly.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">resize-damage = 1</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Specify a list of conditions of windows that should be painted with inverted color. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Resource-hogging, and is not well tested.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">invert-color-include = []</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">GLX backend: Avoid using stencil buffer, useful if you don't have a stencil buffer. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Might cause incorrect opacity when rendering transparent content (but never </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">practically happened) and may not work with blur-background. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">My tests show a 15% performance boost. Recommended.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">glx-no-stencil = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">GLX backend: Avoid rebinding pixmap on window damage. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Probably could improve performance on rapid window content changes, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">but is known to break things on some drivers (LLVMpipe, xf86-video-intel, etc.).</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Recommended if it works.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">glx-no-rebind-pixmap = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Disable the use of damage information. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">This cause the whole screen to be redrawn everytime, instead of the part of the screen</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">has actually changed. Potentially degrades the performance, but might fix some artifacts.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">The opposing option is use-damage</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">no-use-damage = false</span>
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">use-damage = true (Causing Weird Black semi opaque rectangles when terminal is opened)</span>
<span style="color: #8D8D84; font-style: italic;">#</span><span style="color: #8D8D84; font-style: italic;">Changing use-damage to false fixes the problem</span>
<span style="color: #BA36A5;">use-damage</span> = false

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Use X Sync fence to sync clients' draw calls, to make sure all draw </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">calls are finished before picom starts drawing. Needed on nvidia-drivers </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">with GLX backend for some users.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">xrender-sync-fence = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">GLX backend: Use specified GLSL fragment shader for rendering window contents. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">See `compton-default-fshader-win.glsl` and `compton-fake-transparency-fshader-win.glsl` </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">in the source tree for examples.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">glx-fshader-win = ''</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Force all windows to be painted with blending. Useful if you </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">have a glx-fshader-win that could turn opaque pixels transparent.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">force-win-blend = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Do not use EWMH to detect fullscreen windows. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Reverts to checking if a window is fullscreen based only on its size and coordinates.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">no-ewmh-fullscreen = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Dimming bright windows so their brightness doesn't exceed this set value. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Brightness of a window is estimated by averaging all pixels in the window, </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">so this could comes with a performance hit. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Setting this to 1.0 disables this behaviour. Requires --use-damage to be disabled. (default: 1.0)</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">max-brightness = 1.0</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Make transparent windows clip other windows like non-transparent windows do,</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">instead of blending on top of them.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">transparent-clipping = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Set the log level. Possible values are:</span>
<span style="color: #8D8D84; font-style: italic;">#  </span><span style="color: #8D8D84; font-style: italic;">"trace", "debug", "info", "warn", "error"</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">in increasing level of importance. Case doesn't matter. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">If using the "TRACE" log level, it's better to log into a file </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">using *--log-file*, since it can generate a huge stream of logs.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">log-level = "debug"</span>
<span style="color: #BA36A5;">log-level</span> = <span style="color: #008000;">"info"</span>;

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Set the log file.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">If *--log-file* is never specified, logs will be written to stderr. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Otherwise, logs will to written to the given file, though some of the early </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">logs might still be written to the stderr. </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">When setting this option from the config file, it is recommended to use an absolute path.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">log-file = '/path/to/your/log/file'</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Show all X errors (for debugging)</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">show-all-xerrors = false</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Write process ID to a file.</span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">write-pid-path = '/path/to/your/log/file'</span>

<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Window type settings</span>
<span style="color: #8D8D84; font-style: italic;"># </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">'WINDOW_TYPE' is one of the 15 window types defined in EWMH standard: </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">"unknown", "desktop", "dock", "toolbar", "menu", "utility", </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">"splash", "dialog", "normal", "dropdown_menu", "popup_menu", </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">"tooltip", "notification", "combo", and "dnd".</span>
<span style="color: #8D8D84; font-style: italic;"># </span>
<span style="color: #8D8D84; font-style: italic;"># </span><span style="color: #8D8D84; font-style: italic;">Following per window-type options are available: ::</span>
<span style="color: #8D8D84; font-style: italic;"># </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">fade, shadow:::</span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">Controls window-type-specific shadow and fade settings.</span>
<span style="color: #8D8D84; font-style: italic;"># </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">opacity:::</span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">Controls default opacity of the window type.</span>
<span style="color: #8D8D84; font-style: italic;"># </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">focus:::</span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">Controls whether the window of this type is to be always considered focused. </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">(By default, all window types except "normal" and "dialog" has this on.)</span>
<span style="color: #8D8D84; font-style: italic;"># </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">full-shadow:::</span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">Controls whether shadow is drawn under the parts of the window that you </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">normally won't be able to see. Useful when the window has parts of it </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">transparent, and you want shadows in those areas.</span>
<span style="color: #8D8D84; font-style: italic;"># </span>
<span style="color: #8D8D84; font-style: italic;">#   </span><span style="color: #8D8D84; font-style: italic;">redir-ignore:::</span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">Controls whether this type of windows should cause screen to become </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">redirected again after been unredirected. If you have unredir-if-possible</span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">set, and doesn't want certain window to cause unnecessary screen redirection, </span>
<span style="color: #8D8D84; font-style: italic;">#     </span><span style="color: #8D8D84; font-style: italic;">you can set this to `true`.</span>
<span style="color: #8D8D84; font-style: italic;">#</span>
wintypes:
{
<span style="color: #BA36A5;">normal</span> = { fade = false; shadow = false; }
<span style="color: #BA36A5;">tooltip</span> = { fade = true; shadow = true; opacity = 0.75; focus = true; full-shadow = false; };
<span style="color: #BA36A5;">dock</span> = { shadow = false; }
<span style="color: #BA36A5;">dnd</span> = { shadow = false; }
<span style="color: #BA36A5;">popup_menu</span> = { opacity = 0.8; }
<span style="color: #BA36A5;">dropdown_menu</span> = { opacity = 0.8; }
};        
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgec04147" class="outline-2">
<h2 id="orgec04147"><span class="section-number-2">9.</span> Rofi</h2>
<div class="outline-text-2" id="text-9">
<p>
Rofi is an application launcher, I use it with i3 and sometimes even with different desktop environments.
</p>
</div>

<div id="outline-container-org22cb089" class="outline-3">
<h3 id="org22cb089"><span class="section-number-3">9.1.</span> .config/rofi/nord.rasi</h3>
<div class="outline-text-3" id="text-9-1">
<p>
This is my chosen rofi theme, fits with the i3 theme!
Original source <a href="https://github.com/lr-tech/rofi-themes-collection">here</a>.
</p>

<div class="org-src-container">
<pre class="src src-fundamental">* {
    font:   "Fira Code 10";

    nord0:     #2e3440;
    nord1:     #3b4252;
    nord2:     #434c5e;
    nord3:     #4c566a;

    nord4:     #d8dee9;
    nord5:     #e5e9f0;
    nord6:     #eceff4;

    nord7:     #8fbcbb;
    nord8:     #88c0d0;
    nord9:     #81a1c1;
    nord10:    #5e81ac;
    nord11:    #bf616a;

    nord12:    #d08770;
    nord13:    #ebcb8b;
    nord14:    #a3be8c;
    nord15:    #b48ead;

    background-color:   transparent;
    text-color:         @nord4;
    accent-color:       @nord8;

    margin:     0px;
    padding:    0px;
    spacing:    0px;
}

window {
    location:           north;
    width:              100%;
    background-color:   @nord0;
    children:           [ mainbox,message ];
}

mainbox {
    orientation:    horizontal;
    children:       [ inputbar,listview ];
}

inputbar {
    width:      25%;
    padding:    1px 8px;
    spacing:    8px;
    children:   [ prompt, entry ];
}

prompt, entry, element-text, element-icon {
    vertical-align: 0.5;
}

prompt {
    text-color: @accent-color;
}

listview {
    layout: horizontal;
}

element {
    padding:    1px 8px;
    spacing:    4px;
}

element normal urgent {
    text-color: @nord13;
}

element normal active {
    text-color: @accent-color;
}

element selected {
    text-color: @nord0;
}

element selected normal {
    background-color:   @accent-color;
}

element selected urgent {
    background-color:   @nord13;
}

element selected active {
    background-color:   @nord8;
}

element-icon {
    size:   0.75em;
}

element-text {
    text-color: inherit;
} 
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgeec3fdb" class="outline-2">
<h2 id="orgeec3fdb"><span class="section-number-2">10.</span> Startx</h2>
<div class="outline-text-2" id="text-10">
<p>
This bit is for a custom <code>startx</code> command, made to work with Guix.
</p>
</div>

<div id="outline-container-org66d37d9" class="outline-3">
<h3 id="org66d37d9"><span class="section-number-3">10.1.</span> .startx</h3>
<div class="outline-text-3" id="text-10-1">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8D8D84; font-style: italic;">#!/bin/sh</span>

<span style="color: #BA36A5; font-style: italic;">DIR</span>=<span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span>/.guix-profile

<span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">DIR</span>/bin/xinit <span style="color: #D0372D;">--</span> <span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">DIR</span>/bin/Xorg :0 vt1 <span style="color: #D0372D;">-keeptty</span> \
               <span style="color: #D0372D;">-configdir</span> <span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">DIR</span>/share/X11/xorg.conf.d \
               <span style="color: #D0372D;">-modulepath</span> <span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">DIR</span>/lib/xorg/modules
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc5e9109" class="outline-2">
<h2 id="orgc5e9109"><span class="section-number-2">11.</span> Xresources</h2>
<div class="outline-text-2" id="text-11">
<p>
Here I apply some basic Xorg configuration.
</p>
</div>

<div id="outline-container-org756eedf" class="outline-3">
<h3 id="org756eedf"><span class="section-number-3">11.1.</span> .Xresources</h3>
<div class="outline-text-3" id="text-11-1">
<p>
Just set the DPI and configure basic font rendering.
</p>
<div class="org-src-container">
<pre class="src src-conf-xdefaults"><span style="color: #BA36A5;">Xft.antialias</span>: true
<span style="color: #BA36A5;">Xft.autohint</span>: false
<span style="color: #BA36A5;">Xft.dpi</span>: 96
<span style="color: #BA36A5;">Xft.hinting</span>: true
<span style="color: #BA36A5;">Xft.hintstyle</span>: hintslight
<span style="color: #BA36A5;">Xft.lcdfilter</span>: lcddefault
<span style="color: #BA36A5;">Xft.rgba</span>: rgb
<span style="color: #BA36A5;">Emacs.Background</span>: black
</pre>
</div>
</div>
</div>

<div id="outline-container-org2793667" class="outline-3">
<h3 id="org2793667"><span class="section-number-3">11.2.</span> .xsessionrc</h3>
<div class="outline-text-3" id="text-11-2">
<p>
This here is necessary for Debian; makes Guix programs accessible from a desktop session.
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #0000FF;">export</span> <span style="color: #ff0000; font-weight: bold; font-style: italic;">PATH</span>=<span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #ff0000; font-weight: bold; font-style: italic;">PATH</span><span style="color: #008000;">:</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.guix-profile/bin"</span>
<span style="color: #0000FF;">export</span> <span style="color: #BA36A5; font-style: italic;">XDG_DATA_DIRS</span>=<span style="color: #008000;">"</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">XDG_DATA_DIRS</span><span style="color: #008000;">:</span><span style="color: #0000FF;">$</span><span style="color: #D0372D; font-style: italic;">HOME</span><span style="color: #008000;">/.guix-profile/share"</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd133faf" class="outline-2">
<h2 id="orgd133faf"><span class="section-number-2">12.</span> Guix system</h2>
<div class="outline-text-2" id="text-12">
<p>
Here is my Guix system configuration, currently unused as I'm on Debian, yet always ready to deploy!
</p>
</div>

<div id="outline-container-orgcfaaebe" class="outline-3">
<h3 id="orgcfaaebe"><span class="section-number-3">12.1.</span> /etc/config.scm</h3>
<div class="outline-text-3" id="text-12-1">
<p>
Let's start by adding my custom modules. This isn't exactly clean but it is functional.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>add-to-load-path <span style="color: #008000;">"/etc/guix-modules"</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Now let's import the actual modules
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #7388D6;">(</span>gnu<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu services<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu services dbus<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu packages gnome<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>nongnu packages linux<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>nongnu system linux-initrd<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu services virtualization<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu services shepherd<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu services admin<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>guix channels<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu services mcron<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu services docker<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>nil services mount-rshared<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu packages fonts<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>gnu packages networking<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>guix gexp<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>guix packages<span style="color: #7388D6;">)</span>
             <span style="color: #7388D6;">(</span>srfi srfi-1<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>use-service-modules linux desktop networking ssh xorg<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>use-package-modules linux package-management<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Now let's redefine some services. Enable nonguix substitutes and blueman for a bluetooth applet.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">%my-services</span>
  <span style="color: #7388D6;">(</span>modify-services %desktop-services
                   <span style="color: #909183;">(</span>guix-service-type config =&gt; <span style="color: #709870;">(</span>guix-configuration
                                                 <span style="color: #907373;">(</span>inherit config<span style="color: #907373;">)</span>
                                                 <span style="color: #907373;">(</span>substitute-urls
                                                  <span style="color: #6276BA;">(</span>append <span style="color: #858580;">(</span>list <span style="color: #008000;">"https://substitutes.nonguix.org"</span><span style="color: #858580;">)</span>
                                                          %default-substitute-urls<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                                                 <span style="color: #907373;">(</span>authorized-keys
                                                  <span style="color: #6276BA;">(</span>append <span style="color: #858580;">(</span>list <span style="color: #80A880;">(</span>local-file <span style="color: #008000;">"./signing-key.pub"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                                                          %default-authorized-guix-keys<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                   <span style="color: #909183;">(</span>dbus-root-service-type config =&gt;
                                           <span style="color: #709870;">(</span>dbus-configuration <span style="color: #907373;">(</span>inherit config<span style="color: #907373;">)</span>
                                                               <span style="color: #907373;">(</span>services <span style="color: #6276BA;">(</span>list libratbag blueman<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Let's handle basic OS defaults first of all.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>operating-system

 <span style="color: #7388D6;">(</span>locale <span style="color: #008000;">"cs_CZ.utf8"</span><span style="color: #7388D6;">)</span>
 <span style="color: #7388D6;">(</span>timezone <span style="color: #008000;">"Europe/Prague"</span><span style="color: #7388D6;">)</span>
 <span style="color: #7388D6;">(</span>keyboard-layout <span style="color: #909183;">(</span>keyboard-layout <span style="color: #008000;">"cz"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>

 <span style="color: #7388D6;">(</span>host-name <span style="color: #008000;">"eternity"</span><span style="color: #7388D6;">)</span>
</pre>
</div>

<p>
Now add the necessary firmware from nonguix.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>initrd microcode-initrd<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>firmware <span style="color: #7388D6;">(</span>list linux-firmware<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
User and group setup is next in line:
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>groups 
 <span style="color: #7388D6;">(</span>cons* 
  <span style="color: #909183;">(</span>user-group <span style="color: #709870;">(</span>name <span style="color: #008000;">"games"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">For libratbagd</span>
  <span style="color: #909183;">(</span>user-group <span style="color: #709870;">(</span>name <span style="color: #008000;">"realtime"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
  %base-groups<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>users <span style="color: #7388D6;">(</span>cons* <span style="color: #909183;">(</span>user-account
               <span style="color: #709870;">(</span>name <span style="color: #008000;">"nil"</span><span style="color: #709870;">)</span>
               <span style="color: #709870;">(</span>comment <span style="color: #008000;">"(lambda () nil)"</span><span style="color: #709870;">)</span>
               <span style="color: #709870;">(</span>group <span style="color: #008000;">"users"</span><span style="color: #709870;">)</span>
               <span style="color: #709870;">(</span>home-directory <span style="color: #008000;">"/home/nil"</span><span style="color: #709870;">)</span>
               <span style="color: #709870;">(</span>supplementary-groups
                '<span style="color: #907373;">(</span><span style="color: #008000;">"wheel"</span> <span style="color: #008000;">"netdev"</span> <span style="color: #008000;">"audio"</span> <span style="color: #008000;">"video"</span> <span style="color: #008000;">"lp"</span> <span style="color: #008000;">"libvirt"</span> <span style="color: #008000;">"kvm"</span> <span style="color: #008000;">"games"</span> <span style="color: #008000;">"docker"</span> <span style="color: #008000;">"realtime"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
              %base-user-accounts<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Let's add out system-level packages now; these are <b>only</b> the most necessary of packages.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>packages
 <span style="color: #7388D6;">(</span>append
  <span style="color: #909183;">(</span><span style="color: #0000FF;">map</span> specification-&gt;package
       <span style="color: #709870;">(</span>list
        <span style="color: #008000;">"nss-certs"</span>
        <span style="color: #008000;">"xf86-video-amdgpu"</span>
        <span style="color: #008000;">"amdgpu-firmware"</span>
        <span style="color: #008000;">"bluez"</span>
        <span style="color: #008000;">"blueman"</span>
        <span style="color: #008000;">"vim"</span>
        <span style="color: #008000;">"libratbag"</span>
        <span style="color: #008000;">"git"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
  %base-packages<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Now for the second part of service configuration - appending my own services.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>services
 <span style="color: #7388D6;">(</span>append
  <span style="color: #909183;">(</span>list <span style="color: #709870;">(</span>service xfce-desktop-service-type<span style="color: #709870;">)</span>

        <span style="color: #709870;">(</span>service bluetooth-service-type
                 <span style="color: #907373;">(</span>bluetooth-configuration
                  <span style="color: #6276BA;">(</span>auto-enable? #f<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
</pre>
</div>

<p>
This one is a custom service, essentially distrobox needs the root (/) to be mounted as rshared and this is currently the way to achieve this.
</p>
<div class="org-src-container">
<pre class="src src-scheme">mount-rshared-service 
</pre>
</div>

<p>
PAM limits for Wine Esync and realtime acces for <code>jackd</code>
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>pam-limits-service
 <span style="color: #7388D6;">(</span>list <span style="color: #909183;">(</span>pam-limits-entry <span style="color: #008000;">"*"</span> 'hard 'nofile 524288<span style="color: #909183;">)</span>
       <span style="color: #909183;">(</span>pam-limits-entry <span style="color: #008000;">"@realtime"</span> 'both 'rtprio 99<span style="color: #909183;">)</span>
       <span style="color: #909183;">(</span>pam-limits-entry <span style="color: #008000;">"@realtime"</span> 'both 'memlock 'unlimited<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
This is a bit of a work-around&#x2026; Basically we place the linker where regular binaries expect it to be. This allows us to execute standard binaries more easily.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>extra-special-file <span style="color: #008000;">"/lib64/ld-linux-x86-64.so.2"</span>
                    <span style="color: #7388D6;">(</span>file-append glibc <span style="color: #008000;">"/lib/ld-linux-x86-64.so.2"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
And the final few services.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>set-xorg-configuration
 <span style="color: #7388D6;">(</span>xorg-configuration
  <span style="color: #909183;">(</span>keyboard-layout keyboard-layout<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>service virtlog-service-type
         <span style="color: #7388D6;">(</span>virtlog-configuration
          <span style="color: #909183;">(</span>max-clients 1000<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>service libvirt-service-type
         <span style="color: #7388D6;">(</span>libvirt-configuration
          <span style="color: #909183;">(</span>unix-sock-group <span style="color: #008000;">"libvirt"</span><span style="color: #909183;">)</span>
          <span style="color: #909183;">(</span>tls-port <span style="color: #008000;">"16555"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>service docker-service-type<span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>service zram-device-service-type
         <span style="color: #7388D6;">(</span>zram-device-configuration
          <span style="color: #909183;">(</span>size <span style="color: #008000;">"8172M"</span><span style="color: #909183;">)</span>
          <span style="color: #909183;">(</span>compression-algorithm 'zstd<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #000000; background-color: #FFA5A5; font-weight: bold; text-decoration: underline;">)</span>
%my-services<span style="color: #000000; background-color: #FFA5A5; font-weight: bold; text-decoration: underline;">))</span>
</pre>
</div>

<p>
At last we can configure hardware-level stuff - bootloader and drives. Finally we can close the <code>operating-system</code> section.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>bootloader
 <span style="color: #7388D6;">(</span>bootloader-configuration
  <span style="color: #909183;">(</span>bootloader grub-efi-bootloader<span style="color: #909183;">)</span>
  <span style="color: #909183;">(</span>targets '<span style="color: #709870;">(</span><span style="color: #008000;">"/boot/efi"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
  <span style="color: #909183;">(</span>timeout 3<span style="color: #909183;">)</span>
  <span style="color: #909183;">(</span>keyboard-layout keyboard-layout<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>file-systems
 <span style="color: #7388D6;">(</span>cons*   
  <span style="color: #909183;">(</span>file-system
   <span style="color: #709870;">(</span>mount-point <span style="color: #008000;">"/"</span><span style="color: #709870;">)</span>
   <span style="color: #709870;">(</span>device
    <span style="color: #907373;">(</span>uuid <span style="color: #008000;">"fd02d6c6-5ff1-48d9-b9cb-a444ceb260dd"</span>
          'ext4<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
   <span style="color: #709870;">(</span>type <span style="color: #008000;">"ext4"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
  <span style="color: #909183;">(</span>file-system
   <span style="color: #709870;">(</span>mount-point <span style="color: #008000;">"/boot/efi"</span><span style="color: #709870;">)</span>
   <span style="color: #709870;">(</span>device
    <span style="color: #907373;">(</span>uuid <span style="color: #008000;">"D846-4633"</span>
          'fat32<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
   <span style="color: #709870;">(</span>type <span style="color: #008000;">"vfat"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
  <span style="color: #909183;">(</span>file-system <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Second hard drive</span>
   <span style="color: #709870;">(</span>mount-point <span style="color: #008000;">"/mnt/media/nil/external"</span><span style="color: #709870;">)</span>
   <span style="color: #709870;">(</span>device
    <span style="color: #907373;">(</span>uuid <span style="color: #008000;">"6e008012-794a-40ad-99e9-69825235e4c5"</span>
          'ext4<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
   <span style="color: #709870;">(</span>type <span style="color: #008000;">"ext4"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
  %base-file-systems<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #000000; background-color: #FFA5A5; font-weight: bold; text-decoration: underline;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4e81d2f" class="outline-3">
<h3 id="org4e81d2f"><span class="section-number-3">12.2.</span> /etc/signing-key.pub</h3>
<div class="outline-text-3" id="text-12-2">
<p>
This is the key for nonguix.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span>public-key 
 <span style="color: #7388D6;">(</span>ecc 
  <span style="color: #909183;">(</span>curve Ed25519<span style="color: #909183;">)</span>
  <span style="color: #909183;">(</span>q #C1FD53E5D4CE971933EC50C9F307AE2171A2D3B52C804642A7A35F84F3A4EA98#<span style="color: #909183;">)</span>
  <span style="color: #7388D6;">)</span>
 <span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7b560eb" class="outline-2">
<h2 id="org7b560eb"><span class="section-number-2">13.</span> Custom Guix Modules</h2>
<div class="outline-text-2" id="text-13">
<p>
I use some of my own custom Guix modules. These provide anything from services to (mainly) packages.
</p>
</div>

<div id="outline-container-org8c6a0d8" class="outline-3">
<h3 id="org8c6a0d8"><span class="section-number-3">13.1.</span> /etc/guix-modules/nil/packages</h3>
<div class="outline-text-3" id="text-13-1">
<p>
Let's start with the packages first.
</p>
</div>

<div id="outline-container-org7ab00f0" class="outline-4">
<h4 id="org7ab00f0"><span class="section-number-4">13.1.1.</span> brogue.scm</h4>
<div class="outline-text-4" id="text-13-1-1">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span><span style="color: #0000FF;">define-module</span> <span style="color: #7388D6;">(</span><span style="color: #6434A3;">nil packages brogue</span><span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix download<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix build-system gnu<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix licenses<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix gexp<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages sdl<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-public</span> <span style="color: #006699;">brogue-ce</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>name <span style="color: #008000;">"brogue-ce"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>version <span style="color: #008000;">"1.12"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>source <span style="color: #709870;">(</span>origin
            <span style="color: #907373;">(</span>method url-fetch<span style="color: #907373;">)</span>
            <span style="color: #907373;">(</span>uri <span style="color: #6276BA;">(</span>string-append <span style="color: #008000;">"https://github.com/tmewett/BrogueCE/archive/refs/tags/v"</span> version
                                <span style="color: #008000;">".tar.gz"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
            <span style="color: #907373;">(</span>sha256
             <span style="color: #6276BA;">(</span>base32
              <span style="color: #008000;">"0a6l7j91iq0mv7zrxnlxx6ll5rfwvgfyk5h1gc9m5qzll1n3zvdf"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>build-system gnu-build-system<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>arguments
    <span style="color: #709870;">(</span>list 
     <span style="color: #006FE0;">#:make-flags</span> #~<span style="color: #907373;">(</span>list <span style="color: #008000;">"CC=gcc"</span><span style="color: #907373;">)</span>
     <span style="color: #006FE0;">#:tests?</span> #f
     <span style="color: #006FE0;">#:phases</span>
     #~<span style="color: #907373;">(</span>modify-phases %standard-phases
                      <span style="color: #6276BA;">(</span>delete 'configure<span style="color: #6276BA;">)</span>
                      <span style="color: #6276BA;">(</span>add-before 'build 'change-datadir-path
                                  <span style="color: #858580;">(</span><span style="color: #0000FF;">lambda</span> _
                                    <span style="color: #80A880;">(</span><span style="color: #0000FF;">map</span>
                                     <span style="color: #887070;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #707183;">(</span>substitutes<span style="color: #707183;">)</span>
                                       <span style="color: #707183;">(</span>substitute* <span style="color: #008000;">"config.mk"</span>
                                                    <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #709870;">(</span>car substitutes<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                                                     <span style="color: #909183;">(</span>cdr substitutes<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                     `<span style="color: #887070;">(</span><span style="color: #707183;">(</span><span style="color: #008000;">"^DATADIR := ."</span> . ,<span style="color: #7388D6;">(</span>string-append <span style="color: #008000;">"DATADIR := "</span> #$output <span style="color: #008000;">"/share"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                                       <span style="color: #707183;">(</span><span style="color: #008000;">"^RELEASE := NO"</span> . <span style="color: #008000;">"RELEASE := YES"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                      <span style="color: #6276BA;">(</span>replace 'install
                               <span style="color: #858580;">(</span><span style="color: #0000FF;">lambda</span> _
                                 <span style="color: #80A880;">(</span>mkdir-p <span style="color: #887070;">(</span>string-append #$output <span style="color: #008000;">"/bin"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                 <span style="color: #80A880;">(</span>copy-file <span style="color: #008000;">"bin/brogue"</span> <span style="color: #887070;">(</span>string-append #$output <span style="color: #008000;">"/bin/.brogue_real"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                 <span style="color: #80A880;">(</span><span style="color: #0000FF;">call-with-output-file</span> <span style="color: #887070;">(</span>string-append #$output <span style="color: #008000;">"/bin/brogue"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Wrap around executable and execute in ~/.local</span>
                                   <span style="color: #887070;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #707183;">(</span>file<span style="color: #707183;">)</span>
                                     <span style="color: #707183;">(</span>format file <span style="color: #008000;">"~A"</span> <span style="color: #7388D6;">(</span>string-append
                                                        <span style="color: #008000;">"mkdir -p \"$HOME/.local/share/brogue\" &amp;&amp; cd \"$HOME/.local/share/brogue\" &amp;&amp; "</span>
                                                        #$output <span style="color: #008000;">"/bin/.brogue_real"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                 <span style="color: #80A880;">(</span>invoke <span style="color: #008000;">"chmod"</span> <span style="color: #008000;">"+x"</span> <span style="color: #887070;">(</span>string-append #$output <span style="color: #008000;">"/bin/brogue"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                 <span style="color: #80A880;">(</span>copy-recursively <span style="color: #008000;">"bin/assets"</span> <span style="color: #887070;">(</span>string-append #$output <span style="color: #008000;">"/share/assets"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                                 <span style="color: #80A880;">(</span>make-desktop-entry-file
                                  <span style="color: #887070;">(</span>string-append  #$output <span style="color: #008000;">"/share/applications/brogue.desktop"</span><span style="color: #887070;">)</span>
                                  <span style="color: #006FE0;">#:name</span> <span style="color: #008000;">"Brogue"</span>
                                  <span style="color: #006FE0;">#:exec</span> <span style="color: #008000;">"brogue"</span>
                                  <span style="color: #006FE0;">#:categories</span> '<span style="color: #887070;">(</span><span style="color: #008000;">"RolePlaying"</span> <span style="color: #008000;">"Game"</span><span style="color: #887070;">)</span>
                                  <span style="color: #006FE0;">#:keywords</span>
                                  '<span style="color: #887070;">(</span><span style="color: #008000;">"adventure"</span> <span style="color: #008000;">"singleplayer"</span><span style="color: #887070;">)</span>
                                  <span style="color: #006FE0;">#:comment</span>
                                  '<span style="color: #887070;">(</span><span style="color: #707183;">(</span>#f <span style="color: #008000;">"Brave the Dungeons of Doom!"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>inputs <span style="color: #709870;">(</span>list <span style="color: #907373;">(</span>sdl-union <span style="color: #6276BA;">(</span>list sdl2 sdl2-image<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>synopsis <span style="color: #008000;">"Brogue CE: A dungeon crawler roguelike"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>description <span style="color: #008000;">"Community fork of Brogue"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>home-page <span style="color: #008000;">"https://github.com/tmewett/BrogueCE"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>license agpl3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6d6017d" class="outline-4">
<h4 id="org6d6017d"><span class="section-number-4">13.1.2.</span> distrobox-docker.scm</h4>
<div class="outline-text-4" id="text-13-1-2">
<p>
Since podman isn't currently fully functional on Guix we have to use docker instead. Unfortunately the Distrobox definition in Guix's repos relies on podman - thus making it practically broken. To solve this issue I modify the package to use docker instead.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span><span style="color: #0000FF;">define-module</span> <span style="color: #7388D6;">(</span><span style="color: #6434A3;">nil packages distrobox-docker</span><span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix gexp<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages docker<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix utils<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix build utils<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages containers<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-public</span> <span style="color: #006699;">distrobox-docker</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>inherit distrobox<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>name <span style="color: #008000;">"distrobox-docker"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>inputs <span style="color: #709870;">(</span>modify-inputs <span style="color: #907373;">(</span>package-inputs distrobox<span style="color: #907373;">)</span>
                          <span style="color: #907373;">(</span>append docker<span style="color: #907373;">)</span>
                          <span style="color: #907373;">(</span>append docker-cli<span style="color: #907373;">)</span>
                          <span style="color: #907373;">(</span>delete <span style="color: #008000;">"podman"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>arguments
    <span style="color: #709870;">(</span>substitute-keyword-arguments <span style="color: #907373;">(</span>package-arguments distrobox<span style="color: #907373;">)</span>
                                  <span style="color: #907373;">(</span><span style="color: #6276BA;">(</span><span style="color: #006FE0;">#:phases</span> phases<span style="color: #6276BA;">)</span>
                                   #~<span style="color: #6276BA;">(</span>modify-phases #$phases
                                                    <span style="color: #858580;">(</span>replace 'refer-to-inputs
                                                             <span style="color: #80A880;">(</span><span style="color: #0000FF;">lambda*</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">#:key</span> inputs <span style="color: #006FE0;">#:allow-other-keys</span><span style="color: #887070;">)</span>
                                                               <span style="color: #887070;">(</span>copy-file <span style="color: #008000;">"distrobox-init"</span> <span style="color: #008000;">"dinit"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Temporarily move distrobox-init so it isn't affected by regex</span>
                                                               <span style="color: #887070;">(</span>substitute* <span style="color: #707183;">(</span>find-files <span style="color: #008000;">"."</span> <span style="color: #008000;">"^distrobox.*[^1]$"</span><span style="color: #707183;">)</span>
                                                                            <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #008000;">"docker"</span><span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>search-input-file inputs <span style="color: #008000;">"/bin/docker"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                                                                            <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #008000;">"wget"</span><span style="color: #7388D6;">)</span> <span style="color: #7388D6;">(</span>search-input-file inputs <span style="color: #008000;">"/bin/wget"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                                                                            <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #008000;">"command -v"</span><span style="color: #7388D6;">)</span> <span style="color: #008000;">"test -x"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                                               <span style="color: #887070;">(</span>copy-file <span style="color: #008000;">"dinit"</span> <span style="color: #008000;">"distrobox-init"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">move distrobox-init back</span>
                                                               <span style="color: #887070;">(</span>delete-file <span style="color: #008000;">"dinit"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge5388b3" class="outline-4">
<h4 id="orge5388b3"><span class="section-number-4">13.1.3.</span> emulators.scm</h4>
<div class="outline-text-4" id="text-13-1-3">
<p>
This is a custom retroarch definition, it adds the core downloader functionality which the Guix version doesn't have for licensing reasons.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span><span style="color: #0000FF;">define-module</span> <span style="color: #7388D6;">(</span><span style="color: #6434A3;">nil packages emulators</span><span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>ice-9 match<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix gexp<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix utils<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages gl<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages linux<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages emulators<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-public</span> <span style="color: #006699;">retroarch-nonfree</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>inherit retroarch<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>name <span style="color: #008000;">"retroarch-nonfree"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>inputs <span style="color: #709870;">(</span>modify-inputs <span style="color: #907373;">(</span>package-inputs retroarch<span style="color: #907373;">)</span>
                          <span style="color: #907373;">(</span>append glu<span style="color: #907373;">)</span>
                          <span style="color: #907373;">(</span>append libaio<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>arguments
    <span style="color: #709870;">(</span>substitute-keyword-arguments <span style="color: #907373;">(</span>package-arguments retroarch<span style="color: #907373;">)</span>
                                  <span style="color: #907373;">(</span><span style="color: #6276BA;">(</span><span style="color: #006FE0;">#:phases</span> phases<span style="color: #6276BA;">)</span>
                                   #~<span style="color: #6276BA;">(</span>modify-phases #$phases
                                                    <span style="color: #858580;">(</span>replace 'configure
                                                             <span style="color: #80A880;">(</span><span style="color: #0000FF;">lambda*</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">#:key</span> inputs outputs <span style="color: #006FE0;">#:allow-other-keys</span><span style="color: #887070;">)</span>
                                                               <span style="color: #887070;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span>out <span style="color: #909183;">(</span>assoc-ref outputs <span style="color: #008000;">"out"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                                                                      <span style="color: #7388D6;">(</span>etc <span style="color: #909183;">(</span>string-append out <span style="color: #008000;">"/etc"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                                                                      <span style="color: #7388D6;">(</span>vulkan <span style="color: #909183;">(</span>assoc-ref inputs <span style="color: #008000;">"vulkan-loader"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
                                                                      <span style="color: #7388D6;">(</span>wayland-protocols <span style="color: #909183;">(</span>assoc-ref inputs
                                                                                                    <span style="color: #008000;">"wayland-protocols"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                                                                 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Hard-code some store file names.</span>
                                                                 <span style="color: #707183;">(</span>substitute* <span style="color: #008000;">"gfx/common/vulkan_common.c"</span>
                                                                              <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #008000;">"libvulkan.so"</span><span style="color: #909183;">)</span>
                                                                               <span style="color: #909183;">(</span>string-append vulkan <span style="color: #008000;">"/lib/libvulkan.so"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                                                                 <span style="color: #707183;">(</span>substitute* <span style="color: #008000;">"gfx/common/wayland/generate_wayland_protos.sh"</span>
                                                                              <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #008000;">"/usr/local/share/wayland-protocols"</span><span style="color: #909183;">)</span>
                                                                               <span style="color: #909183;">(</span>string-append wayland-protocols
                                                                                              <span style="color: #008000;">"/share/wayland-protocols"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

                                                                 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">The configure script does not yet accept the extra arguments</span>
                                                                 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">(like &#8216;CONFIG_SHELL=&#8217;) passed by the default configure phase.</span>
                                                                 <span style="color: #707183;">(</span>invoke <span style="color: #008000;">"./configure"</span>
                                                                         <span style="color: #7388D6;">(</span>string-append <span style="color: #008000;">"--prefix="</span> out<span style="color: #7388D6;">)</span>
                                                                         <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Non-free software are available through the core updater,</span>
                                                                         <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">disable it.  See <a href="https://issues.guix.gnu.org/38360">&lt;https://issues.guix.gnu.org/38360&gt;</a>.</span>
                                                                         <span style="color: #008000;">"--disable-builtinzlib"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                                                    <span style="color: #858580;">(</span>add-after 'install 'append-extra-libs
                                                               <span style="color: #80A880;">(</span><span style="color: #0000FF;">lambda*</span> <span style="color: #887070;">(</span><span style="color: #006FE0;">#:key</span> inputs <span style="color: #006FE0;">#:allow-other-keys</span><span style="color: #887070;">)</span>
                                                                 <span style="color: #887070;">(</span>wrap-program <span style="color: #707183;">(</span>string-append #$output <span style="color: #008000;">"/bin/retroarch"</span><span style="color: #707183;">)</span>
                                                                               `<span style="color: #707183;">(</span><span style="color: #008000;">"LD_LIBRARY_PATH"</span> <span style="color: #008000;">":"</span> prefix
                                                                                 <span style="color: #7388D6;">(</span>,<span style="color: #909183;">(</span>string-append #$<span style="color: #709870;">(</span>this-package-input <span style="color: #008000;">"glu"</span><span style="color: #709870;">)</span>
                                                                                                  <span style="color: #008000;">"/lib"</span> <span style="color: #008000;">":"</span>
                                                                                                  #$<span style="color: #709870;">(</span>this-package-input
                                                                                                     <span style="color: #008000;">"libaio"</span><span style="color: #709870;">)</span> <span style="color: #008000;">"/lib"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgedac612" class="outline-4">
<h4 id="orgedac612"><span class="section-number-4">13.1.4.</span> steam-client.scm</h4>
<div class="outline-text-4" id="text-13-1-4">
<p>
This is nonguix's Steam but with my second drive exposed through the sandbox. A couple of missing dependencies were added too.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">SPDX-License-Identifier: GPL-3.0-or-later</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Copyright &#169; 2020 pkill-9</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Copyright &#169; 2020, 2021 ison <a href="mailto:ison%40airmail.cc">&lt;ison@airmail.cc&gt;</a></span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Copyright &#169; 2021 pineapples</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Copyright &#169; 2021 Jean-Baptiste Volatier <a href="mailto:jbv%40pm.me">&lt;jbv@pm.me&gt;</a></span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Copyright &#169; 2021 Kozo <a href="mailto:kozodev%40runbox.com">&lt;kozodev@runbox.com&gt;</a></span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Copyright &#169; 2021, 2022 John Kehayias <a href="mailto:john.kehayias%40protonmail.com">&lt;john.kehayias@protonmail.com&gt;</a></span>

<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">The steam script provided by this package may optionally be started as</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">a shell instead of automatically launching Steam by setting the</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">environment variable DEBUG=1.  If the sandbox is started this way then</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Steam should subsequently be launched via fhs-internal.</span>

<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">The sandbox shell aids in debugging missing container elements.  For</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">example a missing symlink may be created manually before launching Steam</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">to verify that the fix works before filing a bug report.</span>

<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">A container wrapper creates the following store items:</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">* Main container package [nonguix-container-&gt;package] (basically a dummy</span>
<span style="color: #8D8D84; font-style: italic;">;;;   </span><span style="color: #8D8D84; font-style: italic;">package with symlink to wrapper script)</span>
<span style="color: #8D8D84; font-style: italic;">;;;   </span><span style="color: #8D8D84; font-style: italic;">- Wrapper script [make-container-wrapper] (runs "guix shell")</span>
<span style="color: #8D8D84; font-style: italic;">;;;     </span><span style="color: #8D8D84; font-style: italic;">References:</span>
<span style="color: #8D8D84; font-style: italic;">;;;     </span><span style="color: #8D8D84; font-style: italic;">-&gt; manifest.scm [make-container-manifest] (used by wrapper to guarantee</span>
<span style="color: #8D8D84; font-style: italic;">;;;        </span><span style="color: #8D8D84; font-style: italic;">exact store items)</span>
<span style="color: #8D8D84; font-style: italic;">;;;     </span><span style="color: #8D8D84; font-style: italic;">-&gt; container-internal [make-container-internal] {inside container}</span>
<span style="color: #8D8D84; font-style: italic;">;;;        </span><span style="color: #8D8D84; font-style: italic;">(dummy package added to container with symlink to internal-script)</span>
<span style="color: #8D8D84; font-style: italic;">;;;        </span><span style="color: #8D8D84; font-style: italic;">- internal-script [make-internal-script] {inside container}</span>
<span style="color: #8D8D84; font-style: italic;">;;;          </span><span style="color: #8D8D84; font-style: italic;">(script run in-container which performs additional setup before</span>
<span style="color: #8D8D84; font-style: italic;">;;;          </span><span style="color: #8D8D84; font-style: italic;">launching the desired application)</span>
<span style="color: #8D8D84; font-style: italic;">;;;          </span><span style="color: #8D8D84; font-style: italic;">References:</span>
<span style="color: #8D8D84; font-style: italic;">;;;          </span><span style="color: #8D8D84; font-style: italic;">-&gt; Wrapped package {inside container} (in this case Steam).</span>

<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">Note: The extra container-internal package is necessary because there is no</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">way to add the container package's own store path to its own manifest unless</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">the manifest is printed inside the build phases. However, the (guix gexp)</span>
<span style="color: #8D8D84; font-style: italic;">;;; </span><span style="color: #8D8D84; font-style: italic;">module is apparently disallowed inside build phases.</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-module</span> <span style="color: #7388D6;">(</span><span style="color: #6434A3;">nil packages steam-client</span><span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>guix licenses<span style="color: #909183;">)</span> <span style="color: #006FE0;">#:prefix</span> license:<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>nonguix licenses<span style="color: #909183;">)</span> <span style="color: #006FE0;">#:prefix</span> license:<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix gexp<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix git-download<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix utils<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix records<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix download<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix build-system gnu<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix build-system python<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix build-system trivial<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix transformations<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages audio<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages base<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages bash<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages certs<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages compression<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages elf<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages file<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages fonts<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages fontutils<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages freedesktop<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages gawk<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages gcc<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages gl<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages glib<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages gnome<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages graphics<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages libbsd<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages libusb<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages linux<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages llvm<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages logging<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>nongnu packages nvidia<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages pciutils<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages pulseaudio<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages python<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages python-web<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages python-xyz<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages toolkits<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages video<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages xorg<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>nonguix utils<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>define-record-type* <span style="color: #6434A3;">&lt;nonguix-container&gt;</span>
  nonguix-container make-nonguix-container
  nonguix-container? this-nonguix-container
  <span style="color: #7388D6;">(</span>name          ngc-name<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>binpath       ngc-binpath<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>version       ngc-version <span style="color: #909183;">(</span>default #f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>wrap-package  ngc-wrap-package<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>run           ngc-run<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>wrapper-name  ngc-wrapper-name <span style="color: #909183;">(</span>default <span style="color: #008000;">"nonguix-container-wrapper"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>manifest-name ngc-manifest-name <span style="color: #909183;">(</span>default <span style="color: #008000;">"nonguix-container-manifest.scm"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>internal-name ngc-internal-name <span style="color: #909183;">(</span>default <span style="color: #008000;">"fhs-internal"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>sandbox-home  ngc-sandbox-home <span style="color: #909183;">(</span>default <span style="color: #008000;">".local/share/guix-sandbox-home"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>union64       ngc-union64 <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>union32       ngc-union32 <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>preserved-env ngc-preserved-env <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>exposed       ngc-exposed <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>shared        ngc-shared <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>modules       ngc-modules <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>packages      ngc-packages <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>link-files    ngc-link-files <span style="color: #909183;">(</span>default '<span style="color: #709870;">()</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>home-page     ngc-home-page <span style="color: #909183;">(</span>default #f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>synopsis      ngc-synopsis <span style="color: #909183;">(</span>default #f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>description   ngc-description <span style="color: #909183;">(</span>default #f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>license       ngc-license <span style="color: #909183;">(</span>default #f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steam-client</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>name <span style="color: #008000;">"steam-client"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>version <span style="color: #008000;">"1.0.0.75"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>source
    <span style="color: #709870;">(</span>origin
     <span style="color: #907373;">(</span>method url-fetch<span style="color: #907373;">)</span>
     <span style="color: #907373;">(</span>uri <span style="color: #6276BA;">(</span>string-append <span style="color: #008000;">"http://repo.steampowered.com/steam/archive/precise/steam_"</span>
                         version <span style="color: #008000;">".tar.gz"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
     <span style="color: #907373;">(</span>sha256
      <span style="color: #6276BA;">(</span>base32
       <span style="color: #008000;">"19rn29slsxv7b5fisr1jzn79bskzifbj5hmxqn2436ivwfjna9g5"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
     <span style="color: #907373;">(</span>file-name <span style="color: #6276BA;">(</span>string-append name <span style="color: #008000;">"-"</span> version <span style="color: #008000;">".tar.gz"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>build-system gnu-build-system<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>arguments
    `<span style="color: #709870;">(</span><span style="color: #006FE0;">#:tests?</span> #f <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">There are no tests.</span>
      <span style="color: #006FE0;">#:validate-runpath?</span> #f <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Looks for bin/steam which doesn't exist.</span>
      <span style="color: #006FE0;">#:make-flags</span>
      <span style="color: #907373;">(</span>list <span style="color: #008000;">"PREFIX="</span> <span style="color: #6276BA;">(</span>string-append <span style="color: #008000;">"DESTDIR="</span> <span style="color: #858580;">(</span>assoc-ref %outputs <span style="color: #008000;">"out"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
      <span style="color: #006FE0;">#:phases</span>
      <span style="color: #907373;">(</span>modify-phases %standard-phases
                     <span style="color: #6276BA;">(</span>delete 'configure<span style="color: #6276BA;">)</span>
                     <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Patch Makefile so it creates links to the store rather than /lib.</span>
                     <span style="color: #6276BA;">(</span>add-after 'unpack 'patch-makefile
                                <span style="color: #858580;">(</span><span style="color: #0000FF;">lambda</span> _
                                  <span style="color: #80A880;">(</span>substitute* <span style="color: #008000;">"Makefile"</span>
                                               <span style="color: #887070;">(</span><span style="color: #707183;">(</span><span style="color: #008000;">"-fns "</span><span style="color: #707183;">)</span>
                                                <span style="color: #008000;">"-fns $(DESTDIR)"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                     <span style="color: #6276BA;">(</span>delete 'patch-dot-desktop-files<span style="color: #6276BA;">)</span>
                     <span style="color: #6276BA;">(</span>add-after 'unpack 'patch-startscript
                                <span style="color: #858580;">(</span><span style="color: #0000FF;">lambda</span> _
                                  <span style="color: #80A880;">(</span>substitute* <span style="color: #008000;">"bin_steam.sh"</span>
                                               <span style="color: #887070;">(</span><span style="color: #707183;">(</span><span style="color: #008000;">"/usr"</span><span style="color: #707183;">)</span> <span style="color: #707183;">(</span>assoc-ref %outputs <span style="color: #008000;">"out"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                     <span style="color: #6276BA;">(</span>add-after 'patch-dot-desktop-files 'patch-desktop-file
                                <span style="color: #858580;">(</span><span style="color: #0000FF;">lambda</span> _
                                  <span style="color: #80A880;">(</span><span style="color: #0000FF;">let</span> <span style="color: #887070;">(</span><span style="color: #707183;">(</span>path <span style="color: #7388D6;">(</span>string-append <span style="color: #909183;">(</span>assoc-ref %outputs <span style="color: #008000;">"out"</span><span style="color: #909183;">)</span>
                                                             <span style="color: #008000;">"/share/applications/"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                    <span style="color: #887070;">(</span>substitute* <span style="color: #707183;">(</span>string-append path <span style="color: #008000;">"steam.desktop"</span><span style="color: #707183;">)</span>
                                                 <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #008000;">"Exec=.*/steam"</span><span style="color: #7388D6;">)</span> <span style="color: #008000;">"Exec=steam"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                    <span style="color: #887070;">(</span>copy-file <span style="color: #707183;">(</span>string-append path <span style="color: #008000;">"steam.desktop"</span><span style="color: #707183;">)</span>
                                               <span style="color: #707183;">(</span>string-append path <span style="color: #008000;">"steam-asound32.desktop"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                    <span style="color: #887070;">(</span>substitute* <span style="color: #707183;">(</span>string-append path <span style="color: #008000;">"steam-asound32.desktop"</span><span style="color: #707183;">)</span>
                                                 <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #008000;">"Exec=steam %U"</span><span style="color: #7388D6;">)</span> <span style="color: #008000;">"Exec=steam %U -- --asound32"</span><span style="color: #707183;">)</span>
                                                 <span style="color: #707183;">(</span><span style="color: #7388D6;">(</span><span style="color: #008000;">"Name=Steam"</span><span style="color: #7388D6;">)</span> <span style="color: #008000;">"Name=Steam (32-bit ALSA)"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
                     <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Steamdeps installs missing packages, which doesn't work with Guix.</span>
                     <span style="color: #6276BA;">(</span>add-after 'install-binaries 'post-install
                                <span style="color: #858580;">(</span><span style="color: #0000FF;">lambda*</span> <span style="color: #80A880;">(</span><span style="color: #006FE0;">#:key</span> inputs outputs <span style="color: #006FE0;">#:allow-other-keys</span><span style="color: #80A880;">)</span>
                                  <span style="color: #80A880;">(</span><span style="color: #0000FF;">let</span> <span style="color: #887070;">(</span><span style="color: #707183;">(</span>out <span style="color: #7388D6;">(</span>assoc-ref %outputs <span style="color: #008000;">"out"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                    <span style="color: #887070;">(</span>delete-file <span style="color: #707183;">(</span>string-append out <span style="color: #008000;">"/lib/steam/bin_steamdeps.py"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                                    <span style="color: #887070;">(</span>delete-file <span style="color: #707183;">(</span>string-append out <span style="color: #008000;">"/bin/steamdeps"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>home-page <span style="color: #008000;">"https://store.steampowered.com"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>synopsis <span style="color: #008000;">"Digital distribution platform for managing and playing games"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>description <span style="color: #008000;">"Steam is a digital software distribution platform created by Valve."</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>license <span style="color: #709870;">(</span>license:nonfree <span style="color: #008000;">"file:///share/doc/steam/steam_subscriber_agreement.txt"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">glibc-for-fhs</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>inherit glibc<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>name <span style="color: #008000;">"glibc-for-fhs"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>source <span style="color: #709870;">(</span>origin <span style="color: #907373;">(</span>inherit <span style="color: #6276BA;">(</span>package-source glibc<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                   <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Remove Guix's patch to read ld.so.cache from /gnu/store</span>
                   <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">directories, re-enabling the default /etc/ld.so.cache</span>
                   <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">behavior.</span>
                   <span style="color: #907373;">(</span>patches <span style="color: #6276BA;">(</span>delete <span style="color: #858580;">(</span>car <span style="color: #80A880;">(</span>search-patches <span style="color: #008000;">"glibc-dl-cache.patch"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                                    <span style="color: #858580;">(</span>origin-patches <span style="color: #80A880;">(</span>package-source glibc<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">After guix commit to add a replacement for expat (security fixes),</span>
<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">https://git.savannah.gnu.org/cgit/guix.git/commit/?id=2045852b096131a714409aa0cc4fe17938f60b15</span>
<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">a profile collision happens with the propagated expat (now grafted) from</span>
<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">fontconfig.  See upstream report https://issues.guix.gnu.org/53406</span>
<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">So we define a fontconfig variation that explicitly does the expat replacement</span>
<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">which works around this bug for now, at the cost of building fontconfig.</span>
<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">TODO: remove once upstream bug is fixed</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">fontconfig-fixed</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>inherit fontconfig<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>propagated-inputs
    <span style="color: #709870;">(</span>modify-inputs <span style="color: #907373;">(</span>package-propagated-inputs fontconfig<span style="color: #907373;">)</span>
                   <span style="color: #907373;">(</span>replace <span style="color: #008000;">"expat"</span> <span style="color: #6276BA;">(</span>@@ <span style="color: #858580;">(</span>gnu packages xml<span style="color: #858580;">)</span> expat/fixed<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">fhs-min-libs</span>
  `<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #008000;">"glibc"</span> ,glibc-for-fhs<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"glibc-locales"</span> ,glibc-locales<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steam-client-libs</span>
  `<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #008000;">"bash"</span> ,bash<span style="color: #909183;">)</span>                      <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam startup.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"coreutils"</span> ,coreutils<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"diffutils"</span> ,diffutils<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"dbus-glib"</span> ,dbus-glib<span style="color: #909183;">)</span>            <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam browser.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"elfutils"</span> ,elfutils<span style="color: #909183;">)</span>              <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for capturing library dependencies in pv.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"eudev"</span> ,eudev<span style="color: #909183;">)</span>                    <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steamwebhelper/heavy runtime.</span>
    <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">TODO: set back to ,fontconfig once https://issues.guix.gnu.org/53406 is fixed</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"fontconfig"</span> ,fontconfig-fixed<span style="color: #909183;">)</span>    <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam client.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"file"</span> ,file<span style="color: #909183;">)</span>                      <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Used for steam installation.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"find"</span> ,findutils<span style="color: #909183;">)</span>                 <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required at least for some logging.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"freetype"</span> ,freetype<span style="color: #909183;">)</span>              <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam login.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"gawk"</span> ,gawk<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"gcc:lib"</span> ,gcc <span style="color: #008000;">"lib"</span><span style="color: #909183;">)</span>              <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam startup.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"grep"</span> ,grep<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"libbsd"</span> ,libbsd<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"libcap"</span> ,libcap<span style="color: #909183;">)</span>                  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for SteamVR, but needs pkexec too.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"libusb"</span> ,libusb<span style="color: #909183;">)</span>                  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for SteamVR.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"libva"</span> ,libva<span style="color: #909183;">)</span>                    <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for hardware video encoding/decoding.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"libvdpau"</span> ,libvdpau<span style="color: #909183;">)</span>              <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for hardware video encoding/decoding.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"libvdpau-va-gl"</span> ,libvdpau-va-gl<span style="color: #909183;">)</span>  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Additional VDPAU support.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"llvm"</span> ,llvm-11<span style="color: #909183;">)</span>                   <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for mesa.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"mesa"</span> ,mesa<span style="color: #909183;">)</span>                      <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam startup.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"nss-certs"</span> ,nss-certs<span style="color: #909183;">)</span>            <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam login.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"pciutils"</span> ,pciutils<span style="color: #909183;">)</span>              <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Tries to run lspci at steam startup.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"procps"</span> ,procps<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"sed"</span> ,sed<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"tar"</span> ,tar<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"usbutils"</span> ,usbutils<span style="color: #909183;">)</span>              <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for SteamVR.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"util-linux"</span> ,util-linux<span style="color: #909183;">)</span>          <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for steam login.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"wayland"</span> ,wayland<span style="color: #909183;">)</span>                <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for mesa vulkan (e.g. libvulkan_radeon).</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"flatpak-xdg-utils"</span> ,flatpak-xdg-utils<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"xz"</span> ,xz<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"zenity"</span> ,zenity<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>                <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for progress dialogs.</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steam-gameruntime-libs</span>
  `<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #008000;">"alsa-lib"</span> ,alsa-lib<span style="color: #909183;">)</span>              <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for audio in most games.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"xrandr"</span> ,xrandr<span style="color: #909183;">)</span>                  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for resolution setting in csgo</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"alsa-plugins:pulseaudio"</span> ,alsa-plugins <span style="color: #008000;">"pulseaudio"</span><span style="color: #909183;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for audio in most games.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"font-dejavu"</span> ,font-dejavu<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"font-liberation"</span> ,font-liberation<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"imgui"</span> ,imgui-1.86<span style="color: #909183;">)</span>               <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for MangoHud.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"mangohud"</span> ,mangohud<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"openal"</span> ,openal<span style="color: #909183;">)</span>                  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Prevents corrupt audio in Crypt of the Necrodancer.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"pulseaudio"</span> ,pulseaudio<span style="color: #909183;">)</span>          <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Prevents corrupt audio in Sven Coop.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"python"</span> ,python<span style="color: #909183;">)</span>                  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for KillingFloor2 and Wreckfest.</span>
    <span style="color: #909183;">(</span><span style="color: #008000;">"spdlog"</span> ,spdlog<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>                <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Required for MangoHud.</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define*</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">fhs-union</span> inputs <span style="color: #006FE0;">#:key</span> <span style="color: #909183;">(</span>name <span style="color: #008000;">"fhs-union"</span><span style="color: #909183;">)</span> <span style="color: #909183;">(</span>version <span style="color: #008000;">"0.0"</span><span style="color: #909183;">)</span> <span style="color: #909183;">(</span>system <span style="color: #008000;">"x86_64-linux"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Create a package housing the union of inputs."</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>name name<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>version version<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>source #f<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>inputs inputs<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>build-system trivial-build-system<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>arguments
    `<span style="color: #709870;">(</span><span style="color: #006FE0;">#:system</span> ,system
      <span style="color: #006FE0;">#:modules</span> <span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>guix build union<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
      <span style="color: #006FE0;">#:builder</span>
      <span style="color: #907373;">(</span><span style="color: #0000FF;">begin</span>
        <span style="color: #6276BA;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #858580;">(</span>ice-9 match<span style="color: #858580;">)</span>
                     <span style="color: #858580;">(</span>guix build union<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
        <span style="color: #6276BA;">(</span><span style="color: #0000FF;">match</span> %build-inputs
          <span style="color: #858580;">(</span><span style="color: #80A880;">(</span><span style="color: #887070;">(</span>_ . directories<span style="color: #887070;">)</span> ...<span style="color: #80A880;">)</span>
           <span style="color: #80A880;">(</span>union-build <span style="color: #887070;">(</span>assoc-ref %outputs <span style="color: #008000;">"out"</span><span style="color: #887070;">)</span>
                        directories<span style="color: #80A880;">)</span>
           #t<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>home-page #f<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>synopsis <span style="color: #008000;">"Libraries used for FHS"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>description <span style="color: #008000;">"Libraries needed to build a guix container FHS."</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>license #f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">ld.so.conf-&gt;ld.so.cache</span> ld-conf<span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Create a ld.so.cache file-like object from an ld.so.conf file."</span>
  <span style="color: #7388D6;">(</span>computed-file
   <span style="color: #008000;">"ld.so.cache"</span>
   <span style="color: #909183;">(</span>with-imported-modules
    `<span style="color: #709870;">(</span><span style="color: #907373;">(</span>guix build utils<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    #~<span style="color: #709870;">(</span><span style="color: #0000FF;">begin</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #6276BA;">(</span>guix build utils<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">let</span> <span style="color: #6276BA;">(</span><span style="color: #858580;">(</span>ldconfig <span style="color: #80A880;">(</span>string-append #$glibc <span style="color: #008000;">"/sbin/ldconfig"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span>invoke ldconfig
                  <span style="color: #008000;">"-X"</span>                 <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Don't update symbolic links.</span>
                  <span style="color: #008000;">"-f"</span> #$ld-conf       <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Use #$ld-conf as configuration file.</span>
                  <span style="color: #008000;">"-C"</span> #$output<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Use #$output as cache file.</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">packages-&gt;ld.so.conf</span> packages<span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Takes a list of package objects and returns a file-like object for ld.so.conf</span>
<span style="color: #008000;">in the Guix store"</span>
  <span style="color: #7388D6;">(</span>computed-file
   <span style="color: #008000;">"ld.so.conf"</span>
   <span style="color: #909183;">(</span>with-imported-modules
    `<span style="color: #709870;">(</span><span style="color: #907373;">(</span>guix build union<span style="color: #907373;">)</span>
      <span style="color: #907373;">(</span>guix build utils<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    #~<span style="color: #709870;">(</span><span style="color: #0000FF;">begin</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #6276BA;">(</span>guix build union<span style="color: #6276BA;">)</span>
                     <span style="color: #6276BA;">(</span>guix build utils<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
        <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Need to quote "#$packages" as #$packages tries to "apply" the first item to the rest, like a procedure.</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #6276BA;">(</span><span style="color: #858580;">(</span>packages '#$packages<span style="color: #858580;">)</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Add "/lib" to each package.</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">TODO Make this more general for other needed directories.</span>
               <span style="color: #858580;">(</span>dirs-lib
                <span style="color: #80A880;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #887070;">(</span>packages<span style="color: #887070;">)</span>
                  <span style="color: #887070;">(</span><span style="color: #0000FF;">map</span> <span style="color: #707183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #7388D6;">(</span>package<span style="color: #7388D6;">)</span>
                         <span style="color: #7388D6;">(</span>string-append package <span style="color: #008000;">"/lib"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                       packages<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>fhs-lib-dirs
                <span style="color: #80A880;">(</span>dirs-lib packages<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">call-with-output-file</span> #$output
            <span style="color: #858580;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #80A880;">(</span>port<span style="color: #80A880;">)</span>
              <span style="color: #80A880;">(</span><span style="color: #0000FF;">for-each</span> <span style="color: #887070;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #707183;">(</span>directory<span style="color: #707183;">)</span>
                          <span style="color: #707183;">(</span>display directory port<span style="color: #707183;">)</span>
                          <span style="color: #707183;">(</span>newline port<span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                        fhs-lib-dirs<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          #$output<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steam-ld.so.conf</span>
  <span style="color: #7388D6;">(</span>packages-&gt;ld.so.conf
   <span style="color: #909183;">(</span>list <span style="color: #709870;">(</span>fhs-union `<span style="color: #907373;">(</span>,@steam-client-libs
                      ,@steam-gameruntime-libs
                      ,@fhs-min-libs<span style="color: #907373;">)</span>
                    <span style="color: #006FE0;">#:name</span> <span style="color: #008000;">"fhs-union-64"</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>fhs-union `<span style="color: #907373;">(</span>,@steam-client-libs
                      ,@steam-gameruntime-libs
                      ,@fhs-min-libs<span style="color: #907373;">)</span>
                    <span style="color: #006FE0;">#:name</span> <span style="color: #008000;">"fhs-union-32"</span>
                    <span style="color: #006FE0;">#:system</span> <span style="color: #008000;">"i686-linux"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">steam-ld.so.cache</span>
  <span style="color: #7388D6;">(</span>ld.so.conf-&gt;ld.so.cache steam-ld.so.conf<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">nonguix-container-&gt;package</span> container<span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Return a package with wrapper script to launch the supplied container object</span>
<span style="color: #008000;">in a sandboxed FHS environment."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #909183;">(</span><span style="color: #709870;">(</span>fhs-internal <span style="color: #907373;">(</span>make-container-internal container<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>fhs-manifest <span style="color: #907373;">(</span>make-container-manifest container fhs-internal<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>fhs-wrapper <span style="color: #907373;">(</span>make-container-wrapper container fhs-manifest fhs-internal<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>pkg <span style="color: #907373;">(</span>ngc-wrap-package container<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span>package
     <span style="color: #709870;">(</span>name <span style="color: #907373;">(</span>ngc-name container<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>version <span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span>ngc-version container<span style="color: #6276BA;">)</span>
                  <span style="color: #6276BA;">(</span>package-version pkg<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>source #f<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>inputs `<span style="color: #907373;">(</span><span style="color: #6276BA;">(</span><span style="color: #008000;">"wrap-package"</span> ,<span style="color: #858580;">(</span>ngc-wrap-package container<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
               ,@<span style="color: #6276BA;">(</span><span style="color: #0000FF;">if</span> <span style="color: #858580;">(</span>null? <span style="color: #80A880;">(</span>ngc-union64 container<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                     '<span style="color: #858580;">()</span>
                     `<span style="color: #858580;">(</span><span style="color: #80A880;">(</span><span style="color: #008000;">"fhs-union-64"</span> ,<span style="color: #887070;">(</span>ngc-union64 container<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
               ,@<span style="color: #6276BA;">(</span><span style="color: #0000FF;">if</span> <span style="color: #858580;">(</span>null? <span style="color: #80A880;">(</span>ngc-union32 container<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                     '<span style="color: #858580;">()</span>
                     `<span style="color: #858580;">(</span><span style="color: #80A880;">(</span><span style="color: #008000;">"fhs-union-32"</span> ,<span style="color: #887070;">(</span>ngc-union32 container<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
               <span style="color: #6276BA;">(</span><span style="color: #008000;">"fhs-internal"</span> ,fhs-internal<span style="color: #6276BA;">)</span>
               <span style="color: #6276BA;">(</span><span style="color: #008000;">"fhs-wrapper"</span> ,fhs-wrapper<span style="color: #6276BA;">)</span>
               <span style="color: #6276BA;">(</span><span style="color: #008000;">"fhs-manifest"</span> ,fhs-manifest<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>build-system trivial-build-system<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>arguments
      `<span style="color: #907373;">(</span><span style="color: #006FE0;">#:modules</span> <span style="color: #6276BA;">(</span><span style="color: #858580;">(</span>guix build utils<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
        <span style="color: #006FE0;">#:builder</span>
        <span style="color: #6276BA;">(</span><span style="color: #0000FF;">begin</span>
          <span style="color: #858580;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #80A880;">(</span>guix build utils<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
          <span style="color: #858580;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #80A880;">(</span><span style="color: #887070;">(</span>out <span style="color: #707183;">(</span>assoc-ref %outputs <span style="color: #008000;">"out"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                 <span style="color: #887070;">(</span>internal-target <span style="color: #707183;">(</span>string-append <span style="color: #7388D6;">(</span>assoc-ref %build-inputs <span style="color: #008000;">"fhs-internal"</span><span style="color: #7388D6;">)</span>
                                                 <span style="color: #008000;">"/bin/"</span> ,<span style="color: #7388D6;">(</span>ngc-internal-name container<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                 <span style="color: #887070;">(</span>internal-dest <span style="color: #707183;">(</span>string-append out <span style="color: #008000;">"/sbin/"</span> ,<span style="color: #7388D6;">(</span>ngc-internal-name container<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                 <span style="color: #887070;">(</span>manifest-target <span style="color: #707183;">(</span>assoc-ref %build-inputs <span style="color: #008000;">"fhs-manifest"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                 <span style="color: #887070;">(</span>manifest-dest <span style="color: #707183;">(</span>string-append out <span style="color: #008000;">"/etc/"</span> ,<span style="color: #7388D6;">(</span>ngc-manifest-name container<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                 <span style="color: #887070;">(</span>wrapper-target <span style="color: #707183;">(</span>assoc-ref %build-inputs <span style="color: #008000;">"fhs-wrapper"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                 <span style="color: #887070;">(</span>wrapper-dest <span style="color: #707183;">(</span>string-append out <span style="color: #008000;">"/bin/"</span> ,<span style="color: #7388D6;">(</span>ngc-binpath container<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                 <span style="color: #887070;">(</span>link-files ',<span style="color: #707183;">(</span>ngc-link-files container<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
            <span style="color: #80A880;">(</span>mkdir-p <span style="color: #887070;">(</span>string-append out <span style="color: #008000;">"/sbin"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
            <span style="color: #80A880;">(</span>mkdir-p <span style="color: #887070;">(</span>string-append out <span style="color: #008000;">"/etc"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
            <span style="color: #80A880;">(</span>mkdir-p <span style="color: #887070;">(</span>string-append out <span style="color: #008000;">"/bin"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
            <span style="color: #80A880;">(</span>symlink internal-target internal-dest<span style="color: #80A880;">)</span>
            <span style="color: #80A880;">(</span>symlink wrapper-target wrapper-dest<span style="color: #80A880;">)</span>
            <span style="color: #80A880;">(</span>symlink manifest-target manifest-dest<span style="color: #80A880;">)</span>
            <span style="color: #80A880;">(</span><span style="color: #0000FF;">for-each</span>
             <span style="color: #887070;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #707183;">(</span>link<span style="color: #707183;">)</span>
               <span style="color: #707183;">(</span>mkdir-p <span style="color: #7388D6;">(</span>dirname <span style="color: #909183;">(</span>string-append out <span style="color: #008000;">"/"</span> link<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
               <span style="color: #707183;">(</span>symlink <span style="color: #7388D6;">(</span>string-append <span style="color: #909183;">(</span>assoc-ref %build-inputs <span style="color: #008000;">"wrap-package"</span><span style="color: #909183;">)</span>
                                       <span style="color: #008000;">"/"</span> link<span style="color: #7388D6;">)</span>
                        <span style="color: #7388D6;">(</span>string-append out <span style="color: #008000;">"/"</span> link<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
             link-files<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>home-page <span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span>ngc-home-page container<span style="color: #6276BA;">)</span>
                    <span style="color: #6276BA;">(</span>package-home-page pkg<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>synopsis <span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span>ngc-synopsis container<span style="color: #6276BA;">)</span>
                   <span style="color: #6276BA;">(</span>package-synopsis pkg<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>description <span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span>ngc-description container<span style="color: #6276BA;">)</span>
                      <span style="color: #6276BA;">(</span>package-description pkg<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>license <span style="color: #907373;">(</span><span style="color: #0000FF;">or</span> <span style="color: #6276BA;">(</span>ngc-license container<span style="color: #6276BA;">)</span>
                  <span style="color: #6276BA;">(</span>package-license pkg<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">make-container-wrapper</span> container fhs-manifest fhs-internal<span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Return a script file-like object that launches the supplied container object</span>
<span style="color: #008000;">in a sandboxed FHS environment."</span>
  <span style="color: #7388D6;">(</span>program-file
   <span style="color: #909183;">(</span>ngc-wrapper-name container<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>with-imported-modules
    `<span style="color: #709870;">(</span><span style="color: #907373;">(</span>guix build utils<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    #~<span style="color: #709870;">(</span><span style="color: #0000FF;">begin</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #6276BA;">(</span>guix build utils<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">define</span> <span style="color: #6276BA;">(</span><span style="color: #006699;">preserve-var</span> var<span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span>string-append <span style="color: #008000;">"--preserve="</span> var<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">define*</span> <span style="color: #6276BA;">(</span><span style="color: #006699;">add-path</span> path <span style="color: #006FE0;">#:key</span> writable?<span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">let</span> <span style="color: #858580;">(</span><span style="color: #80A880;">(</span>opt <span style="color: #887070;">(</span><span style="color: #0000FF;">if</span> writable?
                         <span style="color: #008000;">"--share="</span>
                         <span style="color: #008000;">"--expose="</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">if</span> <span style="color: #80A880;">(</span>pair? path<span style="color: #80A880;">)</span>
                <span style="color: #80A880;">(</span>string-append opt <span style="color: #887070;">(</span>car path<span style="color: #887070;">)</span> <span style="color: #008000;">"="</span> <span style="color: #887070;">(</span>cdr path<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                <span style="color: #80A880;">(</span>string-append opt path<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">define</span> <span style="color: #6276BA;">(</span><span style="color: #006699;">exists-&gt;</span> file<span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">if</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">and</span> file <span style="color: #80A880;">(</span>file-exists? file<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
              `<span style="color: #858580;">(</span>,file<span style="color: #858580;">)</span> '<span style="color: #858580;">()</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #6276BA;">(</span><span style="color: #858580;">(</span>run #$<span style="color: #80A880;">(</span>file-append fhs-internal <span style="color: #008000;">"/bin/"</span> <span style="color: #887070;">(</span>ngc-internal-name container<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>manifest-file #$<span style="color: #80A880;">(</span>file-append fhs-manifest<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>xdg-runtime <span style="color: #80A880;">(</span>getenv <span style="color: #008000;">"XDG_RUNTIME_DIR"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>home <span style="color: #80A880;">(</span>getenv <span style="color: #008000;">"HOME"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>sandbox-home <span style="color: #80A880;">(</span><span style="color: #0000FF;">or</span> <span style="color: #887070;">(</span>getenv <span style="color: #008000;">"GUIX_SANDBOX_HOME"</span><span style="color: #887070;">)</span>
                                 <span style="color: #887070;">(</span>string-append home <span style="color: #008000;">"/"</span> #$<span style="color: #707183;">(</span>ngc-sandbox-home container<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>preserved-env '<span style="color: #80A880;">(</span><span style="color: #008000;">"^DBUS_"</span>
                                <span style="color: #008000;">"^DISPLAY$"</span>
                                <span style="color: #008000;">"^DRI_PRIME$"</span>
                                <span style="color: #008000;">"^GDK_SCALE$"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">For Steam UI scaling.</span>
                                <span style="color: #008000;">"^PRESSURE_VESSEL_"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">For pressure vessel options.</span>
                                <span style="color: #008000;">"_PROXY$"</span>
                                <span style="color: #008000;">"_proxy$"</span>
                                <span style="color: #008000;">"^SDL_"</span>
                                <span style="color: #008000;">"^STEAM_"</span>
                                <span style="color: #008000;">"^VDPAU_DRIVER_PATH$"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">For VDPAU drivers.</span>
                                <span style="color: #008000;">"^XAUTHORITY$"</span>
                                <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Matching all ^XDG_ vars causes issues</span>
                                <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">discussed in 80decf05.</span>
                                <span style="color: #008000;">"^XDG_DATA_HOME$"</span>
                                <span style="color: #008000;">"^XDG_RUNTIME_DIR$"</span>
                                <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">The following are useful for debugging.</span>
                                <span style="color: #008000;">"^CAPSULE_DEBUG$"</span>
                                <span style="color: #008000;">"^G_MESSAGES_DEBUG$"</span>
                                <span style="color: #008000;">"^LD_DEBUG$"</span>
                                <span style="color: #008000;">"^LIBGL_DEBUG$"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>expose `<span style="color: #80A880;">(</span><span style="color: #008000;">"/dev/bus/usb"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for libusb.</span>
                         <span style="color: #008000;">"/dev/dri"</span>
                         <span style="color: #008000;">"/dev/input"</span>  <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for controller input.</span>
                         <span style="color: #008000;">"/dev/uinput"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for Steam Input.</span>
                         ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #008000;">"/dev/nvidia0"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">needed for nvidia proprietary driver</span>
                         ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #008000;">"/dev/nvidiactl"</span><span style="color: #887070;">)</span>
                         ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #008000;">"/dev/nvidia-modeset"</span><span style="color: #887070;">)</span>
                         ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #008000;">"/etc/machine-id"</span><span style="color: #887070;">)</span>
                         <span style="color: #008000;">"/etc/localtime"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for correct time zone.</span>
                         <span style="color: #008000;">"/sys/class/drm"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for hw monitoring like MangoHud.</span>
                         <span style="color: #008000;">"/sys/class/hwmon"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for hw monitoring like MangoHud.</span>
                         <span style="color: #008000;">"/sys/class/hidraw"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for devices like the Valve Index.</span>
                         <span style="color: #008000;">"/sys/class/input"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for controller input.</span>
                         ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #008000;">"/sys/class/power_supply"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for power monitoring like MangoHud.</span>
                         ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #008000;">"/sys/class/powercap"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for power monitoring like MangoHud.</span>
                         <span style="color: #008000;">"/sys/dev"</span>
                         <span style="color: #008000;">"/sys/devices"</span>
                         <span style="color: #008000;">"/mnt"</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Needed for access to mounted drives</span>
                         ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #008000;">"/var/run/dbus"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">/dev/hidraw is needed for SteamVR to access the HMD, although here we</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">share all hidraw devices. Instead we could filter to only share specific</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">device. See, for example, this script:</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">https://arvchristos.github.io/post/matching-dev-hidraw-devices-with-physical-devices/</span>
               <span style="color: #858580;">(</span>share `<span style="color: #80A880;">(</span>,@<span style="color: #887070;">(</span>find-files <span style="color: #008000;">"/dev"</span> <span style="color: #008000;">"hidraw"</span><span style="color: #887070;">)</span>
                        <span style="color: #008000;">"/dev/shm"</span>
                        <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">"/tmp/.X11-unix" is needed for bwrap, and "/tmp" more generally</span>
                        <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">for writing things like crash dumps and "steam_chrome_shm".</span>
                        <span style="color: #008000;">"/tmp"</span>
                        ,<span style="color: #887070;">(</span>string-append sandbox-home <span style="color: #008000;">"="</span> home<span style="color: #887070;">)</span>
                        ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #707183;">(</span>string-append home <span style="color: #008000;">"/.config/pulse"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                        ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #707183;">(</span>string-append home <span style="color: #008000;">"/.icons"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Fix mouse cursor</span>
                        ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #707183;">(</span>string-append xdg-runtime <span style="color: #008000;">"/pulse"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                        ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #707183;">(</span>string-append xdg-runtime <span style="color: #008000;">"/bus"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                        ,@<span style="color: #887070;">(</span>exists-&gt; <span style="color: #707183;">(</span>getenv <span style="color: #008000;">"XAUTHORITY"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>DEBUG <span style="color: #80A880;">(</span>equal? <span style="color: #887070;">(</span>getenv <span style="color: #008000;">"DEBUG"</span><span style="color: #887070;">)</span> <span style="color: #008000;">"1"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>args <span style="color: #80A880;">(</span>cdr <span style="color: #887070;">(</span>command-line<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
               <span style="color: #858580;">(</span>command <span style="color: #80A880;">(</span><span style="color: #0000FF;">if</span> DEBUG '<span style="color: #887070;">()</span>
                            `<span style="color: #887070;">(</span><span style="color: #008000;">"--"</span> ,run ,@args<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">TODO: Remove once upstream change is merged and in stable pressure-vessel</span>
          <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">(although may want to hold off for anyone using older pressure-vessel versions</span>
          <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">for whatever reason), see:</span>
          <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">https://gitlab.steamos.cloud/steamrt/steam-runtime-tools/-/merge_requests/406</span>
          <span style="color: #6276BA;">(</span>setenv <span style="color: #008000;">"PRESSURE_VESSEL_FILESYSTEMS_RO"</span> <span style="color: #008000;">"/gnu/store"</span><span style="color: #6276BA;">)</span>
          <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">By default VDPAU drivers are searched for in libvdpau's store</span>
          <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">path, so set this path to where the drivers will actually be</span>
          <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">located in the container.</span>
          <span style="color: #6276BA;">(</span>setenv <span style="color: #008000;">"VDPAU_DRIVER_PATH"</span> <span style="color: #008000;">"/lib64/vdpau"</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span>format #t <span style="color: #008000;">"\n* Launching ~a in sandbox: ~a.\n\n"</span>
                  #$<span style="color: #858580;">(</span>package-name <span style="color: #80A880;">(</span>ngc-wrap-package container<span style="color: #80A880;">)</span><span style="color: #858580;">)</span> sandbox-home<span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">when</span> DEBUG
            <span style="color: #858580;">(</span>format #t <span style="color: #008000;">"* DEBUG set to 1: Starting shell. Launch application manually with: ~a.\n\n"</span>
                    #$<span style="color: #80A880;">(</span>ngc-internal-name container<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span>mkdir-p sandbox-home<span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span>invoke #$<span style="color: #858580;">(</span>file-append pulseaudio <span style="color: #008000;">"/bin/pulseaudio"</span><span style="color: #858580;">)</span>
                  <span style="color: #008000;">"--start"</span>
                  <span style="color: #008000;">"--exit-idle-time=60"</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span>apply invoke
                 `<span style="color: #858580;">(</span><span style="color: #008000;">"guix"</span> <span style="color: #008000;">"shell"</span>
                   <span style="color: #008000;">"--container"</span> <span style="color: #008000;">"--no-cwd"</span> <span style="color: #008000;">"--network"</span>
                   ,@<span style="color: #80A880;">(</span><span style="color: #0000FF;">map</span> preserve-var preserved-env<span style="color: #80A880;">)</span>
                   ,@<span style="color: #80A880;">(</span><span style="color: #0000FF;">map</span> add-path expose<span style="color: #80A880;">)</span>
                   ,@<span style="color: #80A880;">(</span><span style="color: #0000FF;">map</span> <span style="color: #887070;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #707183;">(</span>item<span style="color: #707183;">)</span>
                            <span style="color: #707183;">(</span>add-path item <span style="color: #006FE0;">#:writable?</span> #t<span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                          share<span style="color: #80A880;">)</span>
                   <span style="color: #008000;">"-m"</span> ,manifest-file
                   ,@command<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">make-container-manifest</span> container fhs-internal<span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Return a scheme file-like object to be used as package manifest for FHS</span>
<span style="color: #008000;">containers.  This manifest will use the 'modules' and 'packages' fields</span>
<span style="color: #008000;">specified in the container object, and will also include the exact store paths</span>
<span style="color: #008000;">of the containers 'wrap-package', 'union32', and 'union64' fields, as well as</span>
<span style="color: #008000;">the exact path for the fhs-internal package."</span>
  <span style="color: #7388D6;">(</span>scheme-file
   <span style="color: #909183;">(</span>ngc-manifest-name container<span style="color: #909183;">)</span>
   #~<span style="color: #909183;">(</span><span style="color: #0000FF;">begin</span>
       <span style="color: #709870;">(</span>use-package-modules
        #$@<span style="color: #907373;">(</span>ngc-modules container<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
       <span style="color: #709870;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #907373;">(</span>guix gexp<span style="color: #907373;">)</span>
                    <span style="color: #907373;">(</span>guix utils<span style="color: #907373;">)</span>
                    <span style="color: #907373;">(</span>guix profiles<span style="color: #907373;">)</span>
                    <span style="color: #907373;">(</span>guix store<span style="color: #907373;">)</span>
                    <span style="color: #907373;">(</span>guix scripts package<span style="color: #907373;">)</span>
                    <span style="color: #907373;">(</span>srfi srfi-11<span style="color: #907373;">)</span><span style="color: #709870;">)</span>

       <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Copied from guix/scripts/package.scm.</span>
       <span style="color: #709870;">(</span><span style="color: #0000FF;">define</span> <span style="color: #907373;">(</span><span style="color: #006699;">store-item-&gt;manifest-entry</span> item<span style="color: #907373;">)</span>
         <span style="color: #008000;">"Return a manifest entry for ITEM, a \"/gnu/store/...\" file name."</span>
         <span style="color: #907373;">(</span><span style="color: #0000FF;">let-values</span> <span style="color: #6276BA;">(</span><span style="color: #858580;">(</span><span style="color: #80A880;">(</span>name version<span style="color: #80A880;">)</span>
                       <span style="color: #80A880;">(</span>package-name-&gt;name+version <span style="color: #887070;">(</span>store-path-package-name item<span style="color: #887070;">)</span>
                                                   #\-<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
           <span style="color: #6276BA;">(</span>manifest-entry
            <span style="color: #858580;">(</span>name name<span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span>version version<span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span>output <span style="color: #008000;">"out"</span><span style="color: #858580;">)</span>             <span style="color: #8D8D84; font-style: italic;">;</span><span style="color: #8D8D84; font-style: italic;">XXX: wild guess</span>
            <span style="color: #858580;">(</span>item item<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>

       <span style="color: #709870;">(</span>manifest-add
        <span style="color: #907373;">(</span>packages-&gt;manifest <span style="color: #6276BA;">(</span>list #$@<span style="color: #858580;">(</span>ngc-packages container<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
        <span style="color: #907373;">(</span><span style="color: #0000FF;">map</span> store-item-&gt;manifest-entry
             '<span style="color: #6276BA;">(</span>#$<span style="color: #858580;">(</span>file-append <span style="color: #80A880;">(</span>ngc-wrap-package container<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                 #$<span style="color: #858580;">(</span>file-append <span style="color: #80A880;">(</span>ngc-union64 container<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                 #$<span style="color: #858580;">(</span>file-append <span style="color: #80A880;">(</span>ngc-union32 container<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
                 #$<span style="color: #858580;">(</span>file-append fhs-internal<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">make-container-internal</span> container<span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Return a dummy package housing the fhs-internal script."</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>name <span style="color: #709870;">(</span>ngc-internal-name container<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>version <span style="color: #709870;">(</span><span style="color: #0000FF;">or</span> <span style="color: #907373;">(</span>ngc-version container<span style="color: #907373;">)</span>
                <span style="color: #907373;">(</span>package-version <span style="color: #6276BA;">(</span>ngc-wrap-package container<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>source #f<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>inputs `<span style="color: #709870;">(</span><span style="color: #907373;">(</span><span style="color: #008000;">"fhs-internal-script"</span> ,<span style="color: #6276BA;">(</span>make-internal-script container<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>build-system trivial-build-system<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>arguments
    `<span style="color: #709870;">(</span><span style="color: #006FE0;">#:modules</span> <span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>guix build utils<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
      <span style="color: #006FE0;">#:builder</span>
      <span style="color: #907373;">(</span><span style="color: #0000FF;">begin</span>
        <span style="color: #6276BA;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #858580;">(</span>guix build utils<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
        <span style="color: #6276BA;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #858580;">(</span><span style="color: #80A880;">(</span>bin <span style="color: #887070;">(</span>string-append <span style="color: #707183;">(</span>assoc-ref %outputs <span style="color: #008000;">"out"</span><span style="color: #707183;">)</span> <span style="color: #008000;">"/bin"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
               <span style="color: #80A880;">(</span>internal-target <span style="color: #887070;">(</span>assoc-ref %build-inputs <span style="color: #008000;">"fhs-internal-script"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
               <span style="color: #80A880;">(</span>internal-dest <span style="color: #887070;">(</span>string-append bin <span style="color: #008000;">"/"</span> ,<span style="color: #707183;">(</span>ngc-internal-name container<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
          <span style="color: #858580;">(</span>mkdir-p bin<span style="color: #858580;">)</span>
          <span style="color: #858580;">(</span>symlink internal-target internal-dest<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>home-page #f<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>synopsis <span style="color: #008000;">"Script used to set up sandbox"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>description <span style="color: #008000;">"Script used inside the FHS Guix container to set up the</span>
<span style="color: #008000;">environment."</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>license #f<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define</span> <span style="color: #7388D6;">(</span><span style="color: #006699;">make-internal-script</span> container<span style="color: #7388D6;">)</span>
  <span style="color: #008000;">"Return an fhs-internal script which is used to perform additional steps to</span>
<span style="color: #008000;">set up the environment inside an FHS container before launching the desired</span>
<span style="color: #008000;">application."</span>
  <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">The ld cache is not created inside the container, meaning the paths it</span>
  <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">contains are directly to /gnu/store/. Instead, it could be generated with</span>
  <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">a generic ld.so.conf and result in paths more typical in an FHS distro,</span>
  <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">like /lib within the container. This may be useful for future compatibility.</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #909183;">(</span><span style="color: #709870;">(</span>ld.so.conf steam-ld.so.conf<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>ld.so.cache steam-ld.so.cache<span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>pkg <span style="color: #907373;">(</span>ngc-wrap-package container<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
         <span style="color: #709870;">(</span>run <span style="color: #907373;">(</span>ngc-run container<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span>program-file
     <span style="color: #709870;">(</span>ngc-internal-name container<span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>with-imported-modules
      `<span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>guix build utils<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
      #~<span style="color: #907373;">(</span><span style="color: #0000FF;">begin</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">use-modules</span> <span style="color: #858580;">(</span>guix build utils<span style="color: #858580;">)</span>
                       <span style="color: #858580;">(</span>ice-9 getopt-long<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">define</span> <span style="color: #858580;">(</span><span style="color: #006699;">path-&gt;str</span> path<span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">if</span> <span style="color: #80A880;">(</span>list? path<span style="color: #80A880;">)</span>
                <span style="color: #80A880;">(</span>string-join path <span style="color: #008000;">"/"</span><span style="color: #80A880;">)</span>
                path<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">define</span> <span style="color: #858580;">(</span><span style="color: #006699;">new-symlink</span> pair<span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">let</span> <span style="color: #80A880;">(</span><span style="color: #887070;">(</span>target <span style="color: #707183;">(</span>path-&gt;str <span style="color: #7388D6;">(</span>car pair<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                  <span style="color: #887070;">(</span>dest <span style="color: #707183;">(</span>path-&gt;str <span style="color: #7388D6;">(</span>cdr pair<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
              <span style="color: #80A880;">(</span><span style="color: #0000FF;">unless</span> <span style="color: #887070;">(</span>file-exists? dest<span style="color: #887070;">)</span>
                <span style="color: #887070;">(</span>symlink target dest<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">define</span> <span style="color: #858580;">(</span><span style="color: #006699;">icd-symlink</span> file<span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span>new-symlink
             `<span style="color: #80A880;">(</span>,file . <span style="color: #887070;">(</span><span style="color: #008000;">"/usr/share/vulkan/icd.d"</span> ,<span style="color: #707183;">(</span>basename file<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">define</span> <span style="color: #006699;">fhs-option-spec</span>
            '<span style="color: #858580;">(</span><span style="color: #80A880;">(</span>asound32 <span style="color: #887070;">(</span>value #f<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
          <span style="color: #6276BA;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #858580;">(</span><span style="color: #80A880;">(</span>guix-env <span style="color: #887070;">(</span>getenv <span style="color: #008000;">"GUIX_ENVIRONMENT"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                 <span style="color: #80A880;">(</span>union64 #$<span style="color: #887070;">(</span>file-append <span style="color: #707183;">(</span>ngc-union64 container<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                 <span style="color: #80A880;">(</span>union32 #$<span style="color: #887070;">(</span>file-append <span style="color: #707183;">(</span>ngc-union32 container<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                 <span style="color: #80A880;">(</span>ld.so.conf #$<span style="color: #887070;">(</span>file-append ld.so.conf<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                 <span style="color: #80A880;">(</span>ld.so.cache #$<span style="color: #887070;">(</span>file-append ld.so.cache<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                 <span style="color: #80A880;">(</span>all-args <span style="color: #887070;">(</span>cdr <span style="color: #707183;">(</span>command-line<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                 <span style="color: #80A880;">(</span>fhs-args <span style="color: #887070;">(</span>member <span style="color: #008000;">"--"</span> all-args<span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
                 <span style="color: #80A880;">(</span>steam-args <span style="color: #887070;">(</span><span style="color: #0000FF;">if</span> fhs-args
                                 <span style="color: #707183;">(</span>reverse <span style="color: #7388D6;">(</span>cdr <span style="color: #909183;">(</span>member <span style="color: #008000;">"--"</span> <span style="color: #709870;">(</span>reverse all-args<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
                                 all-args<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span>delete-file <span style="color: #008000;">"/bin/sh"</span><span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span>rmdir <span style="color: #008000;">"/bin"</span><span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">for-each</span>
             mkdir-p
             '<span style="color: #80A880;">(</span><span style="color: #008000;">"/run/current-system/profile/etc"</span>
               <span style="color: #008000;">"/run/current-system/profile/share"</span>
               <span style="color: #008000;">"/sbin"</span>
               <span style="color: #008000;">"/usr/share/vulkan/icd.d"</span>
               <span style="color: #008000;">"/usr/share/vulkan/implicit_layer.d"</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Implicit layers like MangoHud</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">for-each</span>
             new-symlink
             `<span style="color: #80A880;">(</span><span style="color: #887070;">(</span>,ld.so.cache . <span style="color: #008000;">"/etc/ld.so.cache"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span>,ld.so.conf . <span style="color: #008000;">"/etc/ld.so.conf"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">needed?</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,guix-env <span style="color: #008000;">"etc/ssl"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/etc/ssl"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,guix-env <span style="color: #008000;">"etc/ssl"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/run/current-system/profile/etc/ssl"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union32 <span style="color: #008000;">"lib"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/lib"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union32 <span style="color: #008000;">"lib"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/run/current-system/profile/lib"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"bin"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/bin"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"bin"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/usr/bin"</span><span style="color: #887070;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Steam hardcodes some paths like xdg-open.</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"lib"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/lib64"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"lib"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/run/current-system/profile/lib64"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"lib/locale"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/run/current-system/locale"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"sbin/ldconfig"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/sbin/ldconfig"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"share/drirc.d"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/usr/share/drirc.d"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"share/fonts"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/run/current-system/profile/share/fonts"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"etc/fonts"</span><span style="color: #707183;">)</span> . <span style="color: #008000;">"/etc/fonts"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"share/vulkan/explicit_layer.d"</span><span style="color: #707183;">)</span> .
                <span style="color: #008000;">"/usr/share/vulkan/explicit_layer.d"</span><span style="color: #887070;">)</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">The MangoHud layer has the same file name for 64- and 32-bit,</span>
               <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">so create links with different names.</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union64 <span style="color: #008000;">"share/vulkan/implicit_layer.d/MangoHud.json"</span><span style="color: #707183;">)</span> .
                <span style="color: #008000;">"/usr/share/vulkan/implicit_layer.d/MangoHud.json"</span><span style="color: #887070;">)</span>
               <span style="color: #887070;">(</span><span style="color: #707183;">(</span>,union32 <span style="color: #008000;">"share/vulkan/implicit_layer.d/MangoHud.json"</span><span style="color: #707183;">)</span> .
                <span style="color: #008000;">"/usr/share/vulkan/implicit_layer.d/MangoHud.x86.json"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">for-each</span>
             icd-symlink
             <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Use stat to follow links from packages like MangoHud.</span>
             `<span style="color: #80A880;">(</span>,@<span style="color: #887070;">(</span>find-files <span style="color: #707183;">(</span>string-append union32 <span style="color: #008000;">"/share/vulkan/icd.d"</span><span style="color: #707183;">)</span>
                             <span style="color: #006FE0;">#:directories?</span> #t <span style="color: #006FE0;">#:stat</span> stat<span style="color: #887070;">)</span>
               ,@<span style="color: #887070;">(</span>find-files <span style="color: #707183;">(</span>string-append union64 <span style="color: #008000;">"/share/vulkan/icd.d"</span><span style="color: #707183;">)</span>
                             <span style="color: #006FE0;">#:directories?</span> #t <span style="color: #006FE0;">#:stat</span> stat<span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>
            <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">TODO: Is this the right place for this?</span>
            <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Newer versions of Steam won't startup if they can't copy to here</span>
            <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">(previous would output this error but continue).</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">if</span> <span style="color: #80A880;">(</span>file-exists? <span style="color: #008000;">".steam/root/bootstrap.tar.xz"</span><span style="color: #80A880;">)</span>
                <span style="color: #80A880;">(</span>chmod <span style="color: #008000;">".steam/root/bootstrap.tar.xz"</span> #o644<span style="color: #80A880;">)</span><span style="color: #858580;">)</span>

            <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Process FHS-specific command line options.</span>
            <span style="color: #858580;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #80A880;">(</span><span style="color: #887070;">(</span>options <span style="color: #707183;">(</span>getopt-long <span style="color: #7388D6;">(</span><span style="color: #0000FF;">or</span> fhs-args '<span style="color: #909183;">(</span><span style="color: #008000;">""</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span> fhs-option-spec<span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                   <span style="color: #887070;">(</span>asound32-opt <span style="color: #707183;">(</span>option-ref options 'asound32 #f<span style="color: #707183;">)</span><span style="color: #887070;">)</span>
                   <span style="color: #887070;">(</span>asound-lib <span style="color: #707183;">(</span><span style="color: #0000FF;">if</span> asound32-opt <span style="color: #008000;">"lib"</span> <span style="color: #008000;">"lib64"</span><span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
              <span style="color: #80A880;">(</span><span style="color: #0000FF;">if</span> asound32-opt
                  <span style="color: #887070;">(</span>display <span style="color: #008000;">"\n\n/etc/asound.conf configured for 32-bit.\n\n\n"</span><span style="color: #887070;">)</span>
                  <span style="color: #887070;">(</span>display <span style="color: #008000;">"\n\n/etc/asound.conf configured for 64-bit.\nLaunch steam with \"steam -- --asound32\" to use 32-bit instead.\n\n\n"</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span>
              <span style="color: #80A880;">(</span><span style="color: #0000FF;">with-output-to-file</span> <span style="color: #008000;">"/etc/asound.conf"</span>
                <span style="color: #887070;">(</span><span style="color: #0000FF;">lambda</span> _ <span style="color: #707183;">(</span>format <span style="color: #7388D6;">(</span>current-output-port<span style="color: #7388D6;">)</span> <span style="color: #008000;">"# Generated by steam-client</span>

<span style="color: #008000;"># Use PulseAudio by default</span>
<span style="color: #008000;">pcm_type.pulse {</span>
<span style="color: #008000;">  lib \"/~a/alsa-lib/libasound_module_pcm_pulse.so\"</span>
<span style="color: #008000;">}</span>

<span style="color: #008000;">ctl_type.pulse {</span>
<span style="color: #008000;">  lib \"/~a/alsa-lib/libasound_module_ctl_pulse.so\"</span>
<span style="color: #008000;">}</span>

<span style="color: #008000;">pcm.!default {</span>
<span style="color: #008000;">  type pulse</span>
<span style="color: #008000;">  fallback \"sysdefault\"</span>
<span style="color: #008000;">  hint {</span>
<span style="color: #008000;">    show on</span>
<span style="color: #008000;">    description \"Default ALSA Output (currently PulseAudio Sound Server)\"</span>
<span style="color: #008000;">  }</span>
<span style="color: #008000;">}</span>

<span style="color: #008000;">ctl.!default {</span>
<span style="color: #008000;">  type pulse</span>
<span style="color: #008000;">  fallback \"sysdefault\"</span>
<span style="color: #008000;">}\n\n"</span> asound-lib asound-lib<span style="color: #707183;">)</span><span style="color: #887070;">)</span><span style="color: #80A880;">)</span><span style="color: #858580;">)</span>

            <span style="color: #858580;">(</span>apply system* `<span style="color: #80A880;">(</span>#$<span style="color: #887070;">(</span>file-append pkg run<span style="color: #887070;">)</span> ,@steam-args<span style="color: #80A880;">)</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-public</span> <span style="color: #006699;">steam</span>
  <span style="color: #7388D6;">(</span>nonguix-container-&gt;package
   <span style="color: #909183;">(</span>nonguix-container
    <span style="color: #709870;">(</span>name <span style="color: #008000;">"steam-patched"</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>binpath <span style="color: #008000;">"steam"</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>wrap-package steam-client<span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>run <span style="color: #008000;">"/bin/steam"</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>union64
     <span style="color: #907373;">(</span>fhs-union `<span style="color: #6276BA;">(</span>,@steam-client-libs
                  ,@steam-gameruntime-libs
                  ,@fhs-min-libs<span style="color: #6276BA;">)</span>
                <span style="color: #006FE0;">#:name</span> <span style="color: #008000;">"fhs-union-64"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>union32
     <span style="color: #907373;">(</span>fhs-union `<span style="color: #6276BA;">(</span>,@steam-client-libs
                  ,@steam-gameruntime-libs
                  ,@fhs-min-libs<span style="color: #6276BA;">)</span>
                <span style="color: #006FE0;">#:name</span> <span style="color: #008000;">"fhs-union-32"</span>
                <span style="color: #006FE0;">#:system</span> <span style="color: #008000;">"i686-linux"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>link-files '<span style="color: #907373;">(</span><span style="color: #008000;">"share/applications/steam.desktop"</span>
                  <span style="color: #008000;">"share/applications/steam-asound32.desktop"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>description <span style="color: #008000;">"Steam is a digital software distribution platform created by</span>
<span style="color: #008000;">Valve.  This package provides a script for launching Steam in a Guix container</span>
<span style="color: #008000;">which will use the directory @file{$HOME/.local/share/guix-sandbox-home} where</span>
<span style="color: #008000;">all games will be installed."</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-public</span> <span style="color: #006699;">steam-nvidia</span>
  <span style="color: #7388D6;">(</span>nonguix-container-&gt;package
   <span style="color: #909183;">(</span>nonguix-container
    <span style="color: #709870;">(</span>name <span style="color: #008000;">"steam-nvidia"</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>binpath <span style="color: #008000;">"steam-nvidia"</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>wrap-package steam-client<span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>run <span style="color: #008000;">"/bin/steam"</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>union64
     <span style="color: #907373;">(</span>replace-mesa
      <span style="color: #6276BA;">(</span>fhs-union `<span style="color: #858580;">(</span>,@steam-client-libs
                   ,@steam-gameruntime-libs
                   ,@fhs-min-libs<span style="color: #858580;">)</span>
                 <span style="color: #006FE0;">#:name</span> <span style="color: #008000;">"fhs-union-64"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>union32
     <span style="color: #907373;">(</span>replace-mesa
      <span style="color: #6276BA;">(</span>fhs-union `<span style="color: #858580;">(</span>,@steam-client-libs
                   ,@steam-gameruntime-libs
                   ,@fhs-min-libs<span style="color: #858580;">)</span>
                 <span style="color: #006FE0;">#:name</span> <span style="color: #008000;">"fhs-union-32"</span>
                 <span style="color: #006FE0;">#:system</span> <span style="color: #008000;">"i686-linux"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>link-files '<span style="color: #907373;">(</span><span style="color: #008000;">"share/applications/steam.desktop"</span>
                  <span style="color: #008000;">"share/applications/steam-asound32.desktop"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
    <span style="color: #709870;">(</span>description <span style="color: #008000;">"Steam is a digital software distribution platform created by</span>
<span style="color: #008000;">Valve.  This package provides a script for launching Steam in a Guix container</span>
<span style="color: #008000;">which will use the directory @file{$HOME/.local/share/guix-sandbox-home} where</span>
<span style="color: #008000;">all games will be installed."</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-public</span> <span style="color: #006699;">protonup-ng</span>
  <span style="color: #7388D6;">(</span>package
   <span style="color: #909183;">(</span>name <span style="color: #008000;">"protonup-ng"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>version <span style="color: #008000;">"0.2.1"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>source
    <span style="color: #709870;">(</span>origin
     <span style="color: #907373;">(</span>method git-fetch<span style="color: #907373;">)</span>
     <span style="color: #907373;">(</span>uri <span style="color: #6276BA;">(</span>git-reference
           <span style="color: #858580;">(</span>url <span style="color: #008000;">"https://github.com/cloudishBenne/protonup-ng"</span><span style="color: #858580;">)</span>
           <span style="color: #858580;">(</span>commit version<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
     <span style="color: #907373;">(</span>file-name <span style="color: #6276BA;">(</span>git-file-name name version<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
     <span style="color: #907373;">(</span>sha256
      <span style="color: #6276BA;">(</span>base32 <span style="color: #008000;">"0yd2mhhqxzarqxk85zf42s931jzc94f1cssn1hblsqghr79laa45"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>build-system python-build-system<span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>arguments
    <span style="color: #709870;">(</span>list <span style="color: #006FE0;">#:tests?</span> #f<span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">there are no tests</span>
   <span style="color: #909183;">(</span>inputs
    <span style="color: #709870;">(</span>list python-configparser python-requests<span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>home-page <span style="color: #008000;">"https://github.com/cloudishBenne/protonup-ng"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>synopsis <span style="color: #008000;">"Manage Proton-GE Installations"</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>description <span style="color: #008000;">"ProtonUp-ng is a CLI program and API to automate the installation</span>
<span style="color: #008000;">and update of GloriousEggroll's Proton-GE."</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span>license license:gpl3<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9ae4e64" class="outline-3">
<h3 id="org9ae4e64"><span class="section-number-3">13.2.</span> /etc/guix-modules/nil/services</h3>
<div class="outline-text-3" id="text-13-2">
<p>
Moving on to services.
</p>
</div>

<div id="outline-container-org752ea22" class="outline-4">
<h4 id="org752ea22"><span class="section-number-4">13.2.1.</span> mount-rshared.scm</h4>
<div class="outline-text-4" id="text-13-2-1">
<p>
Tiny service used to remount the root as recursively shared on boot.
</p>
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #707183;">(</span><span style="color: #0000FF;">define-module</span> <span style="color: #7388D6;">(</span><span style="color: #6434A3;">nil services mount-rshared</span><span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix gexp<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix packages<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu packages linux<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix utils<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu services<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>gnu services shepherd<span style="color: #7388D6;">)</span>
  <span style="color: #006FE0;">#:use-module</span> <span style="color: #7388D6;">(</span>guix build utils<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-public</span> <span style="color: #006699;">mount-rshared-service</span>
  <span style="color: #7388D6;">(</span>simple-service 'mount-rshared shepherd-root-service-type
                  <span style="color: #909183;">(</span>list <span style="color: #709870;">(</span>shepherd-service
                         <span style="color: #907373;">(</span>provision '<span style="color: #6276BA;">(</span>mount-rshared<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                         <span style="color: #907373;">(</span>requirement '<span style="color: #6276BA;">(</span>user-processes<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                         <span style="color: #907373;">(</span>start #~<span style="color: #6276BA;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #858580;">()</span>
                                    <span style="color: #858580;">(</span>invoke
                                     #$<span style="color: #80A880;">(</span>file-append util-linux <span style="color: #008000;">"/bin/mount"</span><span style="color: #80A880;">)</span>
                                     <span style="color: #008000;">"--make-rshared"</span> <span style="color: #008000;">"/"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
                         <span style="color: #907373;">(</span>respawn? #f<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org537acd1" class="outline-2">
<h2 id="org537acd1"><span class="section-number-2">14.</span> Emacs</h2>
<div class="outline-text-2" id="text-14">
<p>
Finally - this is my Emacs config, now fully literate!
</p>

<p>
It's pretty full-featured, yet rather short and straightforward. I try to keep this config as readable and maintainable as possible
</p>



<p>
Let's start of with a quick listing of the relevant system-level dependencies:
</p>
<ul class="org-ul">
<li><code>clang</code></li>
<li><code>ripgrep</code></li>
<li><code>font-fira-mono</code></li>
<li><code>sbcl</code></li>
<li><code>clang</code></li>
<li><code>cmake</code></li>
<li><code>make</code></li>
</ul>
<p>
I usually install these using <a href="https://guix.gnu.org">GNU Guix</a>, at least when running Emacs on Linux.
</p>


<p>
Let's start off with setting some basic information about the user.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> user-mail-address <span style="color: #008000;">"shadenk30011@gmail.com"</span>
      user-full-name <span style="color: #008000;">"Jan Novotn&#253;"</span><span style="color: #707183;">)</span>
</pre>
</div>


<p>
EXWM can be toggled here. It's configuration is handled within a separate file.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">defvar</span> <span style="color: #BA36A5;">use-exwm</span> nil<span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">when</span> use-exwm <span style="color: #7388D6;">(</span>load <span style="color: #008000;">"~/.exwm.el"</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Next we need to setup our package archives so that we can ensure all the necessary packages are installed.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">require</span> '<span style="color: #D0372D;">package</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>add-to-list 'package-archives '<span style="color: #7388D6;">(</span><span style="color: #008000;">"melpa"</span> . <span style="color: #008000;">"https://melpa.org/packages/"</span><span style="color: #7388D6;">)</span> t<span style="color: #707183;">)</span>
<span style="color: #8D8D84; font-style: italic;">;;</span><span style="color: #8D8D84; font-style: italic;">(add-to-list 'package-archives '("melpa-stable" . "https://stable.melpa.org/packages/") t)</span>
<span style="color: #707183;">(</span>package-initialize<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Finally it's time to go over the package list and install everything.
You'll notice the use of a very primitive function - no <code>straight.el</code> or <code>use-package</code> here!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">dolist</span> <span style="color: #7388D6;">(</span>package '<span style="color: #909183;">(</span>dumb-jump
                   company
                   ivy
                   sudo-edit
                   json-mode
                   sly
                   vterm
                   elfeed
                   magit
                   guix
                   tree-sitter
                   tree-sitter-langs
                   treemacs
                   doom-themes
                   treemacs-all-the-icons
                   markdown-mode
                   impatient-mode
                   rainbow-delimiters
                   ligature
                   flycheck
                   geiser
                   geiser-guile
                   org-present
                   web-mode<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">unless</span> <span style="color: #909183;">(</span>package-installed-p package<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span>package-install package<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">require</span> <span style="color: #D0372D;">package</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Now we set some custom variables related to theming. This part here was automatically generated by Emacs.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>custom-set-variables
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">custom-set-variables was added by Custom.</span>
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">If you edit it by hand, you could mess it up, so be careful.</span>
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Your init file should contain only one such instance.</span>
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">If there is more than one, they won't work right.</span>
 '<span style="color: #7388D6;">(</span>column-number-mode t<span style="color: #7388D6;">)</span>
 '<span style="color: #7388D6;">(</span>custom-enabled-themes '<span style="color: #909183;">(</span>doom-dracula<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
 '<span style="color: #7388D6;">(</span>custom-safe-themes
   '<span style="color: #909183;">(</span><span style="color: #008000;">"944d52450c57b7cbba08f9b3d08095eb7a5541b0ecfb3a0a9ecd4a18f3c28948"</span> <span style="color: #008000;">"631c52620e2953e744f2b56d102eae503017047fb43d65ce028e88ef5846ea3b"</span> <span style="color: #008000;">"1a1ac598737d0fcdc4dfab3af3d6f46ab2d5048b8e72bc22f50271fd6d393a00"</span> <span style="color: #008000;">"7ea883b13485f175d3075c72fceab701b5bf76b2076f024da50dff4107d0db25"</span> <span style="color: #008000;">"37768a79b479684b0756dec7c0fc7652082910c37d8863c35b702db3f16000f8"</span> <span style="color: #008000;">"ae426fc51c58ade49774264c17e666ea7f681d8cae62570630539be3d06fd964"</span> <span style="color: #008000;">"fee7287586b17efbfda432f05539b58e86e059e78006ce9237b8732fde991b4c"</span> <span style="color: #008000;">"bfc0b9c3de0382e452a878a1fb4726e1302bf9da20e69d6ec1cd1d5d82f61e3d"</span> <span style="color: #008000;">"dde643b0efb339c0de5645a2bc2e8b4176976d5298065b8e6ca45bc4ddf188b7"</span> <span style="color: #008000;">"bffa9739ce0752a37d9b1eee78fc00ba159748f50dc328af4be661484848e476"</span> <span style="color: #008000;">"12ce0ae7f9f5ba28e7252d9464daea32aa0884646b6576b949edfb2ccf2bf9d4"</span> <span style="color: #008000;">"da75eceab6bea9298e04ce5b4b07349f8c02da305734f7c0c8c6af7b5eaa9738"</span> <span style="color: #008000;">"2dd4951e967990396142ec54d376cced3f135810b2b69920e77103e0bcedfba9"</span> <span style="color: #008000;">"7a424478cb77a96af2c0f50cfb4e2a88647b3ccca225f8c650ed45b7f50d9525"</span> <span style="color: #008000;">"6945dadc749ac5cbd47012cad836f92aea9ebec9f504d32fe89a956260773ca4"</span> <span style="color: #008000;">"aec7b55f2a13307a55517fdf08438863d694550565dee23181d2ebd973ebd6b8"</span> default<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
 '<span style="color: #7388D6;">(</span>delete-selection-mode t<span style="color: #7388D6;">)</span>
 '<span style="color: #7388D6;">(</span>package-selected-packages
   '<span style="color: #909183;">(</span>org-present org-roam web-mode doom-themes vterm sly sudo-edit pacmacs rainbow-mode eglot nord-theme nyan-mode rainbow-delimiters tree-sitter-langs tree-sitter magit treemacs-icons-dired spacemacs-theme treemacs-all-the-icons treemacs guix emms elfeed impatient-mode company-plisp sly-quicklisp ligature markdown-mode ivy flycheck company dumb-jump<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
 '<span style="color: #7388D6;">(</span>safe-local-variable-values
   '<span style="color: #909183;">(</span><span style="color: #709870;">(</span>eval modify-syntax-entry 43 <span style="color: #008000;">"'"</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>eval modify-syntax-entry 36 <span style="color: #008000;">"'"</span><span style="color: #709870;">)</span>
     <span style="color: #709870;">(</span>eval modify-syntax-entry 126 <span style="color: #008000;">"'"</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
 '<span style="color: #7388D6;">(</span>warning-suppress-types '<span style="color: #909183;">(</span><span style="color: #709870;">(</span>comp<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>comp<span style="color: #709870;">)</span> <span style="color: #709870;">(</span>emacs<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>custom-set-faces
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">custom-set-faces was added by Custom.</span>
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">If you edit it by hand, you could mess it up, so be careful.</span>
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">Your init file should contain only one such instance.</span>
 <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">If there is more than one, they won't work right.</span>
 '<span style="color: #7388D6;">(</span>default <span style="color: #909183;">(</span><span style="color: #709870;">(</span>t <span style="color: #907373;">(</span><span style="color: #006FE0;">:family</span> <span style="color: #008000;">"Fira Code"</span> <span style="color: #006FE0;">:foundry</span> <span style="color: #008000;">"CTDB"</span> <span style="color: #006FE0;">:slant</span> normal <span style="color: #006FE0;">:weight</span> normal <span style="color: #006FE0;">:height</span> 120 <span style="color: #006FE0;">:width</span> normal<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
The Fira Code font has ligature support, so we implement it here.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">dolist</span> <span style="color: #7388D6;">(</span>char/ligature-re
         `<span style="color: #909183;">(</span><span style="color: #709870;">(</span>?-  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"--&gt;"</span> <span style="color: #008000;">"-&lt;&lt;"</span> <span style="color: #008000;">"-&gt;&gt;"</span> <span style="color: #008000;">"-|"</span> <span style="color: #008000;">"-~"</span> <span style="color: #008000;">"-&lt;"</span> <span style="color: #008000;">"-&gt;"</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"-"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?/  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"/=="</span> <span style="color: #008000;">"/="</span> <span style="color: #008000;">"/&gt;"</span> <span style="color: #008000;">"/**"</span> <span style="color: #008000;">"/*"</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"/"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?*  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"*&gt;"</span> <span style="color: #008000;">"*/"</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"*"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?&lt;  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"&lt;&lt;="</span> <span style="color: #008000;">"&lt;&lt;-"</span> <span style="color: #008000;">"&lt;|||"</span> <span style="color: #008000;">"&lt;==&gt;"</span> <span style="color: #008000;">"&lt;!--"</span> <span style="color: #008000;">"&lt;=&gt;"</span> <span style="color: #008000;">"&lt;||"</span> <span style="color: #008000;">"&lt;|&gt;"</span> <span style="color: #008000;">"&lt;-&lt;"</span>
                             <span style="color: #008000;">"&lt;=="</span> <span style="color: #008000;">"&lt;=&lt;"</span> <span style="color: #008000;">"&lt;-|"</span> <span style="color: #008000;">"&lt;~&gt;"</span> <span style="color: #008000;">"&lt;=|"</span> <span style="color: #008000;">"&lt;~~"</span> <span style="color: #008000;">"&lt;$&gt;"</span> <span style="color: #008000;">"&lt;+&gt;"</span> <span style="color: #008000;">"&lt;/&gt;"</span> <span style="color: #008000;">"&lt;*&gt;"</span>
                             <span style="color: #008000;">"&lt;-&gt;"</span> <span style="color: #008000;">"&lt;="</span> <span style="color: #008000;">"&lt;|"</span> <span style="color: #008000;">"&lt;:"</span> <span style="color: #008000;">"&lt;&gt;"</span>  <span style="color: #008000;">"&lt;$"</span> <span style="color: #008000;">"&lt;-"</span> <span style="color: #008000;">"&lt;~"</span> <span style="color: #008000;">"&lt;+"</span> <span style="color: #008000;">"&lt;/"</span> <span style="color: #008000;">"&lt;*"</span><span style="color: #858580;">)</span>
                         <span style="color: #858580;">(</span>+ <span style="color: #008000;">"&lt;"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?:  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">":?&gt;"</span> <span style="color: #008000;">"::="</span> <span style="color: #008000;">":&gt;"</span> <span style="color: #008000;">":&lt;"</span> <span style="color: #008000;">":?"</span> <span style="color: #008000;">":="</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">":"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?=  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"=&gt;&gt;"</span> <span style="color: #008000;">"==&gt;"</span> <span style="color: #008000;">"=/="</span> <span style="color: #008000;">"=!="</span> <span style="color: #008000;">"=&gt;"</span> <span style="color: #008000;">"=:="</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"="</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?!  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"!=="</span> <span style="color: #008000;">"!="</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"!"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?&gt;  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"&gt;&gt;-"</span> <span style="color: #008000;">"&gt;&gt;="</span> <span style="color: #008000;">"&gt;=&gt;"</span> <span style="color: #008000;">"&gt;]"</span> <span style="color: #008000;">"&gt;:"</span> <span style="color: #008000;">"&gt;-"</span> <span style="color: #008000;">"&gt;="</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"&gt;"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?&amp;  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span>+ <span style="color: #008000;">"&amp;"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?|  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"|-&gt;"</span> <span style="color: #008000;">"|||&gt;"</span> <span style="color: #008000;">"||&gt;"</span> <span style="color: #008000;">"|=&gt;"</span> <span style="color: #008000;">"||-"</span> <span style="color: #008000;">"||="</span> <span style="color: #008000;">"|-"</span> <span style="color: #008000;">"|&gt;"</span> <span style="color: #008000;">"|]"</span> <span style="color: #008000;">"|}"</span> <span style="color: #008000;">"|="</span><span style="color: #858580;">)</span>
                         <span style="color: #858580;">(</span>+ <span style="color: #008000;">"|"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?.  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">".?"</span> <span style="color: #008000;">".="</span> <span style="color: #008000;">".-"</span> <span style="color: #008000;">"..&lt;"</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"."</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?+  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"+&gt;"</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"+"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?\[ ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"[&lt;"</span> <span style="color: #008000;">"[|"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?\{ ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #008000;">"{|"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?\? ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"?."</span> <span style="color: #008000;">"?="</span> <span style="color: #008000;">"?:"</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"?"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?#  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #858580;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"#_("</span> <span style="color: #008000;">"#["</span> <span style="color: #008000;">"#{"</span> <span style="color: #008000;">"#="</span> <span style="color: #008000;">"#!"</span> <span style="color: #008000;">"#:"</span> <span style="color: #008000;">"#_"</span> <span style="color: #008000;">"#?"</span> <span style="color: #008000;">"#("</span><span style="color: #858580;">)</span> <span style="color: #858580;">(</span>+ <span style="color: #008000;">"#"</span><span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?\; ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span>+ <span style="color: #008000;">";"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?_  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"_|_"</span> <span style="color: #008000;">"__"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?~  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">or</span> <span style="color: #008000;">"~~&gt;"</span> <span style="color: #008000;">"~~"</span> <span style="color: #008000;">"~&gt;"</span> <span style="color: #008000;">"~-"</span> <span style="color: #008000;">"~@"</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?$  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #008000;">"$&gt;"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?^  ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #008000;">"^="</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>?\] ,<span style="color: #907373;">(</span><span style="color: #0000FF;">rx</span> <span style="color: #008000;">"]#"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>apply <span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">(</span>char ligature-re<span style="color: #709870;">)</span>
           <span style="color: #709870;">(</span>set-char-table-range composition-function-table char
                                 `<span style="color: #907373;">(</span><span style="color: #6276BA;">[</span>,ligature-re 0 font-shape-gstring<span style="color: #6276BA;">]</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
         char/ligature-re<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>

<div id="outline-container-org1d2df8e" class="outline-3">
<h3 id="org1d2df8e"><span class="section-number-3">14.1.</span> Variables</h3>
<div class="outline-text-3" id="text-14-1">
<p>
It's finally time to set up some basic variables.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> ring-bell-function 'ignore<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> vc-follow-symlinks t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> all-the-icons-scale-factor 1.2<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> confirm-kill-processes nil<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> kill-buffer-query-functions nil<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>treemacs-load-theme <span style="color: #008000;">"all-the-icons"</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>menu-bar-mode -1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>tool-bar-mode -1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>scroll-bar-mode -1<span style="color: #707183;">)</span>
<span style="color: #8D8D84; font-style: italic;">;;</span><span style="color: #8D8D84; font-style: italic;">(global-tab-line-mode t)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> inferior-lisp-program <span style="color: #008000;">"sbcl"</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setf</span> nyan-animate-nyancat t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setf</span> nyan-animation-frame-interval 0.05<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setf</span> nyan-wavy-trail t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq-default</span> cursor-type 'bar<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> geiser-active-implementations '<span style="color: #7388D6;">(</span>guile<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> geiser-default-implementation 'guile<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Some window related stuff; supress opening the welcome screen for buffers opening files.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">when</span> <span style="color: #7388D6;">(</span>&gt; <span style="color: #909183;">(</span>length command-line-args<span style="color: #909183;">)</span> 1<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">setq</span> inhibit-splash-screen t<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>add-to-list 'default-frame-alist '<span style="color: #7388D6;">(</span>height . 44<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>add-to-list 'default-frame-alist '<span style="color: #7388D6;">(</span>width . 140<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> frame-resize-pixelwise t<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Windows has some rather strange encoding issues when UTF-8 isn't explicitly set as the default.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>prefer-coding-system 'utf-8<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>set-default-coding-systems 'utf-8<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>set-language-environment 'utf-8<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>set-selection-coding-system 'utf-8<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Company is used for code completion. Here is a basic setup.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">company-complete-common-or-cycle</span> <span style="color: #7388D6;">()</span>
  <span style="color: #036A07; font-style: italic;">"Company settings."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">when</span> <span style="color: #909183;">(</span>company-manual-begin<span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span><span style="color: #0000FF;">if</span> <span style="color: #709870;">(</span>eq last-command 'company-complete-common-or-cycle<span style="color: #709870;">)</span>
        <span style="color: #709870;">(</span><span style="color: #0000FF;">let</span> <span style="color: #907373;">(</span><span style="color: #6276BA;">(</span>company-selection-wrap-around t<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span>
          <span style="color: #907373;">(</span>call-interactively 'company-select-next<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
      <span style="color: #709870;">(</span>call-interactively 'company-complete-common<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span>define-key company-active-map <span style="color: #7388D6;">[</span>tab<span style="color: #7388D6;">]</span> 'company-complete-common-or-cycle<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key company-active-map <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"TAB"</span><span style="color: #7388D6;">)</span> 'company-complete-common-or-cycle<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> company-insertion-on-trigger 'company-explicit-action-p<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>add-hook 'xref-backend-functions #'dumb-jump-xref-activate<span style="color: #707183;">)</span>
</pre>
</div>

<p>
And here we arrive at the global modes.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>global-display-line-numbers-mode -1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>add-hook 'prog-mode-hook #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span> <span style="color: #909183;">(</span>display-line-numbers-mode t<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-prettify-symbols-mode t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-company-mode t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-flycheck-mode t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>ivy-mode t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-tree-sitter-mode 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>electric-pair-mode t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-hl-line-mode 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>desktop-save-mode -1<span style="color: #707183;">)</span>
<span style="color: #8D8D84; font-style: italic;">;;</span><span style="color: #8D8D84; font-style: italic;">(nyan-mode t)</span>
<span style="color: #707183;">(</span>add-hook 'tree-sitter-after-on-hook #'tree-sitter-hl-mode<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>add-hook 'scheme-mode-hook 'geiser-mode<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Impatient mode for Markdown, more about this later.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>add-hook 'markdown-mode-hook #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span>
                                  <span style="color: #909183;">(</span>markdown-impatient-start<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span> <span style="color: #8D8D84; font-style: italic;">; </span><span style="color: #8D8D84; font-style: italic;">Impatient mode live preview</span>
</pre>
</div>

<p>
Rainbow delimiters are a life-saver for Lisps!
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>add-hook 'prog-mode-hook #'rainbow-delimiters-mode<span style="color: #707183;">)</span>
</pre>
</div>

<p>
I like to have the selected line clearly highlighted.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>set-face-attribute 'hl-line nil <span style="color: #006FE0;">:inherit</span> nil <span style="color: #006FE0;">:background</span> <span style="color: #008000;">"gray14"</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Here is a very minimal setup for org-agenda.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">require</span> '<span style="color: #D0372D;">org</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> org-log-done t<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> calendar-week-start-day 1<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>add-to-list 'org-agenda-files <span style="color: #008000;">"~/org/agenda.org"</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key global-map <span style="color: #008000;">"\C-ck"</span> 'org-store-link<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key global-map <span style="color: #008000;">"\C-ca"</span> 'org-agenda<span style="color: #707183;">)</span>
</pre>
</div>

<p>
This is for keybindings that should never be overwritten by minor modes.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">defvar</span> <span style="color: #BA36A5;">my/keys-keymap</span> <span style="color: #7388D6;">(</span>make-keymap<span style="color: #7388D6;">)</span>
  <span style="color: #036A07; font-style: italic;">"Keymap for my/keys-mode."</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">define-minor-mode</span> <span style="color: #006699;">my/keys-mode</span>
  <span style="color: #036A07; font-style: italic;">"Minor mode for my personal keybindings."</span>
  <span style="color: #006FE0;">:init-value</span> t
  <span style="color: #006FE0;">:global</span> t
  <span style="color: #006FE0;">:keymap</span> my/keys-keymap<span style="color: #707183;">)</span>

<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">The keymaps in `</span><span style="color: #D0372D; font-style: italic;">emulation-mode-map-alists</span><span style="color: #8D8D84; font-style: italic;">' take precedence over</span>
<span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">`</span><span style="color: #D0372D; font-style: italic;">minor-mode-map-alist</span><span style="color: #8D8D84; font-style: italic;">'</span>
<span style="color: #707183;">(</span>add-to-list 'emulation-mode-map-alists
             `<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span>my/keys-mode . ,my/keys-keymap<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f419a5" class="outline-3">
<h3 id="org0f419a5"><span class="section-number-3">14.2.</span> Functions</h3>
<div class="outline-text-3" id="text-14-2">
<p>
Some straightforward functions here, used to make my Emacs life a little easier.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">my-kill-buffer-and-window</span> <span style="color: #7388D6;">()</span>
 <span style="color: #036A07; font-style: italic;">"Kill the current buffer and delete the selected window."</span>
 <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
 <span style="color: #7388D6;">(</span><span style="color: #0000FF;">let</span> <span style="color: #909183;">(</span><span style="color: #709870;">(</span>window-to-delete <span style="color: #907373;">(</span>selected-window<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
        <span style="color: #709870;">(</span>buffer-to-kill <span style="color: #907373;">(</span>current-buffer<span style="color: #907373;">)</span><span style="color: #709870;">)</span>
        <span style="color: #709870;">(</span>delete-window-hook <span style="color: #907373;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #6276BA;">()</span> <span style="color: #6276BA;">(</span><span style="color: #0000FF;">ignore-errors</span> <span style="color: #858580;">(</span>delete-window<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
   <span style="color: #909183;">(</span><span style="color: #0000FF;">unwind-protect</span>
        <span style="color: #709870;">(</span><span style="color: #0000FF;">progn</span>
          <span style="color: #907373;">(</span>add-hook 'kill-buffer-hook delete-window-hook t t<span style="color: #907373;">)</span>
          <span style="color: #907373;">(</span><span style="color: #0000FF;">if</span> <span style="color: #6276BA;">(</span>kill-buffer <span style="color: #858580;">(</span>current-buffer<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span>
              <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">If `</span><span style="color: #D0372D; font-style: italic;">delete-window</span><span style="color: #8D8D84; font-style: italic;">' failed before, we rerun it to regenerate</span>
              <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">the error so it can be seen in the echo area.</span>
              <span style="color: #6276BA;">(</span><span style="color: #0000FF;">when</span> <span style="color: #858580;">(</span>eq <span style="color: #80A880;">(</span>selected-window<span style="color: #80A880;">)</span> window-to-delete<span style="color: #858580;">)</span>
                <span style="color: #858580;">(</span>delete-window<span style="color: #858580;">)</span><span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">new-vterm</span> <span style="color: #7388D6;">()</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">let</span> <span style="color: #909183;">(</span><span style="color: #709870;">(</span>current-prefix-arg '<span style="color: #907373;">(</span>4<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span> <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">emulate C-u</span>
    <span style="color: #909183;">(</span>call-interactively 'vterm<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">dired-open-file</span> <span style="color: #7388D6;">()</span>
  <span style="color: #036A07; font-style: italic;">"In Dired, open the file named on this line."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">let*</span> <span style="color: #909183;">(</span><span style="color: #709870;">(</span>file <span style="color: #907373;">(</span>dired-get-filename nil t<span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
    <span style="color: #909183;">(</span>call-process <span style="color: #008000;">"xdg-open"</span> nil 0 nil file<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">insert-above-and-jump</span> <span style="color: #7388D6;">()</span>
  <span style="color: #036A07; font-style: italic;">"Insert line above current line."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>beginning-of-line<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>newline-and-indent<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>forward-line -1<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>indent-according-to-mode<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">insert-line-below-and-jump</span> <span style="color: #7388D6;">()</span>
  <span style="color: #036A07; font-style: italic;">"Insert line below current line."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>end-of-line<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>newline-and-indent<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">my-enlarge-window-horizontally</span> <span style="color: #7388D6;">()</span>
  <span style="color: #036A07; font-style: italic;">"Enlarge window horizontally."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>enlarge-window-horizontally 4<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">my-shrink-window-horizontally</span> <span style="color: #7388D6;">()</span>
  <span style="color: #036A07; font-style: italic;">"Shrink window horizontally."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>shrink-window-horizontally 4<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Sometimes I like to take quick notes in Markdown with impatient mode used for a preview feature.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">markdown-html</span> <span style="color: #7388D6;">(</span>buffer<span style="color: #7388D6;">)</span>
  <span style="color: #036A07; font-style: italic;">"Markdown HTML filter, supply BUFFER."</span>
  <span style="color: #7388D6;">(</span>princ <span style="color: #909183;">(</span><span style="color: #0000FF;">with-current-buffer</span> buffer
           <span style="color: #709870;">(</span>format <span style="color: #008000;">"&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;title&gt;Impatient Markdown&lt;/title&gt;&lt;xmp theme=\"united\" style=\"display:none;\"&gt; %s  &lt;/xmp&gt;&lt;script src=\"http://ndossougbe.github.io/strapdown/dist/strapdown.js\"&gt;&lt;/script&gt;&lt;/html&gt;"</span> <span style="color: #907373;">(</span>buffer-substring-no-properties <span style="color: #6276BA;">(</span>point-min<span style="color: #6276BA;">)</span> <span style="color: #6276BA;">(</span>point-max<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
         <span style="color: #909183;">(</span>current-buffer<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>

<span style="color: #707183;">(</span><span style="color: #0000FF;">defun</span> <span style="color: #006699;">markdown-impatient-start</span> <span style="color: #7388D6;">()</span>
  <span style="color: #036A07; font-style: italic;">"Start impatient mode with filter."</span>
  <span style="color: #7388D6;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>impatient-mode<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>httpd-start<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>imp-set-user-filter 'markdown-html<span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>



<div id="outline-container-org0c0f654" class="outline-3">
<h3 id="org0c0f654"><span class="section-number-3">14.3.</span> Keybindings</h3>
<div class="outline-text-3" id="text-14-3">
<p>
Finally we get to my extensive custom keybindings. I try to keep these to as few as possible, to avoid forgetting them over time.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-d"</span><span style="color: #7388D6;">)</span> 'kill-line<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-set-key <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-l"</span><span style="color: #7388D6;">)</span> 'forward-char<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-h"</span><span style="color: #7388D6;">)</span> 'backward-char<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-k"</span><span style="color: #7388D6;">)</span> 'previous-line<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-j"</span><span style="color: #7388D6;">)</span> 'next-line<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-l"</span><span style="color: #7388D6;">)</span> 'forward-word<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-h"</span><span style="color: #7388D6;">)</span> 'backward-word<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-j"</span><span style="color: #7388D6;">)</span> 'forward-paragraph<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-k"</span><span style="color: #7388D6;">)</span> 'backward-paragraph<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-c"</span><span style="color: #7388D6;">)</span> 'compile<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-b"</span><span style="color: #7388D6;">)</span> 'ivy-switch-buffer<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-p"</span><span style="color: #7388D6;">)</span> 'other-window<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-o"</span><span style="color: #7388D6;">)</span> 'insert-line-above-and-jump<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-v"</span><span style="color: #7388D6;">)</span> 'set-mark-command<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"&lt;backtab&gt;"</span><span style="color: #7388D6;">)</span> 'indent-rigidly<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-="</span><span style="color: #7388D6;">)</span> 'indent-region<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-&#167;"</span><span style="color: #7388D6;">)</span> 'scroll-down-line<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-&#367;"</span><span style="color: #7388D6;">)</span> 'scroll-up-line<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-&#367;"</span><span style="color: #7388D6;">)</span> #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #909183;">)</span> <span style="color: #909183;">(</span>scroll-up 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-&#167;"</span><span style="color: #7388D6;">)</span> #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #909183;">)</span> <span style="color: #909183;">(</span>scroll-down 4<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-x c"</span><span style="color: #7388D6;">)</span> #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span> <span style="color: #909183;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #909183;">)</span> <span style="color: #909183;">(</span>load-file <span style="color: #008000;">"~/.emacs"</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c r"</span><span style="color: #7388D6;">)</span> 'replace-string<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-/"</span><span style="color: #7388D6;">)</span> 'undo-redo<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-/"</span><span style="color: #7388D6;">)</span> 'undo-redo<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c n"</span><span style="color: #7388D6;">)</span> 'elfeed<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c y"</span><span style="color: #7388D6;">)</span> 'yank-from-kill-ring<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c p"</span><span style="color: #7388D6;">)</span> 'treemacs<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c l"</span><span style="color: #7388D6;">)</span> 'treemacs-select-directory<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c t"</span><span style="color: #7388D6;">)</span> 'new-vterm<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"M-w"</span><span style="color: #7388D6;">)</span> 'copy-region-as-kill<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c h"</span><span style="color: #7388D6;">)</span> 'help<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-M-h"</span><span style="color: #7388D6;">)</span> 'previous-buffer<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-M-l"</span><span style="color: #7388D6;">)</span> 'next-buffer<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c v"</span><span style="color: #7388D6;">)</span> #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span>
                                             <span style="color: #909183;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #909183;">)</span>
                                             <span style="color: #909183;">(</span>split-window-horizontally<span style="color: #909183;">)</span>
                                             <span style="color: #909183;">(</span>run-with-idle-timer 0.05 nil
                                                                  'windmove-right<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c c"</span><span style="color: #7388D6;">)</span> #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span>
                                             <span style="color: #909183;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #909183;">)</span>
                                             <span style="color: #909183;">(</span>split-window-vertically<span style="color: #909183;">)</span>
                                             <span style="color: #909183;">(</span>run-with-idle-timer 0.05 nil
                                                                  'windmove-down<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c q"</span><span style="color: #7388D6;">)</span> 'delete-window<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c C-q"</span><span style="color: #7388D6;">)</span> 'my-kill-buffer-and-window<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key my/keys-keymap <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c d"</span><span style="color: #7388D6;">)</span> #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">(</span>command<span style="color: #909183;">)</span>
                                             <span style="color: #909183;">(</span><span style="color: #0000FF;">interactive</span> <span style="color: #709870;">(</span>list <span style="color: #907373;">(</span>read-shell-command <span style="color: #008000;">"$ "</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span>
                                             <span style="color: #909183;">(</span>start-process-shell-command command nil command<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-set-key <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c w"</span><span style="color: #7388D6;">)</span> 'eww-switch-to-buffer<span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>global-set-key <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c C-w"</span><span style="color: #7388D6;">)</span> #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span>
                                    <span style="color: #909183;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #909183;">)</span>
                                    <span style="color: #909183;">(</span><span style="color: #0000FF;">let</span> <span style="color: #709870;">(</span><span style="color: #907373;">(</span>current-prefix-arg '<span style="color: #6276BA;">(</span>4<span style="color: #6276BA;">)</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span> <span style="color: #8D8D84; font-style: italic;">;; </span><span style="color: #8D8D84; font-style: italic;">emulate C-u</span>
                                      <span style="color: #709870;">(</span>eww <span style="color: #907373;">(</span>read-string <span style="color: #008000;">"Enter URL: "</span> <span style="color: #008000;">"https://google.com"</span><span style="color: #907373;">)</span><span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
These bindings are defined separately in the EXWM config, so they aren't necessary when using EXWM.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">when</span> <span style="color: #7388D6;">(</span>not use-exwm<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>define-key my/keys-keymap <span style="color: #909183;">(</span>kbd <span style="color: #008000;">"C-&lt;return&gt;"</span><span style="color: #909183;">)</span> 'new-vterm<span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>define-key my/keys-keymap <span style="color: #909183;">(</span>kbd <span style="color: #008000;">"C-)"</span><span style="color: #909183;">)</span> #'<span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">()</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>enlarge-window-horizontally 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>define-key my/keys-keymap <span style="color: #909183;">(</span>kbd <span style="color: #008000;">"C-&#250;"</span><span style="color: #909183;">)</span> #'<span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">()</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>shrink-window-horizontally 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>define-key my/keys-keymap <span style="color: #909183;">(</span>kbd <span style="color: #008000;">"M-&#250;"</span><span style="color: #909183;">)</span> #'<span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">()</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>shrink-window 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span>
  <span style="color: #7388D6;">(</span>define-key my/keys-keymap <span style="color: #909183;">(</span>kbd <span style="color: #008000;">"M-)"</span><span style="color: #909183;">)</span> #'<span style="color: #909183;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #709870;">()</span> <span style="color: #709870;">(</span><span style="color: #0000FF;">interactive</span><span style="color: #709870;">)</span> <span style="color: #709870;">(</span>enlarge-window 2<span style="color: #709870;">)</span><span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
Some mode-specific bindings are added here.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span>add-hook 'common-lisp-mode-hook #'<span style="color: #7388D6;">(</span><span style="color: #0000FF;">lambda</span> <span style="color: #909183;">()</span>
                                     <span style="color: #909183;">(</span>local-set-key <span style="color: #709870;">(</span>kbd <span style="color: #008000;">"C-c d"</span><span style="color: #709870;">)</span> 'sly-eval-defun<span style="color: #909183;">)</span>
                                     <span style="color: #909183;">(</span>local-set-key <span style="color: #709870;">(</span>kbd <span style="color: #008000;">"C-c r"</span><span style="color: #709870;">)</span> 'sly-eval-region<span style="color: #909183;">)</span>
                                     <span style="color: #909183;">(</span>local-set-key <span style="color: #709870;">(</span>kbd <span style="color: #008000;">"C-c b"</span><span style="color: #709870;">)</span> 'sly-eval-buffer<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
<span style="color: #707183;">(</span>define-key dired-mode-map <span style="color: #7388D6;">(</span>kbd <span style="color: #008000;">"C-c o"</span><span style="color: #7388D6;">)</span> 'dired-open-file<span style="color: #707183;">)</span>
</pre>
</div>

<p>
Some news feeds.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">setq</span> elfeed-feeds
      '<span style="color: #7388D6;">(</span><span style="color: #909183;">(</span><span style="color: #008000;">"https://www.root.cz/rss/clanky"</span> root.cz<span style="color: #909183;">)</span>
        <span style="color: #909183;">(</span><span style="color: #008000;">"https://www.root.cz/rss/zpravicky"</span> root.cz<span style="color: #909183;">)</span>
        <span style="color: #909183;">(</span><span style="color: #008000;">"https://forum.root.cz/index.php?action=.xml;type=rss2;limit=30;sa=news"</span> root.cz forum<span style="color: #909183;">)</span><span style="color: #7388D6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<p>
And we have reached the end!
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #707183;">(</span><span style="color: #0000FF;">provide</span> '<span style="color: #D0372D;">.emacs</span><span style="color: #707183;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Jan NovotnÃ½</p>
<p class="date">Created: 2023-04-21 Fri 01:45</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
